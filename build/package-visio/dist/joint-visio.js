/*! JointJS+ v4.0.1 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2024 client IO

 2024-10-07 


This Source Code Form is subject to the terms of the JointJS+ Trial License
, v. 2.0. If a copy of the JointJS+ License was not distributed with this
file, You can obtain one at https://www.jointjs.com/license
 or from the JointJS+ archive as was distributed by client IO. See the LICENSE file.*/


((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@joint/core"),require("hot-formula-parser"),require("jszip")):"function"==typeof define&&define.amd?define(["exports","@joint/core","hot-formula-parser","jszip"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).joint=e.joint||{},e.joint.format=e.joint.format||{},e.joint.format.Visio=e.joint.format.Visio||{}),e.joint,e.formulaParser,e.JSZip)})(this,function(e,z,k,L){function F(e,t){var t=1<arguments.length&&void 0!==t?t:0;if("number"!=typeof e)throw"Not a number.";return 0===t?Math.round(e):(t=Math.pow(10,t),Math.round(e*t)/t)}function N(t,i,r,e,l){var a=4<arguments.length&&void 0!==l?l:.1;{var s=t,n=i,o=r;let e=o.length;for(var h=o[e-1];e<n.length+s+1;e++)o[e]=h}for(var u=[],g=0;g<=1;g+=a){var[c,d]=((e,t,i,r,l)=>{var a,s,n,o,h=i.length,u=i[0].length;if(t<1)throw new Error("degree must be at least 1 (linear)");if(h-1<t)throw new Error("degree must be less than or equal to point count - 1");if(!l)for(l=[],a=0;a<h;a++)l[a]=1;if(r){if(r.length!==h+t+1)throw new Error("bad knot vector length")}else for(r=[],a=0;a<h+t+1;a++)r[a]=a;var g=[t,r.length-1-t],c=r[g[0]],d=r[g[1]];if((e=e*(d-c)+c)<c||d<e)throw new Error("out of bounds");for(n=g[0];n<g[1]&&!(e>=r[n]&&e<=r[n+1]);n++);var p,v=[];for(a=0;a<h;a++){for(v[a]=[],s=0;s<u;s++)v[a][s]=i[a][s]*l[a];v[a][u]=l[a]}for(o=1;o<=t+1;o++)for(a=n;n-t-1+o<a;a--)for(p=(e-r[a])/(r[a+t+1-o]-r[a]),s=0;s<u+1;s++)v[a][s]=(1-p)*v[a-1][s]+p*v[a][s];var S=[];for(a=0;a<u;a++)S[a]=v[n][a]/v[n][u];return S})(g,t,i,r,e);isNaN(c)||isNaN(d)||u.push(F(c,2),F(d,2))}return u}let V={Main:"Main",Relationships:"Relationships",DrawingML:"DrawingML",Theme:"Theme"},C={Main:"http://schemas.microsoft.com/office/visio/2012/main",Relationships:"http://schemas.openxmlformats.org/package/2006/relationships",ContentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",DocumentRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",VisioMasterRelationship:"http://schemas.microsoft.com/visio/2010/relationships/master",DocumentImageRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CustomProperties:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",DocPropsVTypes:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",DrawingML:"http://schemas.openxmlformats.org/drawingml/2006/main",Theme:"http://schemas.microsoft.com/office/visio/2012/theme"},g={Cell:"Cell",Row:"Row",Master:"Master",Section:"Section",Shape:"Shape",ShapeText:"ShapeText",PageSheet:"PageSheet",Page:"Page",Icon:"Icon",Image:"Image",Document:"Document",StyleSheet:"StyleSheet",ForeignData:"ForeignData",DocumentSettings:"DocumentSettings",DocumentSheet:"DocumentSheet",SchemeClr:"SchemeClr",Connect:"Connect",FaceName:"FaceName"},s={Name:"@N",Value:"@V",Units:"@U",Formula:"@F"},A={name:s.Name,value:s.Value,units:s.Units,formula:s.Formula},M={PageSheet:"PageSheet",Rel:"Rel",Icon:"Icon",Id:"@ID",UniqueId:"@UniqueID",MasterType:"@MasterType",BaseId:"@BaseID",NameU:"@NameU",IsCustomNameU:"@IsCustomNameU",Name:"@Name",IsCustomName:"@IsCustomName",Prompt:"@Prompt",Hidden:"@Hidden",IconSize:"@IconSize",AlignName:"@AlignName",MatchByName:"@MatchByName",IconUpdate:"@IconUpdate",PatternFlags:"@PatternFlags"},G={Relationship:"Relationship",Id:"@Id",Type:"@Type",Target:"@Target"},c={Document:"Document",Master:"Master",Masters:"Masters",Page:"Page",Pages:"Pages",Windows:"Windows",Theme:"Theme",Image:"Image",Solutions:"Solutions",coreProperties:"coreProperties",thumbnail:"thumbnail",document:"document",customProperties:"customProperties",extendedProperties:"extendedProperties"},X={"http://schemas.microsoft.com/visio/2010/relationships/windows":c.Windows,"http://schemas.microsoft.com/visio/2010/relationships/pages":c.Pages,"http://schemas.microsoft.com/visio/2010/relationships/page":c.Page,"http://schemas.microsoft.com/visio/2010/relationships/master":c.Master,"http://schemas.microsoft.com/visio/2010/relationships/masters":c.Masters,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":c.Theme,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":c.Image,"http://schemas.microsoft.com/visio/2010/relationships/solutions":c.Solutions,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties":"coreProperties","http://schemas.openxmlformats.org/package/2006/relationships/metadata/thumbnail":"thumbnail","http://schemas.microsoft.com/visio/2010/relationships/document":"document","http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties":"customProperties","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties":"extendedProperties"},O={Name:"@N",Id:"@IX",Row:"Row"},U={Name:"@N",Id:"@IX",Type:"@T",Cell:"Cell"},n={Id:"@ID",Shapes:"Shapes",Section:"Section",Cell:"Cell",Text:"Text",Connect:"Connect",Connects:"Connects",MasterShapeId:"@MasterShape",MasterId:"@Master",Type:"@Type"},j={Shape:"Shape"},o={Id:"@ID",Cell:"Cell",Row:"Row",Section:"Section",Text:"Text",Rel:"Rel",PageSheet:"PageSheet",Icon:"Icon",ForeignData:"ForeignData",Type:"@Type",xmlns:"@xmlns",xmlnsR:"@xmlns:r",xmlSpace:"@xml:space"},d={DocumentSettings:"DocumentSettings",Colors:"Colors",FaceNames:"FaceNames",StyleSheets:"StyleSheets",DocumentSheet:"DocumentSheet",ColorEntry:"ColorEntry",Ix:"@IX",Rgb:"@RGB"},H={CharacterProperties:"cp",Content:"keyValue"},J={Content:"keyValue"},$={RelId:"@r:id"},h={AC:"AC",AD:"AD",BOOL:"BOOL",C:"C",C_D:"C_D",CM:"CM",COLOR:"COLOR",CY:"CY",D:"D",DA:"DA",DATE:"DATE",DE:"DE",DEG:"DEG",DL:"DL",DP:"DP",DT:"DT",ED:"ED",EH:"EH",EM:"EM",ES:"ES",EW:"EW",F_I:"F_I",FT:"FT",HA:"HA",IN:"IN",IN_F:"IN_F",KM:"KM",M:"M",MI:"MI",MI_F:"MI_F",MM:"MM",NM:"NM",PER:"PER",P_PT:"P_PT",PT:"PT",P:"P",PNT:"PNT",RAD:"RAD",STR:"STR",YD:"YD"},y={A:"A",Action:"Action",Active:"Active",AddMarkup:"AddMarkup",Address:"Address",AlignBottom:"AlignBottom",AlignCenter:"AlignCenter",AlignLeft:"AlignLeft",Alignment:"Alignment",Alignment0:"Alignment0",AlignMiddle:"AlignMiddle",AlignRight:"AlignRight",AlignTop:"AlignTop",Angle:"Angle",AsianFont:"AsianFont",AutoGen:"AutoGen",AvenueSizeX:"AvenueSizeX",AvenueSizeY:"AvenueSizeY",AvoidPageBreaks:"AvoidPageBreaks",B:"B",BeginArrow:"BeginArrow",BeginArrowSize:"BeginArrowSize",BeginGroup:"BeginGroup",BeginX:"BeginX",BeginY:"BeginY",BegTrigger:"BegTrigger",BevelBottomHeight:"BevelBottomHeight",BevelBottomType:"BevelBottomType",BevelBottomWidth:"BevelBottomWidth",BevelContourColor:"BevelContourColor",BevelContourSize:"BevelContourSize",BevelDepthColor:"BevelDepthColor",BevelDepthSize:"BevelDepthSize",BevelLightingAngle:"BevelLightingAngle",BevelLightingType:"BevelLightingType",BevelMaterialType:"BevelMaterialType",BevelTopHeight:"BevelTopHeight",BevelTopType:"BevelTopType",BevelTopWidth:"BevelTopWidth",BlockSizeX:"BlockSizeX",BlockSizeY:"BlockSizeY",Blur:"Blur",BottomMargin:"BottomMargin",Brightness:"Brightness",Bullet:"Bullet",BulletFont:"BulletFont",BulletFontSize:"BulletFontSize",BulletStr:"BulletStr",ButtonFace:"ButtonFace",C:"C",Calendar:"Calendar",CanGlue:"CanGlue",Case:"Case",CenterX:"CenterX",CenterY:"CenterY",Checked:"Checked",ClippingPath:"ClippingPath",Color:"Color",ColorSchemeIndex:"ColorSchemeIndex",ColorTrans:"ColorTrans",Comment:"Comment",ComplexScriptFont:"ComplexScriptFont",ComplexScriptSize:"ComplexScriptSize",CompoundType:"CompoundType",ConFixedCode:"ConFixedCode",ConLineJumpCode:"ConLineJumpCode",ConLineJumpDirX:"ConLineJumpDirX",ConLineJumpDirY:"ConLineJumpDirY",ConLineJumpStyle:"ConLineJumpStyle",ConLineRouteExt:"ConLineRouteExt",ConnectorSchemeIndex:"ConnectorSchemeIndex",Contrast:"Contrast",Copyright:"Copyright",CtrlAsInput:"CtrlAsInput",CurrentIndex:"CurrentIndex",D:"D",DataLinked:"DataLinked",DblUnderline:"DblUnderline",Default:"Default",DefaultTabStop:"DefaultTabStop",Denoise:"Denoise",Description:"Description",DirX:"DirX",DirY:"DirY",Disabled:"Disabled",DisplayLevel:"DisplayLevel",DisplayMode:"DisplayMode",DistanceFromGround:"DistanceFromGround",DocLangID:"DocLangID",DocLockDuplicatePage:"DocLockDuplicatePage",DocLockReplace:"DocLockReplace",DontMoveChildren:"DontMoveChildren",DoubleStrikethrough:"DoubleStrikethrough",DrawingResizeType:"DrawingResizeType",DrawingScale:"DrawingScale",DrawingScaleType:"DrawingScaleType",DrawingSizeType:"DrawingSizeType",DropOnPageScale:"DropOnPageScale",DynamicsOff:"DynamicsOff",DynFeedback:"DynFeedback",E:"E",EffectSchemeIndex:"EffectSchemeIndex",EmbellishmentIndex:"EmbellishmentIndex",EnableFillProps:"EnableFillProps",EnableGrid:"EnableGrid",EnableLineProps:"EnableLineProps",EnableTextProps:"EnableTextProps",EndArrow:"EndArrow",EndArrowSize:"EndArrowSize",EndTrigger:"EndTrigger",EndX:"EndX",EndY:"EndY",EventDblClick:"EventDblClick",EventDrop:"EventDrop",EventMultiDrop:"EventMultiDrop",EventXFMod:"EventXFMod",ExtraInfo:"ExtraInfo",FillBkgnd:"FillBkgnd",FillBkgndTrans:"FillBkgndTrans",FillForegnd:"FillForegnd",FillForegndTrans:"FillForegndTrans",FillGradientAngle:"FillGradientAngle",FillGradientDir:"FillGradientDir",FillGradientEnabled:"FillGradientEnabled",FillPattern:"FillPattern",Flags:"Flags",FlipX:"FlipX",FlipY:"FlipY",FlyoutChild:"FlyoutChild",Font:"Font",FontScale:"FontScale",FontSchemeIndex:"FontSchemeIndex",Format:"Format",Frame:"Frame",Gamma:"Gamma",GlowColor:"GlowColor",GlowColorTrans:"GlowColorTrans",GlowSize:"GlowSize",Glue:"Glue",GlueType:"GlueType",GradientStopColor:"GradientStopColor",GradientStopColorTrans:"GradientStopColorTrans",GradientStopPosition:"GradientStopPosition",Height:"Height",HelpTopic:"HelpTopic",HideForApply:"HideForApply",HideText:"HideText",HorzAlign:"HorzAlign",ImgHeight:"ImgHeight",ImgOffsetX:"ImgOffsetX",ImgOffsetY:"ImgOffsetY",ImgWidth:"ImgWidth",IndFirst:"IndFirst",IndLeft:"IndLeft",IndRight:"IndRight",InhibitSnap:"InhibitSnap",Initials:"Initials",Invisible:"Invisible",IsDropSource:"IsDropSource",IsDropTarget:"IsDropTarget",IsSnapTarget:"IsSnapTarget",IsTextEditTarget:"IsTextEditTarget",KeepTextFlat:"KeepTextFlat",Label:"Label",LangID:"LangID",LayerMember:"LayerMember",LeftMargin:"LeftMargin",Letterspace:"Letterspace",LineAdjustFrom:"LineAdjustFrom",LineAdjustTo:"LineAdjustTo",LineCap:"LineCap",LineColor:"LineColor",LineColorTrans:"LineColorTrans",LineGradientAngle:"LineGradientAngle",LineGradientDir:"LineGradientDir",LineGradientEnabled:"LineGradientEnabled",LineJumpCode:"LineJumpCode",LineJumpFactorX:"LineJumpFactorX",LineJumpFactorY:"LineJumpFactorY",LineJumpStyle:"LineJumpStyle",LinePattern:"LinePattern",LineRouteExt:"LineRouteExt",LineToLineX:"LineToLineX",LineToLineY:"LineToLineY",LineToNodeX:"LineToNodeX",LineToNodeY:"LineToNodeY",LineWeight:"LineWeight",LocalizeMerge:"LocalizeMerge",Lock:"Lock",LockAspect:"LockAspect",LockBegin:"LockBegin",LockCalcWH:"LockCalcWH",LockCrop:"LockCrop",LockCustProp:"LockCustProp",LockDelete:"LockDelete",LockEnd:"LockEnd",LockFormat:"LockFormat",LockFromGroupFormat:"LockFromGroupFormat",LockGroup:"LockGroup",LockHeight:"LockHeight",LockMoveX:"LockMoveX",LockMoveY:"LockMoveY",LockPreview:"LockPreview",LockReplace:"LockReplace",LockRotate:"LockRotate",LockSelect:"LockSelect",LockTextEdit:"LockTextEdit",LockThemeColors:"LockThemeColors",LockThemeConnectors:"LockThemeConnectors",LockThemeEffects:"LockThemeEffects",LockThemeFonts:"LockThemeFonts",LockThemeIndex:"LockThemeIndex",LockVariation:"LockVariation",LockVtxEdit:"LockVtxEdit",LockWidth:"LockWidth",LocPinX:"LocPinX",LocPinY:"LocPinY",Menu:"Menu",Name:"Name",NameUniv:"NameUniv",NewWindow:"NewWindow",NoAlignBox:"NoAlignBox",NoCoauth:"NoCoauth",NoCtlHandles:"NoCtlHandles",NoFill:"NoFill",NoLine:"NoLine",NoLiveDynamics:"NoLiveDynamics",NonPrinting:"NonPrinting",NoObjHandles:"NoObjHandles",NoProofing:"NoProofing",NoQuickDrag:"NoQuickDrag",NoShow:"NoShow",NoSnap:"NoSnap",ObjectKind:"ObjectKind",ObjType:"ObjType",OnPage:"OnPage",OutputFormat:"OutputFormat",Overline:"Overline",PageBottomMargin:"PageBottomMargin",PageHeight:"PageHeight",PageLeftMargin:"PageLeftMargin",PageLineJumpDirX:"PageLineJumpDirX",PageLineJumpDirY:"PageLineJumpDirY",PageLockDuplicate:"PageLockDuplicate",PageLockReplace:"PageLockReplace",PageRightMargin:"PageRightMargin",PageScale:"PageScale",PageShapeSplit:"PageShapeSplit",PagesX:"PagesX",PagesY:"PagesY",PageTopMargin:"PageTopMargin",PageWidth:"PageWidth",PaperKind:"PaperKind",PaperSource:"PaperSource",Perspective:"Perspective",PinX:"PinX",PinY:"PinY",PlaceDepth:"PlaceDepth",PlaceFlip:"PlaceFlip",PlaceStyle:"PlaceStyle",PlowCode:"PlowCode",Pos:"Pos",Position:"Position",Position0:"Position0",PreviewQuality:"PreviewQuality",PreviewScope:"PreviewScope",Print:"Print",PrintGrid:"PrintGrid",PrintPageOrientation:"PrintPageOrientation",Prompt:"Prompt",QuickStyleEffectsMatrix:"QuickStyleEffectsMatrix",QuickStyleFillColor:"QuickStyleFillColor",QuickStyleFillMatrix:"QuickStyleFillMatrix",QuickStyleFontColor:"QuickStyleFontColor",QuickStyleFontMatrix:"QuickStyleFontMatrix",QuickStyleLineColor:"QuickStyleLineColor",QuickStyleLineMatrix:"QuickStyleLineMatrix",QuickStyleShadowColor:"QuickStyleShadowColor",QuickStyleType:"QuickStyleType",QuickStyleVariation:"QuickStyleVariation",ReadOnly:"ReadOnly",ReflectionBlur:"ReflectionBlur",ReflectionDist:"ReflectionDist",ReflectionSize:"ReflectionSize",ReflectionTrans:"ReflectionTrans",Relationships:"Relationships",ReplaceCopyCells:"ReplaceCopyCells",ReplaceLockFormat:"ReplaceLockFormat",ReplaceLockShapeData:"ReplaceLockShapeData",ReplaceLockText:"ReplaceLockText",ResizeMode:"ResizeMode",ResizePage:"ResizePage",ReviewerID:"ReviewerID",RightMargin:"RightMargin",RotateGradientWithShape:"RotateGradientWithShape",RotationType:"RotationType",RotationXAngle:"RotationXAngle",RotationYAngle:"RotationYAngle",RotationZAngle:"RotationZAngle",Rounding:"Rounding",RouteStyle:"RouteStyle",ScaleX:"ScaleX",ScaleY:"ScaleY",SelectMode:"SelectMode",ShapeFixedCode:"ShapeFixedCode",ShapeKeywords:"ShapeKeywords",ShapePermeablePlace:"ShapePermeablePlace",ShapePermeableX:"ShapePermeableX",ShapePermeableY:"ShapePermeableY",ShapePlaceFlip:"ShapePlaceFlip",ShapePlaceStyle:"ShapePlaceStyle",ShapePlowCode:"ShapePlowCode",ShapeRouteStyle:"ShapeRouteStyle",ShapeShdwBlur:"ShapeShdwBlur",ShapeShdwObliqueAngle:"ShapeShdwObliqueAngle",ShapeShdwOffsetX:"ShapeShdwOffsetX",ShapeShdwOffsetY:"ShapeShdwOffsetY",ShapeShdwScaleFactor:"ShapeShdwScaleFactor",ShapeShdwShow:"ShapeShdwShow",ShapeShdwType:"ShapeShdwType",ShapeSplit:"ShapeSplit",ShapeSplittable:"ShapeSplittable",Sharpen:"Sharpen",ShdwBkgnd:"ShdwBkgnd",ShdwBkgndTrans:"ShdwBkgndTrans",ShdwForegnd:"ShdwForegnd",ShdwForegndTrans:"ShdwForegndTrans",ShdwObliqueAngle:"ShdwObliqueAngle",ShdwOffsetX:"ShdwOffsetX",ShdwOffsetY:"ShdwOffsetY",ShdwPattern:"ShdwPattern",ShdwScaleFactor:"ShdwScaleFactor",ShdwType:"ShdwType",Size:"Size",SketchAmount:"SketchAmount",SketchEnabled:"SketchEnabled",SketchFillChange:"SketchFillChange",SketchLineChange:"SketchLineChange",SketchLineWeight:"SketchLineWeight",SketchSeed:"SketchSeed",Snap:"Snap",SoftEdgesSize:"SoftEdgesSize",SortKey:"SortKey",SpAfter:"SpAfter",SpBefore:"SpBefore",SpLine:"SpLine",Status:"Status",Strikethru:"Strikethru",Style:"Style",SubAddress:"SubAddress",TagName:"TagName",TextBkgnd:"TextBkgnd",TextBkgndTrans:"TextBkgndTrans",TextDirection:"TextDirection",TextPosAfterBullet:"TextPosAfterBullet",TheData:"TheData",ThemeIndex:"ThemeIndex",TheText:"TheText",TopMargin:"TopMargin",Transparency:"Transparency",TxtAngle:"TxtAngle",TxtHeight:"TxtHeight",TxtLocPinX:"TxtLocPinX",TxtLocPinY:"TxtLocPinY",TxtPinX:"TxtPinX",TxtPinY:"TxtPinY",TxtWidth:"TxtWidth",Type:"Type",UICat:"UICat",UICod:"UICod",UIFmt:"UIFmt",UIVisibility:"UIVisibility",UpdateAlignBox:"UpdateAlignBox",UseGroupGradient:"UseGroupGradient",Value:"Value",VariationColorIndex:"VariationColorIndex",VariationStyleIndex:"VariationStyleIndex",Verify:"Verify",VerticalAlign:"VerticalAlign",ViewMarkup:"ViewMarkup",Visible:"Visible",WalkPreference:"WalkPreference",Width:"Width",X:"X",XCon:"XCon",XDyn:"XDyn",XGridDensity:"XGridDensity",XGridOrigin:"XGridOrigin",XGridSpacing:"XGridSpacing",XJustify:"XJustify",XRulerDensity:"XRulerDensity",XRulerOrigin:"XRulerOrigin",Y:"Y",YCon:"YCon",YDyn:"YDyn",YGridDensity:"YGridDensity",YGridOrigin:"YGridOrigin",YGridSpacing:"YGridSpacing",YJustify:"YJustify",YRulerDensity:"YRulerDensity",YRulerOrigin:"YRulerOrigin"},f={Shape:"Shape",Group:"Group",Foreign:"Foreign",Guide:"Guide",MasterShape1:"MasterShape1",MasterShape2:"MasterShape2",Dummy:"Dummy",LinkLabel:"LinkLabel"},Y={Actions:"Actions",ActionTag:"ActionTag",Character:"Character",Connection:"Connection",Control:"Control",Field:"Field",FillGradient:"FillGradient",Geometry:"Geometry",Hyperlink:"Hyperlink",Layer:"Layer",LineGradient:"LineGradient",Paragraph:"Paragraph",User:"User",Property:"Property",Scratch:"Scratch",Tabs:"Tabs"},q={Type:"@T",Name:"@N",UniqueIndex:"@IX",Deleted:"@Del"},p={Indexed:"Indexed",Named:"Named"},D={ArcTo:"ArcTo",Ellipse:"Ellipse",EllipticalArcTo:"EllipticalArcTo",InfiniteLine:"InfiniteLine",LineTo:"LineTo",MoveTo:"MoveTo",NURBSTo:"NURBSTo",PolylineTo:"PolylineTo",RelCubBezTo:"RelCubBezTo",RelEllipticalArcTo:"RelEllipticalArcTo",RelLineTo:"RelLineTo",RelMoveTo:"RelMoveTo",RelQuadBezTo:"RelQuadBezTo",SplineStart:"SplineStart",SplineKnot:"SplineKnot"},K={ShapeSimple:"ShapeSimple",ShapeGroupItem:"ShapeGroupItem",ShapeMaster:"ShapeMaster",ShapeGroup:"ShapeGroup",ShapeForeign:"ShapeForeign",ShapeGuide:"ShapeGuide",GeneralMaster:"GeneralMaster",ShapeDeleteOverride:"ShapeDeleteOverride"},v={archive:"archive",xmlPath:"xmlPath",shapeId:"shapeId",source:"source",target:"target",_rel:"_rel",alignName:"alignName",baseID:"baseID",base64:"base64",background:"background",backPage:"backPage",beginX:"beginX",beginY:"beginY",cells:"cells",colors:"colors",connects:"connects",deleted:"deleted",defaultLineStyle:"defaultLineStyle",defaultTextStyle:"defaultTextStyle",defaultFillStyle:"defaultFillStyle",defaultGuideStyle:"defaultGuideStyle",documentSheet:"documentSheet",documentSettings:"documentSettings",dynamicGridEnabled:"dynamicGridEnabled",endX:"endX",endY:"endY",faceNames:"faceNames",fillStyle:"fillStyle",foreignData:"foreignData",foreignShapes:"foreignShapes",fromSheet:"fromSheet",fromCell:"fromCell",fromPart:"fromPart",glueSettings:"glueSettings",hidden:"hidden",icon:"icon",iconSize:"iconSize",iconUpdate:"iconUpdate",id:"id",index:"index",isCustomNameU:"isCustomNameU",isCustomName:"isCustomName",lineStyle:"lineStyle",master:"master",masterId:"masterId",masterShapeId:"masterShapeId",masterShape:"masterShape",masterType:"masterType",matchByName:"matchByName",name:"name",nameU:"nameU",n:"n",originalId:"originalId",pages:"pages",pageSheet:"pageSheet",patternFlags:"patternFlags",prompt:"prompt",protectStyles:"protectStyles",protectShapes:"protectShapes",protectMasters:"protectMasters",protectBkgnds:"protectBkgnds",rels:"rels",relations:"relations",relMasterShape:"relMasterShape",rows:"rows",shapes:"shapes",shape:"shape",sections:"sections",snapSettings:"snapSettings",snapExtensions:"snapExtensions",snapAngles:"snapAngles",styleSheets:"styleSheets",text:"text",textStyle:"textStyle",topPage:"topPage",toSheet:"toSheet",toCell:"toCell",toPart:"toPart",type:"type",uniqueId:"uniqueId",val:"val",viewScale:"viewScale",viewCenterX:"viewCenterX",viewCenterY:"viewCenterY",xmlns:"xmlns","xmlns:r":"xmlns:r","xml:space":"xml:space",jxon:"jxon"},u={ignore:"ignore",number:"number",booleanStrict:"booleanStrict",booleanTriState:"booleanTriState",color:"color",asIs:"asIs",byte:"byte",date:"date",percentage:"percentage",internalUnitsToPixels:"internalUnitsToPixels",internalUnitsToDegrees:"internalUnitsToDegrees",resolveByPath:"resolveByPath"},Q={Shape_Type:"Shape_Type",Master_Type:"Master_Type",Section_Type:"Section_Type",Row_Type:"Row_Type"},r={PtgNum:"PtgNum",PtgByte:"PtgByte",PtgBool:"PtgBool",PtgString:"PtgString",PtgColorRGB:"PtgColorRGB",PtgShort:"PtgShort",PtgDate:"PtgDate",PtgInt:"PtgInt",PtgUnsShort:"PtgUnsShort",PtgNumI:"PtgNumI",vLanguageString:"vLanguageString",vFont:"vFont",vAny:"vAny",vAngle:"vAngle",vScalar:"vScalar",vLength:"vLength",vColor:"vColor",vFormatString:"vFormatString",formulaExpression:"formulaExpression"},S={AccentColor:"AccentColor",AccentColor2:"AccentColor2",AccentColor3:"AccentColor3",AccentColor4:"AccentColor4",AccentColor5:"AccentColor5",AccentColor6:"AccentColor6",AsianFont:"AsianFont",BackgroundColor:"BackgroundColor",BevelTopType:"BevelTopType",BevelTopWidth:"BevelTopWidth",BevelTopHeight:"BevelTopHeight",BevelMaterial:"BevelMaterial",BevelLighting:"BevelLighting",BevelLightingAngle:"BevelLightingAngle",BevelContourColor:"BevelContourColor",BevelContourSize:"BevelContourSize",ComplexFont:"ComplexFont",ConnectorColor:"ConnectorColor",ConnectorPattern:"ConnectorPattern",ConnectorWeight:"ConnectorWeight",ConnectorTransparency:"ConnectorTransparency",ConnectorRounding:"ConnectorRounding",ConnectorBegin:"ConnectorBegin",ConnectorEnd:"ConnectorEnd",ConnectorBeginSize:"ConnectorBeginSize",ConnectorEndSize:"ConnectorEndSize",Dark:"Dark",FillColor:"FillColor",FillColor2:"FillColor2",FillGradientEnabled:"FillGradientEnabled",FillGradientDir:"FillGradientDir",FillGradientAngle:"FillGradientAngle",FillPattern:"FillPattern",FillTransparency:"FillTransparency",GlowSize:"GlowSize",GlowColor:"GlowColor",GlowTransparency:"GlowTransparency",LatinFont:"LatinFont",Light:"Light",LineCap:"LineCap",LineColor:"LineColor",LineColorTrans:"LineColorTrans",LineCompoundtype:"LineCompoundtype",LineGradientEnabled:"LineGradientEnabled",LineGradientDir:"LineGradientDir",LineGradientAngle:"LineGradientAngle",LinePattern:"LinePattern",LineWeight:"LineWeight",LineBegin:"LineBegin",LineEnd:"LineEnd",LineBeginSize:"LineBeginSize",LineEndSize:"LineEndSize",LineRounding:"LineRounding",RotateGradientWithShape:"RotateGradientWithShape",ReflectionBlur:"ReflectionBlur",ReflectionDist:"ReflectionDist",ReflectionSize:"ReflectionSize",ReflectionTrans:"ReflectionTrans",ShadowType:"ShadowType",ShadowColor:"ShadowColor",ShadowTransparency:"ShadowTransparency",ShadowMagnification:"ShadowMagnification",ShadowBlur:"ShadowBlur",ShadowXOffset:"ShadowXOffset",ShadowYOffset:"ShadowYOffset",ShadowDirection:"ShadowDirection",ShadowPattern:"ShadowPattern",SoftEdgesSize:"SoftEdgesSize",SketchAmount:"SketchAmount",SketchEnabled:"SketchEnabled",SketchFillChange:"SketchFillChange",SketchLineChange:"SketchLineChange",SketchLineWeight:"SketchLineWeight",TextColor:"TextColor",TextStyle:"TextStyle",UseGroupGradient:"UseGroupGradient",VariantColor1:"VariantColor1",VariantColor2:"VariantColor2",VariantColor3:"VariantColor3",VariantColor4:"VariantColor4",VariantColor5:"VariantColor5",VariantColor6:"VariantColor6",VariantColor7:"VariantColor7"},Z={Actions:p.Named,Character:p.Indexed,Connection:p.Indexed,Control:p.Named,Field:p.Indexed,FillGradient:p.Indexed,Geometry:p.Indexed,Hyperlink:p.Named,Layer:p.Indexed,LineGradient:p.Indexed,Paragraph:p.Indexed,Property:p.Named,Reviewer:p.Indexed,Scratch:p.Indexed,ActionTag:p.Named,Tabs:p.Indexed,User:p.Named},W={CONSOLE:1,TOOLTIPS:4,TEXT_FRAMES:4,level:0,log:function(){W.level&W.CONSOLE&&console.log(...arguments)}};function ee(e){"string"!=typeof e&&W.log("Value to convert is not a string.",e)}function m(e){return ee(e),Number(e)}function te(e){return ee(e),Number(e)}function ie(e,t){var{triState:t=!0}=1<arguments.length&&void 0!==t?t:{};return t&&void 0===e?(W.log("boolean as a null"),null):re(e)}function re(e){return"0"!==e&&"1"!==e&&W.log("Can't convert string to boolean",e),"1"===e}function le(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h.IN;switch(void 0!==e&&t||W.log("Value and target unit type are required to convert to a pixel value."),t){case h.IN:case h.IN_F:case h.DL:case h.DP:return 96*e;case h.MM:return ae(e);case h.CM:var i=e;return ae(i*=10);case h.DT:case h.PT:i=e;return 96*(i/=72);default:return W.log(`Unsupported numeric unit type "${oe(t)}" ("${t}")`),e}}function ae(e){return 3.7795275591*e}function se(e){return e/3.7795275591}function ne(e){return e/96}function oe(e){if(h.hasOwnProperty(e))return{[h.AC]:"Acres",[h.DEG]:"Degrees",[h.DA]:"Radians",[h.AD]:"Degrees-minutes-seconds",[h.RAD]:"Radians",[h.BOOL]:"Boolean",[h.COLOR]:"RGB color value",[h.CY]:"Currency",[h.DATE]:"Days",[h.ED]:"Days",[h.EH]:"Hours",[h.EM]:"Minutes",[h.ES]:"Seconds",[h.EW]:"Weeks",[h.HA]:"Hectare",[h.CM]:"Centimeters",[h.DL]:"Inches",[h.FT]:"Feet",[h.F_I]:"Feet and inches",[h.IN]:"Inches",[h.IN_F]:"Inches",[h.KM]:"Kilometers",[h.M]:"Meters",[h.MI]:"Miles",[h.MI_F]:"Miles",[h.MM]:"Millimeters",[h.NM]:"Nautical miles",[h.PER]:"Percentage",[h.YD]:"Yards",[h.DP]:"Inches",[h.PNT]:"Coordinates of a two-dimensional point",[h.STR]:"String",[h.DE]:"Days",[h.C_D]:"Ciceros and didots",[h.C]:"Ciceros",[h.D]:"Didots",[h.DT]:"Points",[h.P]:"Picas",[h.P_PT]:"Picas and points",[h.PT]:"Points"}[e];throw`Unknown unit type "${e}".`}let{sqrt:B,cos:he,sin:ue,atan2:P,abs:I}=Math,R=0,E=0,ge=null;function ce(e,P,b){switch(e){case D.MoveTo:return de(P);case D.LineTo:var t=P,{x:t=R,y:i=E}=t;return R=t,E=i,` L ${F(t)} `+F(i);case D.ArcTo:var{x:t,y:i,a:r}=t=P;return 0===r?` L ${t} `+i:(L=R,V=E,L=I(t-L),V=I(i-V),V=L=I(F(.5*r+(L*L+V*V)/(8*r),2)),A=I(L),t=F(t,2),i=F(i,2),M=0<(r=F(r,2))?1:0,A=A<I(r)?1:0,R=t,E=i,` A ${L} ${V} 0 ${A} ${M} ${t} `+i);case D.EllipticalArcTo:return pe(P);case D.Ellipse:return L=(r=P).x,V=r.y,A=r.a,M=r.b,l=r.c,r=r.d,A=I(A-L),M=I(M-V),A=B(A*A+M*M),M=I(l-L),l=I(r-V),r=B(M*M+l*l),` M ${L-A} ${V} A ${A} ${r} 0 1 0 ${L+A} ${V} A ${A} ${r} 0 1 0 ${L-A} `+V;case D.InfiniteLine:var{x:l,y:a,a:s,b:n}=l=P;return` L ${l} ${a} ${s} `+n;case D.SplineStart:var a=P,{x:s=R,y:n=E}=a;s=F(s,2),n=F(n,2),ge={points:[[R,E],[s,n]],knots:[a.b,a.a,a.c],degree:a.d},R=s,E=n;break;case D.SplineKnot:var o=P,{x:o=R,y:h=E,a:u}=o;R=o=F(o,2),E=h=F(h,2),ge&&({points:g,knots:c}=ge,g.push([o,h]),c.splice(c.length-1,0,u));break;case D.RelMoveTo:{var g=P;o=b;let{width:e,height:t}=o,{x:i=R,y:r=E}=g;return i*=e,r*=t,R=i,E=r,` M ${F(i)} `+F(r);return}case D.RelLineTo:{h=P;var c=b;let{width:e,height:t}=c,{x:i=R,y:r=E}=h;return i*=e,r*=t,R=i,E=r,` L ${F(i)} `+F(r);return}case D.RelCubBezTo:var u=P,{width:d,height:p}=d=b,v=u.x*d,S=u.y*p,m=u.a*d,C=u.b*p,d=u.c*d,u=u.d*p;return R=v,E=S,` C ${F(m)} ${F(C)} ${F(d)} ${F(u)} ${F(v)} `+F(S);case D.RelQuadBezTo:var p=P,{width:m,height:C}=m=b,d=p.x*m,v=p.y*C,m=p.a*m,p=p.b*C;return R=d,E=v,` Q ${F(m)} ${F(p)} ${F(d)} `+F(v);case D.RelEllipticalArcTo:var S=P,{width:f,height:y}=f=b,{x:S,y:x,a:w,b:_,c:T,d:k}=S;return pe({x:S*f,y:x*y,a:w*f,b:_*f,c:T,d:k});case D.PolylineTo:{x=P;y=b;let{x:e,y:t,a:i}=x,{width:r,height:l}=y,[a,s,...n]=Se(i),o=n.map((e,t)=>{let i;return F(i=t%2==0?0===a?e*r:96*e:0===s?e*l:96*e,2)});return o.push(e,t),R=e,E=t,"L "+o.join(" ");return}case D.NURBSTo:{w=P;_=b;let{x:e,y:t,a:i,b:r,c:l,d:a}=w,s=w.e;if(!s&&(W.log("NURBS value is missing"),{formula:s}=w.get("e"),!s))return"";let{width:n,height:o}=_,h=[[R,E]],u=[l],g=[a],[c,d,p,v,...S]=Se(s),m,C,f,y;for(;0<S.length;)[m,C,f,y,...S]=S,m*=0===p?n:96,C*=0===v?o:96,h.push([m,C]),u.push(f),g.push(y);return u.push(i,c),h.push([e,t]),g.push(r),R=e,E=t,0===(w=N(d,h,u,g).join(" ")).length?"":" L "+w;return}}var L,V,A,M;return""}function de(e){var{x:e=R,y:t=E}=e;return R=e,E=t,` M ${F(e)} `+F(t)}function pe(e){var{x:e=R,y:t=E,a:i=0,b:r=0,c:l=0,d:a=0}=e,s=R,n=E,o=e,h=t,l=-l,u=(R=e,E=t,z.g.toRad(l)),g=B(s*s+n*n)*he(P(n,s)-u),c=B(s*s+n*n)*ue(P(n,s)-u),d=B(o*o+h*h)*he(P(h,o)-u),p=B(o*o+h*h)*ue(P(h,o)-u),v=B(i*i+r*r)*he(P(r,i)-u),u=B(i*i+r*r)*ue(P(r,i)-u),S=(d-v)*(c-p)-(g-d)*(p-u);if(0==S)return` L ${o} `+h;var m=((g-d)*(g+d)*(p-u)-(d-v)*(d+v)*(c-p)+a*a*(c-p)*(p-u)*(c-u))/(2*((g-d)*(p-u)-(d-v)*(c-p))),S=((g-d)*(d-v)*(g-v)/(a*a)+(d-v)*(c-p)*(c+p)-(g-d)*(p-u)*(p+u))/(2*S),C=g-m,f=c-S,C=B(C*C+f*f*a*a),f=C/a,a=0<(o-s)*(r-n)-(h-n)*(i-s)?0:1;let y=0;return((e,t,i,r,l,a,s,n)=>(i=(l-=i)*(n-=r)-(s-=i)*(a-=r),r=(e*(a-n)+t*(s-l)+l*n-s*a)/i,n=(e*n-t*s)/i,s=(t*l-e*a)/i,0<r&&r<1&&0<n&&n<1&&0<s&&s<1))(m,S,g,c,d,p,v,u)&&((e,t,i,r,l,a,s,n)=>(i-=e,r-=t,a-=t,l=s-e,n-=t,t=e=0,r=z.g.toDeg(P(r,i)-P(t,e)),i=z.g.toDeg(P(a,l)-P(t,e)),a=z.g.toDeg(P(n,s)-P(t,e)),r=z.g.normalizeAngle(r-a),i=z.g.normalizeAngle(i-a),(0<r&&i<0||r<0&&0<i)&&180<I(r-i)))(m,S,g,c,d,p,v,u)&&(y=1),` A ${F(C,2)} ${F(f,2)} ${l} ${y} ${a} ${F(e,2)} `+F(t,2)}function ve(e,t,i){return" L "+N(i,e,t).join(" ")}function Se(e){return e.replace(/[A-Z]|\(|\)/g,"").split(/\s*,\s*/).map(e=>Number(e))}function b(e){return Array.isArray(e)?e:[e]}function me(e,t){let{width:n,height:o}=t;return b(e).map(l=>{{var a={width:n,height:o};let{width:e,height:t}=a,i=l.rows,r=i.map(e=>({name:e.type,cells:e.cells}));{a=r;var{width:l,height:s}=l={width:e,height:t};let n={width:l,height:s},o="";return R=E=0,ge=null,a.forEach(function(e,t,i){var{name:e,cells:r}=e;if(0===t&&e!==D.MoveTo&&(o+=de({x:0,y:0})),ge){var{points:l,knots:a,degree:s}=ge;if(i.length===t+1)return ce(e,r,n),void(o+=ve(l,a,s));e!==D.SplineKnot&&(o+=ve(l,a,s),ge=null)}o+=ce(e,r,n)}),o}}}).join(" ")}class Ce{getDefaultAttributes(){return{archive:null}}constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set,e=(this.assertArchiveDefined(e),{...this.getDefaultAttributes(),...e});t.add(v.archive),this._prefixList=t,this.setAttributes(e)}get prefixList(){return this._prefixList}setAttribute(e,t){this.prefixList.has(e)&&(e="_"+e),this[e]=t}setAttributes(e){Object.entries(e).forEach(e=>{var[e,t]=e;return this.setAttribute(e,t)}),"structurePath"in e&&this.setOwner(e.structurePath)}setOwner(e){1===e.length?this.owner=e[0].jxonType:t(e,g.StyleSheet)?this.owner="Document-Stylesheet":t(e,g.DocumentSheet)?this.owner="Document-DocumentSheet":t(e,g.PageSheet)?t(e,g.Page)?this.owner="Page-PageSheet":t(e,g.Master)?this.owner="Master-PageSheet":W.log("Unknown PageSheet owner"):t(e,g.Shape)&&(t(e,g.Page)?this.owner="Page-Shape":t(e,g.Master)?this.owner="Master-Shape":W.log("Unknown Shape owner"))}set parent(e){this._parent=e}get parent(){return this._parent}get archive(){return this._archive}assertArchiveDefined(e){e.hasOwnProperty("archive")&&e.archive||W.log("Missing archive reference in constructor",this)}}function t(e,t){return e.some(e=>e.jxonType===t)}function fe(e){return"string"!=typeof e?"":e.charAt(0).toLowerCase()+e.slice(1)}class ye{constructor(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};this._name=e.name,this._value=e.value,this._formula=e.formula,this._units=e.units,this._cells=e.cells}get name(){return this._name}get value(){return this._value}get formula(){return this._formula}get units(){return this._units}eval(){return this._cells[fe(this.name)]}}class Pe extends Ce{getOwnCellNames(){var e=this.cells;return e?e.getOwnNames():[]}getCell(e){var t=this.cells;return t?(e=t.get(e))?new ye({...e,cells:t}):null:(W.log("Visio object does not contain cells."),null)}setCell(e,t){var{cells:i,jxon:r}=this;i?i.set(e,t,r):W.log("Visio object does not contain cells.")}removeCell(e){var{cells:t,jxon:i}=this;t&&t.get(e)&&t.remove(e,i)}}function be(e,t){var i=(e=>["pageBottomMargin","pageLeftMargin","pageRightMargin","pageTopMargin"].includes(e.name)?u.internalUnitsToPixels:null)(t);if(null!==i)return i;if(t.units===h.PER)return u.percentage;switch(e){case r.vScalar:case r.PtgNum:case r.PtgByte:case r.PtgShort:case r.PtgUnsShort:case r.PtgInt:case r.PtgNumI:return u.number;case r.vLength:return u.internalUnitsToPixels;case r.PtgDate:return u.date;case r.vAngle:return u.internalUnitsToDegrees;case r.PtgBool:return u.booleanStrict;case r.PtgColorRGB:case r.vColor:return u.color;case r.vAny:"STR"!==t.units&&"value"!==t.name&&W.log("resolve VisioValueType.vAny",t);case r.vFont:case r.vLanguageString:case r.vFormatString:case r.PtgString:case r.formulaExpression:return u.asIs}W.log("unresolved cell type")}let xe={evaluateFormulas:!1};function we(e){return e===S.Light?"#ffffff":e===S.Dark?"#000000":e===S.AccentColor?"#c05046":e===S.AccentColor2?"#9dbb61":e===S.AccentColor3?"#ab9ac0":e===S.AccentColor4?"#4bacc6":e===S.AccentColor5?"#f59d56":e===S.AccentColor6?"#ffc000":e===S.VariantColor1?"#c05046":e===S.VariantColor2?"#9dbb61":e===S.VariantColor3?"#ab9ac0":e===S.VariantColor4?"#4bacc6":e===S.VariantColor5?"#f59d56":e===S.VariantColor6?"#ffc000":e===S.VariantColor7?"#000000":void W.log("Unknown themeVal")}function _e(e,t){return v.hasOwnProperty(e)||W.log("Unknown VisioAttribute."+e),null===t?null:[v.id,v.masterId,v.masterShapeId,v.fromSheet,v.fromPart,v.toSheet,v.toPart,v.index].includes(e)?te(t):[v.patternFlags,v.masterType,v.alignName,v.iconSize,v.topPage,v.defaultTextStyle,v.defaultLineStyle,v.defaultFillStyle,v.defaultGuideStyle,v.glueSettings,v.snapSettings,v.snapExtensions,v.fillStyle,v.lineStyle,v.textStyle,v.backPage].includes(e)?m(t):[v.isCustomNameU,v.isCustomName,v.hidden,v.iconUpdate,v.matchByName,v.protectStyles,v.protectShapes,v.protectMasters,v.protectBkgnds,v.dynamicGridEnabled,v.deleted,v.background].includes(e)?ie(t):t}function Te(e,r,t){t||W.log("Structure path not set.",{jxon:e,jxonType:r}),g.hasOwnProperty(r)||W.log(`Unknown "VisioJXONType.${r}"`);t=Object.entries(e).filter(e=>{var[e,,]=e;return"@"===e[0]}).filter(e=>{var[e,,]=e;return![o.xmlns,o.xmlnsR,o.xmlSpace].includes(e)}).reduce((e,t)=>{var[t,i]=t,t=ke(t.substring(1),r);return e[t]=_e(t,i),e},{});return t}function ke(e,t){if("IX"===e)return"index";if("ID"===e)return"id";if("UniqueID"===e)return"uniqueId";if("OriginalID"===e)return"originalId";if(e===q.Deleted.substring(1))return v.deleted;if(t===g.ShapeText&&e===H.Content)return"content";if(t===g.Section&&e===O.Name.substring(1))return"type";if(t===g.Row){if(e===q.Type.substring(1))return"type";if(e===q.Name.substring(1))return"name"}if(t===g.Shape){if(e===n.MasterShapeId.substring(1))return v.masterShapeId;if(e===n.MasterId.substring(1))return v.masterId}return fe(e)}function Le(e,t,i,r){var{typeOverride:r=null,structurePathEnrichObject:l=null}=3<arguments.length&&void 0!==r?r:{};i&&t||W.log("Missing required attributes.");let a={jxonType:e,xsdType:e+"_Type"},s=Te(t,e,i);return[v.id,v.name,v.masterId,v.masterShapeId,v.type,v.index].forEach(e=>{s.hasOwnProperty(e)&&(a[e]=s[e])}),r&&(a.type=r),a=l?{...a,...l}:a}function Ve(e,t,i){return 0<=e?e:(e=-e/96,((e,t)=>{let i=t.size;return e.forEach(e=>{var t,e=e.characterProperties;e&&(t=e.values.size,void 0!==e.values.size)&&(i=Math.max(i,t))}),i})(t,i)*e)}function Ae(e,t){t=t||{};let m=t.attributes,C=t.annotations,f=null==t.maxWidth?1e6:t.maxWidth;var t=!!t.overflowAllowed,i=e.split("\n");let r=i.length,l=0,a,y=0,s="",P=0,n=z.util.merge([],C),b,x;i.forEach(function(e){a=0,b=[],x=[];let t=g(e);for(;t;)!function e(t){let i=!!b.length;let r=!!x.length;let l=!i&&!r;let a="";i&&(a=b[b.length-1].cumulativeText);r&&(a=x[x.length-1].cumulativeText);let s=a+t.text;let n=y-a.length;let o=y+t.text.length;let h=z.V.findAnnotationsBetweenIndexes(C,n,o);let u=P-a.length;let g=z.util.toArray(h).reduce(function(e,t){return e.push({start:t.start-u,end:t.end-u,attrs:t.attrs}),e},[]);let c=Fe(s,m,g).width;let d="whitespace"===t.type;let p=c<=f;if(!r&&(p||d))return w(t.text),void _(t,s);let v="piece"===t.type;let S=l;if(S)return w(t.text),void _(t,s);v&&0<t.pieceIndex&&w("-",!0);i&&T();r&&k();e(t)}(t),t=g(e);x.length&&k(),l<r-1&&w("\n"),l+=1});var i=s.split("\n"),o=i.length;if(t&&1===r&&2===i.length){var t=i[0],i=i[1],h=z.util.merge([],n),u=z.V.findAnnotationsBetweenIndexes(h,0,t.length),h=z.V.shiftAnnotations(z.V.findAnnotationsBetweenIndexes(h,t.length,t.length+i.length),t.length,-t.length-1),t=this.measureText(t,m,u).width;if(this.measureText(i,m,h).width<Math.min(.4*t,100))return{numLines:o,text:e,annotations:C}}return{numLines:o,text:s,annotations:n};function g(e){for(var t={type:null,startIndex:a,endIndex:a,text:""};a<e.length;){var i=e[a];if(/\s/.test(i))switch(t.type){case null:case"whitespace":t.type="whitespace",t.text+=i,t.endIndex+=1;break;default:return t}else{if("whitespace"===t.type)return t;t.type="word",t.text+=i,t.endIndex+=1}a+=1}return t.startIndex===t.endIndex?null:t}function w(e,t){s+=e,t&&z.V.shiftAnnotations(n,y,e.length),P+=e.length}function _(e,t){b.push({token:e,cumulativeText:t}),y+=e.text.length}function T(){var e=b[b.length-1];"whitespace"===e.type&&(e=e.text,z.V.shiftAnnotations(n,y,-e.length),P-=e.length),w("\n",!0),b=[]}function k(){let t="";x.forEach(function(e){t+=e.token.text,w(e.token.text),_(e.token,t),y-=e.token.text.length}),x=[]}}let Me;function Fe(e,t,i,r){var t=t||{},r=r||{heightCompensation:!1},l=(Me||(l=z.V("svg"),document.body.appendChild(l.node),(Me=z.V("text")).attr("visibility","hidden"),l.append(Me)),Me.attr({"font-weight":t["font-weight"],"font-size":t["font-size"],"font-family":t["font-family"],"letter-spacing":t["letter-spacing"],style:"font-kerning: none"}),Me.text(e,{lineHeight:z.util.isEmpty(i)?t["line-height"]||"1em":"auto",replaceNewLine:"\u2002",annotations:i}),Me.node.removeAttribute("display"),Me.bbox(!0));return r.heightCompensation&&(l.height-=l.y),l.y=0,l.x=0,l}function De(e){let h=[],u=null,g=null,c=10,d=[],p,v=0;var t=e.text;let{spLine:i,horzAlign:r}=e.sections.get("Paragraph")[0].rows[0].cells,S=(t.forEach(e=>{e.paragraphProperties&&(void 0!==(e=e.paragraphProperties.values).spLine&&(i=e.spLine),void 0!==e.horzAlign)&&(r=e.horzAlign)}),e.sections.get("Character")[0].rows[0].cells);e=Ve(i,t,S),t.forEach(e=>{let t=e.content;p=v;var i=t.length;v=p+i;let{uppercase:r,font:l,color:a,style:s,size:n,letterspace:o}=S;e.characterProperties&&(void 0!==(i=e.characterProperties.values).uppercase&&(r=i.uppercase),void 0!==i.font&&(l=i.font),void 0!==i.color&&(a=i.color),void 0!==i.style&&(s=i.style),void 0!==i.size&&(n=i.size),void 0!==i.letterspace)&&(o=i.letterspace);e={},1===r&&(t=t.toUpperCase()),2===r&&(t="string"!=typeof(i=t)?"":i.charAt(0).toUpperCase()+i.slice(1),e["text-transform"]="capitalize"),o&&0!==o&&(e["letter-spacing"]=o),l&&(u=u||l,e["font-family"]=l),void 0!==n&&(g=g||n,e["font-size"]=n,e["font-size"]<1&&(e["font-size"]=12),c=Math.max(c,e["font-size"])),void 0!==a&&(e.fill=a),void 0!==s&&(4&s&&(e["text-decoration"]="underline"),2&s&&(e["font-style"]="italic"),1&s)&&(e["font-weight"]="bold"),h.push(t),i={start:p,end:v,attrs:e};d.push(i)}),t=h.join("").trimEnd();return{mergedText:t,annotations:d,lineHeight:e,firstFont:u,firstFontSize:g,horzAlign:r}}function Be(e,t){var{markup:t,attrs:i,prefix:r,isRootGroupText:l}=t,{cells:a,width:s,height:n}=e,{angle:a,locPinX:o=s/2,locPinY:h=n/2,txtAngle:u=0,flipX:g,flipY:c,txtHeight:d=n,txtWidth:p=s,txtPinX:v=s/2,txtPinY:S=n/2,txtLocPinX:m=p/2,txtLocPinY:C=d/2,verticalAlign:f,leftMargin:y=0,rightMargin:P=0,topMargin:b=0,bottomMargin:x=0}=a,r=r+"text";let w=g?-1:1,_=c?-1:1,T=g?-p+o-v+m:-o+v-m,k=c?n-h+S-C:n-d+h-S+C,L=a,V=g?p-o+v-m:o-v+m,A=c?h-S+C:d-h+S-C,M=w*_*u,F=g?m-p:m,D=c?C:d-C;l&&(T+=o,k-=h);var a=[`translate(${T}, ${k})`,`rotate(${L}, ${V}, ${A})`,`rotate(${M}, ${F}, ${D})`].join(" "),u=[{tagName:"text",selector:r,attributes:{stroke:"none",fill:"#000000"}}],{mergedText:g,annotations:c,lineHeight:l,firstFont:o,firstFontSize:h,horzAlign:t}=(W.level&W.TEXT_FRAMES&&u.unshift({tagName:"rect",attributes:{width:p,height:d,fill:"transparent",stroke:"#ff0000",strokeWidth:1}}),t.push({tagName:"g",text:!0,attributes:{transform:a},children:u}),De(e)),a=Ae(g,{annotations:c,hyphenationAllowed:!1,maxWidth:p-y-P}),u=i[r]={text:a.text,lineHeight:l,fontFamily:o||"sans-serif",letterSpacing:0,firstFontSize:h,annotations:a.annotations};z.util.assign(u,(e=>{let{verticalAlign:t,height:i,topMargin:r,fontShoulder:l,bottomMargin:a,txtHeight:s=i}=e,n=(r+s-a)/2,o="middle";switch(t){case 1:break;case 2:n=s-a-l,o="bottom";break;default:n=r+l,o="top"}return{y:n,textVerticalAnchor:o}})({verticalAlign:f,height:n,topMargin:b,fontShoulder:(l-h)/2,bottomMargin:x,txtPinY:S,txtLocPinY:C,txtHeight:d}),(e=>{let{horzAlign:t,width:i,leftMargin:r,rightMargin:l,txtWidth:a=i}=e,s=(r+a-l)/2,n="middle";switch(t){case 0:s=r,n="start";break;case 2:s=a-l,n="end"}return{x:s,textAnchor:n}})({horzAlign:t,width:s,leftMargin:y,rightMargin:P,txtPinX:v,txtLocPinX:m,txtWidth:p}))}function Ie(e,t){var t=t.maxWidth,{mergedText:e,annotations:i}=De(e);return Fe(Ae(e,{annotations:i,maxWidth:t}).text,{},i)}function Re(e){var t=e[0]/239*360,i=e[1]/240,e=e[2]/240;let r=(1-Math.abs(2*e-1))*i,l=r*(1-Math.abs(t/60%2-1)),a=e-r/2,s=0,n=0,o=0;return 0<=t&&t<60?(s=r,n=l,o=0):60<=t&&t<120?(s=l,n=r,o=0):120<=t&&t<180?(s=0,n=r,o=l):180<=t&&t<240?(s=0,n=l,o=r):240<=t&&t<300?(s=l,n=0,o=r):300<=t&&t<360&&(s=r,n=0,o=l),s=Math.round(255*(s+a)).toString(16),n=Math.round(255*(n+a)).toString(16),o=Math.round(255*(o+a)).toString(16),1===s.length&&(s="0"+s),1===n.length&&(n="0"+n),1===o.length&&(o="0"+o),"#"+s+n+o}function Ee(e){return e[0]}function Ne(e){return e[0]}function Ge(e){return e.reduce(function(e,t){return Math.max(e,t)})}function Xe(e){var[e,t]=e;return Math.atan2(e,t)}function Oe(e){return Math.sqrt(e[0])}function ze(e){return"1"===e[0].toString()?e[1]:e[2]}function Ye(e){var[e,t]=e;if(isNaN(e)||isNaN(t))throw Error("#VALUE");if(e=parseInt(e),t=parseInt(t),e<0||t<0)throw Error("#NUM");return Math.floor(e)!==e||Math.floor(t)!==t||0xffffffffffff<e||0xffffffffffff<t?"#NUM!":((e^t)>>>0).toString(2)}class We extends k.Parser{constructor(e,t){super(),this.registerFunctions(e,t),this.registerEvents(t)}registerFunctions(e,t){this.setFunction("HSL",Re),this.setFunction("PAGENUMBER",function(e){return e.page.index+1}.bind(this,t)),this.setFunction("PAGECOUNT",function(e){return(e=e.pages.pages)?e.length:0}.bind(this,t.archive.document)),this.setFunction("GUARD",Ee),this.setFunction("PAR",Ne),this.setFunction("PNT",function(e,t){switch(e.name[e.name.length-1]){case"X":return t[0];case"Y":return t[1];default:throw Error("#VALUE")}}.bind(this,e)),this.setFunction("ATAN2",Xe),this.setFunction("SQRT",Oe),this.setFunction("IF",ze),this.setFunction("BITXOR",Ye),this.setFunction("MAX",Ge),this.setFunction("TEXTWIDTH",function(e,t){var[,t]=t,t=isNaN(t)?1e6:96*t,{leftMargin:i=0,rightMargin:r=0}=e.cells;return ne(Ie(e,{maxWidth:t}).width+i+r)}.bind(this,t)),this.setFunction("TEXTHEIGHT",function(e,t){var[,t]=t,t=isNaN(t)?1e6:96*t,{topMargin:i=0,bottomMargin:r=0}=e.cells;return ne(Ie(e,{maxWidth:t}).height+i+r)}.bind(this,t))}registerEvents(e){this.on("callFunction",e=>{this.getFunction(e)}),this.on("callVariable",function(e,t,i){{var r;if(t===Ue.THE_TEXT)return r=De(e).mergedText,i(r)}let l=t.charAt(0).toLowerCase()+t.slice(1),a=e.cells.get(l);a=a||e.cells.getParentCell(l);{if(!(r=a?a.value:null)&&0!==r)throw Error("#N/A");i(r)}}.bind(this,e))}}let Ue={THE_TEXT:"TheText"};function je(e,t){var{pinX:t=0,pinY:i=0,locPinX:r=0,locPinY:l=0,angle:a=0}=t.cells,t=ne(t-r),r=ne(i-l),{x:i,y:l}=e;return t=i+=e=t,r=l+=i=r,l=a,l=Math.PI/180*l,a=Math.cos(l),l=Math.sin(l),{x:a*(t-e)+l*(r-i)+e,y:a=a*(r-i)-l*(t-e)+i}}function He(e,t){let i=e.formula;switch(i){case"Inh":i=((e,t)=>{if(t.masterShape){var i=t.masterShape.cells.get(e.name);if(i&&i.formula)return i.formula}return i=t.archive.document,(t=i.pageSheet.cells.get(e.name))&&t.formula?t.formula:null})(e,t);break;case"No Formula":i=void 0}return i}let Je={PAR:"PAR"},$e={Actions:{alias:"Actions",default:"Menu"},Char:{alias:"Character"},Connections:{alias:"Connection"},Controls:{alias:"Control",default:"X"},Fields:{alias:"Field"},FillGradientStops:{alias:"FillGradient"},Geometry:{alias:"Geometry",indexedName:!0},Hyperlink:{alias:"Hyperlink",default:"Description"},Layers:{alias:"Layer"},LineGradientStops:{alias:"LineGradient"},Para:{alias:"Paragraph"},Prop:{alias:"Property",default:"Value"},Reviewer:{alias:"Reviewer"},Scratch:{alias:"Scratch"},SmartTags:{alias:"ActionTag",default:"X"},Tabs:{alias:"Tabs"},User:{alias:"User",default:"Value"}},x={singleCharOperator:/([-+^*/&<>=])/,multiCharOperator:/(<>|<=|>=)/,parentheses:/([()])/,singleParentheses:/^[()]$/,unitValue:/([-])?([0-9]+)([A-Z]*)/,potentialFunc:/^[A-Z]{2,}$/g},qe={operatorSplit:new RegExp(`(?:${x.multiCharOperator.source}|${x.singleCharOperator.source}|${x.parentheses.source})`,"gm"),skipEvaluation:new RegExp(`^${x.singleCharOperator.source}|${x.multiCharOperator.source}|${x.parentheses.source}$`),referencedVariable:new RegExp("([\\w]+)\\.([\\d]+)(?:[!])","gm")};function Ke(n,e,t){var i=t||{},r=n.split(qe.operatorSplit).filter(e=>e);let l=0,a=[];for(;l<r.length;){var s,o,h=r[l];h.match(qe.skipEvaluation)?(a.push(h),l++):h.match(x.potentialFunc)?(o=(s=((e,t)=>{let i=t+1,r=i,l=0,a;for(;r<e.length&&(e[r].match(x.singleParentheses)&&(l+="("===e[r]?1:-1,a=!0),r++,!a||0!==l););return e.slice(i,r)})(r,l)).join(""),h===Je[h]&&(i.ctxType=i.ctxType||Je[h]),o=Ke(o,e,i),a.push(h+o),l+=s.length+1):(o=((e,t,i)=>{let r=i||{},l;r.ctxType===Je.PAR&&(i=(t=>{if(t){var i,r=t.split(qe.referencedVariable);let e=r.length;for(;0<=e;){if("Sheet"===r[e])return i=r[e+1],Number.isNaN(i)?(W.log("[getReferenceIdFromFormula] Invalid reference ID",{refId:i}),null):parseInt(i);e--}}else W.log("[getReferenceIdFromFormula] No formula piece provided for id extraction.");return null})(e),l=c(t,i));let u,g,a=e.replace(/(?:([a-zA-Z]+)\.([\d]+)!(?:([a-zA-Z]+)([\d]+)?)(?:\.(\w+))?(?:\.(\w+))?)|(?:(Actions|Char|Connections|Controls|Fields|FillGradientStops|Geometry(?=[\d]+)?|HyperLink|Layers|LineGradientStops|Para|Prop|Reviewer|Scratch|SmartTags|Tabs|User)(\d+)?(?:\.(\w+))?(?:\.(\w+))?)/gm,function(){let i=0<=(u=parseInt(arguments[2]))?arguments[3]:arguments[7],r=0<=u?arguments[4]:arguments[8],l=0<=u?arguments[5]:arguments[9],a=0<=u?arguments[6]:arguments[10];if(isNaN(u))return arguments[0];if(!(g=c(t,u)))return arguments[0];let s;if($e[i]){var n=$e[i],o=g.sections.get(n.alias);if(!o)return arguments[0];let e,t;var h=Z[n.alias];if(t=h===p.Named?(e=o[0].rows.find(e=>e.name===l),a||n.default):(n=(h=l.match(/\d+/g))?parseInt(h[0])-1:0,e=o[0<=r?r-1:0].rows[n],l.match(/[a-zA-Z]+/)[0]),!e)return arguments[0];t=fe(t),s=(s=e.cells.get(t))||e.cells.getParentCell(t)}else{let e=fe(i);s=(s=g.cells.get(e))||g.cells.getParentCell(e)}return s?s.value:arguments[0]});var s;return l&&(i=a.replace(/[()]/gm,"").split(",").map(e=>new We({},t).parse(e).result),[e,s]=i,2<i.length&&W.log("Potentially invalid PNT arguments",{formula:n,pntArguments:i}),i=je({x:e,y:s},l),a=i.x+","+i.y),a})(h,e,i),a.push(o),l++)}return a=a.join("");function c(e,t){t||0===t||W.log("no reference id provided",{shape:e,refId:t});var i=e.masterShape?e.masterShape.master:null,r=e.pageContent.shapes.values();let l=r.next(),a;for(;!l.done&&i;){if(l.value.masterId===i.id&&l.value.shapes.has(e.id)){a=l.value;break}l=r.next()}return a}}let Qe={false:"0",true:"1"};class Ze extends Ce{constructor(){super(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},new Set([v.shape,v.masterShape]))}setAttributes(e){this._attributesSet=new Set,Object.keys(e).filter(e=>!["archive","structurePath"].includes(e)).forEach(e=>this.attributeSet(e)),super.setAttributes(e)}attributeSet(e){this._attributesSet.add(e)}attributeUnset(e){this._attributesSet.delete(e)}get attributesSet(){return this._attributesSet}has(e){return this.attributesSet.has(e)}hasEvery(e){return e.every(e=>void 0!==this[e])}getRowType(){var e;return this._rowType||((e=this.structurePath.find(e=>e.xsdType===Q.Row_Type))?e.type:null)}setRowType(e){this._rowType=e}isDescendantOfSectionType(t){return this.structurePath.some(e=>e.xsdType===Q.Section_Type&&t.includes(e.type))}getDefaultCellValue(e){switch(e){case r.vFormatString:case r.vLanguageString:case r.PtgString:return"";case r.PtgColorRGB:case r.vColor:return"#000000";case r.vFont:return"0";case r.vLength:case r.vAny:case r.vAngle:case r.PtgByte:case r.PtgInt:case r.PtgNum:case r.PtgNumI:case r.PtgShort:case r.PtgUnsShort:case r.PtgDate:case r.PtgBool:case r.vScalar:return 0}W.log(`No default Cell value for ${e} type.`)}resolveCellValue(i,r){if(i){let{value:e,formula:t}=i;var l,a,s=be(r,i);if("Themed"===(e=t&&xe.evaluateFormulas?((e,t)=>{if(!t)return e.value;var i=He(e,t);if(!i||!t)return e.value;if(i=Ke(i,t),(t=new We(e,t).parse(i)).error)return e.value;{let e=t.result.toString();return e=Qe[e.toLowerCase()]?Qe[e.toLowerCase()]:e}})(i,this.shape):e)){var n=function(e,t){return"lineColor"===(e=e.name)?we(S.Dark):"linePattern"===e?1:"lineColorTrans"!==e&&("fillForegnd"===e?we(S.Light):"fillPattern"===e?1:"fillForegndTrans"===e||"style"===e?0:"lineWeight"===e?1:"font"!==e&&"asianFont"!==e&&"complexScriptFont"!==e?"color"===e?we(S.Dark):"fillBkgnd"===e?we(S.Light):"fillBkgndTrans"!==e&&void 0:void 0)}.call(this,i,r);if(null!==n)return n}switch(s){case u.number:case u.byte:e=m(e);break;case u.percentage:e=100*m(e);break;case u.booleanStrict:e=re(e);break;case u.booleanTriState:e=ie(e);break;case u.internalUnitsToPixels:e=0===m(e)?0:(l=e,a=h.IN,le(m(l),a));break;case u.internalUnitsToDegrees:e=function(e,t){var{round:t=!0,decimalPlaces:i=2,units:r=h.RAD}=1<arguments.length&&void 0!==t?t:{};let l=Number(e);return r===h.RAD||r===h.DA?l=360-180*l/Math.PI:r===h.DEG||r===h.AD&&0===l||W.log(`Implement unit type "${oe(r)}" ("VisioUnitType.${r}")`),l%=360,l=t?F(l,i):l}(e,{units:h.RAD});break;case u.color:e.includes("#")||(e="Themed"===e?"red":(l=m(e),this.archive.document._colors.get(l)));break;case u.asIs:break;default:W.log("Unknown VisioConvertType",{cell:i,convertType:s,valueType:r})}return e}}themedResolver(){return null}getOwnNames(){return this.hasOwnProperty("_attributesSet")?[...this._attributesSet.values()]:[]}get(e){e=fe(e);return this.hasOwnProperty(e)?this[e]:this["_"+e]}set(e,i,r){if(!r)return null;let l=e.charAt(0).toLowerCase()+e.slice(1);e=e.charAt(0).toUpperCase()+e.slice(1);void 0===y[e]&&W.log(`Cell named "${e}" is not supported.`),"object"==typeof i&&null!==i||W.log("Attributes are required to set a cell."),this.attributeSet(l),i={...i,name:e};let a={...this["_"+l]};if(Object.keys(i).forEach(e=>{void 0!==i[e]&&(null===i[e]?delete a[e]:a[e]=i[e].toString())}),this["_"+l]=a,r&&"string"==typeof e){e=r.Cell,r=e.findIndex(e=>e.hasOwnProperty(s.Name)&&e[s.Name].toLowerCase()===l.toLowerCase());let t={};-1<r&&(t=e[r]),Object.keys(a).forEach(e=>{A[e]&&void 0!==i[e]&&(null===i[e]?delete t[A[e]]:t[A[e]]=a[e])}),-1<r?e[r]=t:e.push(t)}return a}remove(t,e){var i;this.attributeUnset(t),delete this["_"+t],e&&Array.isArray(e.Cell)&&-1<(i=(e=e.Cell).findIndex(e=>e.hasOwnProperty(s.Name)&&e[s.Name].toLowerCase()===t.toLowerCase()))&&e.splice(i,1)}get shape(){return this._shape}get jxon(){return this._jxon}set jxon(e){this._jxon=e}set shape(e){this._shape=e}get masterShape(){return this._masterShape}set masterShape(e){this._masterShape=e}resolveCellValueByType(e,t){return e.value}getParentCell(e){var t=this.parent;if(t&&t.cells)return t.cells.get(e)}getStylesheetFillStyleCell(e){return this.getStylesheetCell(e,v.fillStyle)}getStylesheetLineStyleCell(e){return this.getStylesheetCell(e,v.lineStyle)}getStylesheetTextStyleCell(e){return this.getStylesheetCell(e,v.textStyle)}getStylesheetCell(t,i){var r=this.shape,l=this.masterShape;if(r||l){let e;if(r?void 0===(e=r[i])&&(r=this.shape.masterShape)&&(e=r[i]):e=l[i],void 0!==e)return function e(t,i,r,l){var a,i=t.get(i);return i?(a=i.cells,a.has(l)?a.get(l):r in i?e(t,i[r],r,l):null):null}(this.archive.document.styleSheets,e,i,t);W.log("styleSheetIndex undefined")}}getSetValues(){let t={};return this.attributesSet.forEach(e=>t[e]=this[e]),t}getSetValuesMaster(){var e=this.shape.masterShape;if(!e)return null;let t=(e=>{let t=!1,i={};return e.forEach(e=>{e.jxonType===g.Shape?t=!0:t&&(e.jxonType===g.Section&&(i.section=e),e.jxonType===g.Row)&&(i.row=e)}),i})(this.structurePath);return t.section&&t.row&&(e=e.sections.get(t.section.type)[t.section.index].rows.find(e=>e.index===t.row.index))&&(e=e.cells)?e===this?"exactly same":e.getSetValues():null}get directValues(){return this.debugGatherValues([...this.attributesSet])}clone(){var e=this.structurePath.slice();e.unshift({jxonType:"clone"});let i=new this.constructor({archive:this.archive,structurePath:e});return this.attributesSet.forEach(e=>{var t=this.get(e);i[e]={...t},i.attributeSet(e)}),this.shape&&(i.shape=this.shape),this.masterShape&&(i.masterShape=this.masterShape),i}get debug(){var e={owner:this.owner,parent:this.parent,directValues:this.debugGatherValues([...this.attributesSet])};return this.shape&&(e.ownerShape=this.shape),this.parent&&(e.extendedValues=this.debugGatherValues([...this.attributesSet,...this.parent.cells.attributesSet])),this.masterShape&&(e.ownerMasterShape=this.masterShape),e.stylesheetFill=this.debugGatherValues(["fillForegnd","fillBkgnd","fillPattern","fillForegndTrans","fillBkgndTrans"]),e.stylesheetLine=this.debugGatherValues(["lineColor","lineColorTrans","linePattern","lineWeight"]),e.stylesheetText=this.debugGatherValues(["bottomMargin","defaultTabStop","leftMargin","rightMargin","textBkgnd","textBkgndTrans","topMargin","verticalAlign"]),e.structurePath=this.structurePath,e}debugGatherValues(e){return e.reduce((e,t)=>(e[t]=this[t],e),{})}}class et extends Ze{set a(e){this.attributeSet("a"),this._a=e}get a(){let e;switch(this.getRowType()){case D.ArcTo:case D.Ellipse:case D.EllipticalArcTo:case D.InfiniteLine:e=r.vLength;break;case D.NURBSTo:case D.RelCubBezTo:case D.RelEllipticalArcTo:case D.RelQuadBezTo:case D.SplineStart:case D.SplineKnot:e=r.vScalar;break;case D.PolylineTo:e=r.vAny;break;default:W.log("Incorrect cell type",{attributeName:"a",cells:this})}let t=this._a;return void 0===t&&(t=this.getParentCell("a")),this.resolveCellValue(t,e)}set action(e){this.attributeSet("action"),this._action=e}get action(){var e=r.vScalar;let t=this._action;return void 0===t&&(t=this.getParentCell("action")),this.resolveCellValue(t,e)}set active(e){this.attributeSet("active"),this._active=e}get active(){var e=r.PtgBool;let t=this._active;return void 0===t&&(t=this.getParentCell("active")),this.resolveCellValue(t,e)}set addMarkup(e){this.attributeSet("addMarkup"),this._addMarkup=e}get addMarkup(){var e=r.PtgBool;let t=this._addMarkup;return void 0===t&&(t=this.getParentCell("addMarkup")),this.resolveCellValue(t,e)}set address(e){this.attributeSet("address"),this._address=e}get address(){var e=r.PtgString;let t=this._address;return void 0===t&&(t=this.getParentCell("address")),this.resolveCellValue(t,e)}set alignBottom(e){this.attributeSet("alignBottom"),this._alignBottom=e}get alignBottom(){var e=r.vScalar;let t=this._alignBottom;return void 0===t&&(t=this.getParentCell("alignBottom")),this.resolveCellValue(t,e)}set alignCenter(e){this.attributeSet("alignCenter"),this._alignCenter=e}get alignCenter(){var e=r.vScalar;let t=this._alignCenter;return void 0===t&&(t=this.getParentCell("alignCenter")),this.resolveCellValue(t,e)}set alignLeft(e){this.attributeSet("alignLeft"),this._alignLeft=e}get alignLeft(){var e=r.vScalar;let t=this._alignLeft;return void 0===t&&(t=this.getParentCell("alignLeft")),this.resolveCellValue(t,e)}set alignment(e){this.attributeSet("alignment"),this._alignment=e}get alignment(){var e=r.vScalar;let t=this._alignment;return void 0===t&&(t=this.getParentCell("alignment")),this.resolveCellValue(t,e)}set alignMiddle(e){this.attributeSet("alignMiddle"),this._alignMiddle=e}get alignMiddle(){var e=r.vScalar;let t=this._alignMiddle;return void 0===t&&(t=this.getParentCell("alignMiddle")),this.resolveCellValue(t,e)}set alignRight(e){this.attributeSet("alignRight"),this._alignRight=e}get alignRight(){var e=r.vScalar;let t=this._alignRight;return void 0===t&&(t=this.getParentCell("alignRight")),this.resolveCellValue(t,e)}set alignTop(e){this.attributeSet("alignTop"),this._alignTop=e}get alignTop(){var e=r.vScalar;let t=this._alignTop;return void 0===t&&(t=this.getParentCell("alignTop")),this.resolveCellValue(t,e)}set angle(e){this.attributeSet("angle"),this._angle=e}get angle(){let e=this._angle;void 0===e&&(e=this.getParentCell("angle"));var t=r.vAngle;return e&&e.units&&e.units!==h.DEG&&"0"!==e.value&&W.log("vAngle unclear"),void 0===e?this.getDefaultCellValue(t):this.resolveCellValue(e,t)}set asianFont(e){this.attributeSet("asianFont"),this._asianFont=e}get asianFont(){var e=r.vFont;let t=this._asianFont;return void 0===t&&(t=this.getParentCell("asianFont")),this.resolveCellValue(t,e)}set autoGen(e){this.attributeSet("autoGen"),this._autoGen=e}get autoGen(){var e=r.PtgBool;let t=this._autoGen;return void 0===t&&(t=this.getParentCell("autoGen")),this.resolveCellValue(t,e)}set avenueSizeX(e){this.attributeSet("avenueSizeX"),this._avenueSizeX=e}get avenueSizeX(){var e=r.vScalar;let t=this._avenueSizeX;return void 0===t&&(t=this.getParentCell("avenueSizeX")),this.resolveCellValue(t,e)}set avenueSizeY(e){this.attributeSet("avenueSizeY"),this._avenueSizeY=e}get avenueSizeY(){var e=r.vScalar;let t=this._avenueSizeY;return void 0===t&&(t=this.getParentCell("avenueSizeY")),this.resolveCellValue(t,e)}set avoidPageBreaks(e){this.attributeSet("avoidPageBreaks"),this._avoidPageBreaks=e}get avoidPageBreaks(){var e=r.PtgBool;let t=this._avoidPageBreaks;return void 0===t&&(t=this.getParentCell("avoidPageBreaks")),this.resolveCellValue(t,e)}set b(e){this.attributeSet("b"),this._b=e}get b(){let e;if(this.isDescendantOfSectionType([Y.Scratch]))e=r.vAny;else switch(this.getRowType()){case D.Ellipse:case D.EllipticalArcTo:case D.InfiniteLine:e=r.vLength;break;case D.NURBSTo:case D.RelCubBezTo:case D.RelEllipticalArcTo:case D.RelQuadBezTo:case D.SplineStart:e=r.vScalar;break;default:W.log("Incorrect cell type",{attributeName:"a",cells:this})}let t=this._b;return void 0===t&&(t=this.getParentCell("b")),this.resolveCellValue(t,e)}set beginArrow(e){this.attributeSet("beginArrow"),this._beginArrow=e}get beginArrow(){var e=r.PtgByte;let t=this._beginArrow;return void 0===t&&(t=this.getParentCell("beginArrow")),this.resolveCellValue(t,e)}set beginArrowSize(e){this.attributeSet("beginArrowSize"),this._beginArrowSize=e}get beginArrowSize(){var e=r.PtgByte;let t=this._beginArrowSize;return void 0===(t=void 0===t?this.getParentCell("beginArrowSize"):t)?2:this.resolveCellValue(t,e)}set beginGroup(e){this.attributeSet("beginGroup"),this._beginGroup=e}get beginGroup(){var e=r.PtgBool;let t=this._beginGroup;return void 0===t&&(t=this.getParentCell("beginGroup")),this.resolveCellValue(t,e)}set beginX(e){this.attributeSet("beginX"),this._beginX=e}get beginX(){var e=r.vLength;let t=this._beginX;return void 0===t&&(t=this.getParentCell("beginX")),this.resolveCellValue(t,e)}set beginY(e){this.attributeSet("beginY"),this._beginY=e}get beginY(){var e=r.vLength;let t=this._beginY;return void 0===t&&(t=this.getParentCell("beginY")),this.resolveCellValue(t,e)}set begTrigger(e){this.attributeSet("begTrigger"),this._begTrigger=e}get begTrigger(){var e=r.PtgByte;let t=this._begTrigger;return void 0===t&&(t=this.getParentCell("begTrigger")),this.resolveCellValue(t,e)}set bevelBottomHeight(e){this.attributeSet("bevelBottomHeight"),this._bevelBottomHeight=e}get bevelBottomHeight(){var e=r.vLength;let t=this._bevelBottomHeight;return void 0===t&&(t=this.getParentCell("bevelBottomHeight")),this.resolveCellValue(t,e)}set bevelBottomType(e){this.attributeSet("bevelBottomType"),this._bevelBottomType=e}get bevelBottomType(){var e=r.PtgByte;let t=this._bevelBottomType;return void 0===t&&(t=this.getParentCell("bevelBottomType")),this.resolveCellValue(t,e)}set bevelBottomWidth(e){this.attributeSet("bevelBottomWidth"),this._bevelBottomWidth=e}get bevelBottomWidth(){var e=r.vLength;let t=this._bevelBottomWidth;return void 0===t&&(t=this.getParentCell("bevelBottomWidth")),this.resolveCellValue(t,e)}set bevelContourColor(e){this.attributeSet("bevelContourColor"),this._bevelContourColor=e}get bevelContourColor(){var e=r.PtgColorRGB;let t=this._bevelContourColor;return void 0===t&&(t=this.getParentCell("bevelContourColor")),this.resolveCellValue(t,e)}set bevelContourSize(e){this.attributeSet("bevelContourSize"),this._bevelContourSize=e}get bevelContourSize(){var e=r.vLength;let t=this._bevelContourSize;return void 0===t&&(t=this.getParentCell("bevelContourSize")),this.resolveCellValue(t,e)}set bevelDepthColor(e){this.attributeSet("bevelDepthColor"),this._bevelDepthColor=e}get bevelDepthColor(){var e=r.PtgColorRGB;let t=this._bevelDepthColor;return void 0===t&&(t=this.getParentCell("bevelDepthColor")),this.resolveCellValue(t,e)}set bevelDepthSize(e){this.attributeSet("bevelDepthSize"),this._bevelDepthSize=e}get bevelDepthSize(){var e=r.vLength;let t=this._bevelDepthSize;return void 0===t&&(t=this.getParentCell("bevelDepthSize")),this.resolveCellValue(t,e)}set bevelLightingAngle(e){this.attributeSet("bevelLightingAngle"),this._bevelLightingAngle=e}get bevelLightingAngle(){var e=r.vScalar;let t=this._bevelLightingAngle;return void 0===t&&(t=this.getParentCell("bevelLightingAngle")),this.resolveCellValue(t,e)}set bevelLightingType(e){this.attributeSet("bevelLightingType"),this._bevelLightingType=e}get bevelLightingType(){var e=r.PtgByte;let t=this._bevelLightingType;return void 0===t&&(t=this.getParentCell("bevelLightingType")),this.resolveCellValue(t,e)}set bevelMaterialType(e){this.attributeSet("bevelMaterialType"),this._bevelMaterialType=e}get bevelMaterialType(){var e=r.PtgByte;let t=this._bevelMaterialType;return void 0===t&&(t=this.getParentCell("bevelMaterialType")),this.resolveCellValue(t,e)}set bevelTopHeight(e){this.attributeSet("bevelTopHeight"),this._bevelTopHeight=e}get bevelTopHeight(){var e=r.vLength;let t=this._bevelTopHeight;return void 0===t&&(t=this.getParentCell("bevelTopHeight")),this.resolveCellValue(t,e)}set bevelTopType(e){this.attributeSet("bevelTopType"),this._bevelTopType=e}get bevelTopType(){var e=r.PtgByte;let t=this._bevelTopType;return void 0===t&&(t=this.getParentCell("bevelTopType")),this.resolveCellValue(t,e)}set bevelTopWidth(e){this.attributeSet("bevelTopWidth"),this._bevelTopWidth=e}get bevelTopWidth(){var e=r.vLength;let t=this._bevelTopWidth;return void 0===t&&(t=this.getParentCell("bevelTopWidth")),this.resolveCellValue(t,e)}set blockSizeX(e){this.attributeSet("blockSizeX"),this._blockSizeX=e}get blockSizeX(){var e=r.vScalar;let t=this._blockSizeX;return void 0===t&&(t=this.getParentCell("blockSizeX")),this.resolveCellValue(t,e)}set blockSizeY(e){this.attributeSet("blockSizeY"),this._blockSizeY=e}get blockSizeY(){var e=r.vScalar;let t=this._blockSizeY;return void 0===t&&(t=this.getParentCell("blockSizeY")),this.resolveCellValue(t,e)}set blur(e){this.attributeSet("blur"),this._blur=e}get blur(){var e=r.vScalar;let t=this._blur;return void 0===t&&(t=this.getParentCell("blur")),this.resolveCellValue(t,e)}set bottomMargin(e){this.attributeSet("bottomMargin"),this._bottomMargin=e}get bottomMargin(){var e=r.vLength;let t=this._bottomMargin;return void 0===(t=void 0===t?this.getParentCell("bottomMargin"):t)&&(t=this.getStylesheetTextStyleCell("bottomMargin")),this.resolveCellValue(t,e)}set brightness(e){this.attributeSet("brightness"),this._brightness=e}get brightness(){var e=r.vScalar;let t=this._brightness;return void 0===t&&(t=this.getParentCell("brightness")),this.resolveCellValue(t,e)}set bullet(e){this.attributeSet("bullet"),this._bullet=e}get bullet(){var e=r.PtgByte;let t=this._bullet;return void 0===t&&(t=this.getParentCell("bullet")),this.resolveCellValue(t,e)}set bulletFont(e){this.attributeSet("bulletFont"),this._bulletFont=e}get bulletFont(){var e=r.vFont;let t=this._bulletFont;return void 0===t&&(t=this.getParentCell("bulletFont")),this.resolveCellValue(t,e)}set bulletFontSize(e){this.attributeSet("bulletFontSize"),this._bulletFontSize=e}get bulletFontSize(){var e=r.vLength;let t=this._bulletFontSize;return void 0===t&&(t=this.getParentCell("bulletFontSize")),this.resolveCellValue(t,e)}set bulletStr(e){this.attributeSet("bulletStr"),this._bulletStr=e}get bulletStr(){var e=r.PtgString;let t=this._bulletStr;return void 0===t&&(t=this.getParentCell("bulletStr")),this.resolveCellValue(t,e)}set buttonFace(e){this.attributeSet("buttonFace"),this._buttonFace=e}get buttonFace(){var e=r.PtgString;let t=this._buttonFace;return void 0===t&&(t=this.getParentCell("buttonFace")),this.resolveCellValue(t,e)}set c(e){this.attributeSet("c"),this._c=e}get c(){let e;if(this.isDescendantOfSectionType([Y.Scratch]))e=r.vAny;else switch(this.getRowType()){case D.Ellipse:e=r.vLength;break;case D.EllipticalArcTo:case D.RelEllipticalArcTo:e=r.vAngle;break;case D.NURBSTo:case D.RelCubBezTo:case D.SplineStart:e=r.vScalar;break;default:W.log("Incorrect cell type",{attributeName:"c",cells:this})}let t=this._c;return void 0===t&&(t=this.getParentCell("c")),this.resolveCellValue(t,e)}set calendar(e){this.attributeSet("calendar"),this._calendar=e}get calendar(){var e=r.vScalar;let t=this._calendar;return void 0===t&&(t=this.getParentCell("calendar")),this.resolveCellValue(t,e)}set canGlue(e){this.attributeSet("canGlue"),this._canGlue=e}get canGlue(){var e=r.PtgBool;let t=this._canGlue;return void 0===t&&(t=this.getParentCell("canGlue")),this.resolveCellValue(t,e)}set uppercase(e){this.attributeSet("uppercase"),this._uppercase=e}get uppercase(){var e=r.PtgByte;let t=this._uppercase;return void 0===t&&(t=this.getParentCell("uppercase")),this.resolveCellValue(t,e)}set centerX(e){this.attributeSet("centerX"),this._centerX=e}get centerX(){var e=r.PtgBool;let t=this._centerX;return void 0===t&&(t=this.getParentCell("centerX")),this.resolveCellValue(t,e)}set centerY(e){this.attributeSet("centerY"),this._centerY=e}get centerY(){var e=r.PtgBool;let t=this._centerY;return void 0===t&&(t=this.getParentCell("centerY")),this.resolveCellValue(t,e)}set checked(e){this.attributeSet("checked"),this._checked=e}get checked(){var e=r.PtgBool;let t=this._checked;return void 0===t&&(t=this.getParentCell("checked")),this.resolveCellValue(t,e)}set clippingPath(e){this.attributeSet("clippingPath"),this._clippingPath=e}get clippingPath(){var e=r.PtgString;let t=this._clippingPath;return void 0===t&&(t=this.getParentCell("clippingPath")),this.resolveCellValue(t,e)}set color(e){this.attributeSet("color"),this._color=e}get color(){var e=r.PtgColorRGB;let t=this._color;return void 0===t&&(t=this.getParentCell("color")),this.resolveCellValue(t,e)}set colorSchemeIndex(e){this.attributeSet("colorSchemeIndex"),this._colorSchemeIndex=e}get colorSchemeIndex(){var e=r.PtgByte;let t=this._colorSchemeIndex;return void 0===t&&(t=this.getParentCell("colorSchemeIndex")),this.resolveCellValue(t,e)}set colorTrans(e){this.attributeSet("colorTrans"),this._colorTrans=e}get colorTrans(){var e=r.vScalar;let t=this._colorTrans;return void 0===t&&(t=this.getParentCell("colorTrans")),this.resolveCellValue(t,e)}set comment(e){this.attributeSet("comment"),this._comment=e}get comment(){var e=r.PtgString;let t=this._comment;return void 0===t&&(t=this.getParentCell("comment")),this.resolveCellValue(t,e)}set complexScriptFont(e){this.attributeSet("complexScriptFont"),this._complexScriptFont=e}get complexScriptFont(){var e=r.vFont;let t=this._complexScriptFont;return void 0===t&&(t=this.getParentCell("complexScriptFont")),this.resolveCellValue(t,e)}set complexScriptSize(e){this.attributeSet("complexScriptSize"),this._complexScriptSize=e}get complexScriptSize(){var e,t=r.vLength;let i=this._complexScriptSize;if(void 0!==(i=void 0===i?this.getParentCell("complexScriptSize"):i))return 0===(e=m(i.value))?this.size:e<0?-e*this.size:this.resolveCellValue(i,t)}set compoundType(e){this.attributeSet("compoundType"),this._compoundType=e}get compoundType(){var e=r.PtgByte;let t=this._compoundType;return void 0===t&&(t=this.getParentCell("compoundType")),this.resolveCellValue(t,e)}set conFixedCode(e){this.attributeSet("conFixedCode"),this._conFixedCode=e}get conFixedCode(){var e=r.PtgByte;let t=this._conFixedCode;return void 0===t&&(t=this.getParentCell("conFixedCode")),this.resolveCellValue(t,e)}set conLineJumpCode(e){this.attributeSet("conLineJumpCode"),this._conLineJumpCode=e}get conLineJumpCode(){var e=r.PtgByte;let t=this._conLineJumpCode;return void 0===t&&(t=this.getParentCell("conLineJumpCode")),this.resolveCellValue(t,e)}set conLineJumpDirX(e){this.attributeSet("conLineJumpDirX"),this._conLineJumpDirX=e}get conLineJumpDirX(){var e=r.PtgByte;let t=this._conLineJumpDirX;return void 0===t&&(t=this.getParentCell("conLineJumpDirX")),this.resolveCellValue(t,e)}set conLineJumpDirY(e){this.attributeSet("conLineJumpDirY"),this._conLineJumpDirY=e}get conLineJumpDirY(){var e=r.PtgByte;let t=this._conLineJumpDirY;return void 0===t&&(t=this.getParentCell("conLineJumpDirY")),this.resolveCellValue(t,e)}set conLineJumpStyle(e){this.attributeSet("conLineJumpStyle"),this._conLineJumpStyle=e}get conLineJumpStyle(){var e=r.PtgByte;let t=this._conLineJumpStyle;return void 0===t&&(t=this.getParentCell("conLineJumpStyle")),this.resolveCellValue(t,e)}set conLineRouteExt(e){this.attributeSet("conLineRouteExt"),this._conLineRouteExt=e}get conLineRouteExt(){var e=r.PtgByte;let t=this._conLineRouteExt;return void 0===t&&(t=this.getParentCell("conLineRouteExt")),this.resolveCellValue(t,e)}set connectorSchemeIndex(e){this.attributeSet("connectorSchemeIndex"),this._connectorSchemeIndex=e}get connectorSchemeIndex(){var e=r.PtgByte;let t=this._connectorSchemeIndex;return void 0===t&&(t=this.getParentCell("connectorSchemeIndex")),this.resolveCellValue(t,e)}set contrast(e){this.attributeSet("contrast"),this._contrast=e}get contrast(){var e=r.vScalar;let t=this._contrast;return void 0===t&&(t=this.getParentCell("contrast")),this.resolveCellValue(t,e)}set copyright(e){this.attributeSet("copyright"),this._copyright=e}get copyright(){var e=r.PtgString;let t=this._copyright;return void 0===t&&(t=this.getParentCell("copyright")),this.resolveCellValue(t,e)}set ctrlAsInput(e){this.attributeSet("ctrlAsInput"),this._ctrlAsInput=e}get ctrlAsInput(){var e=r.PtgBool;let t=this._ctrlAsInput;return void 0===t&&(t=this.getParentCell("ctrlAsInput")),this.resolveCellValue(t,e)}set currentIndex(e){this.attributeSet("currentIndex"),this._currentIndex=e}get currentIndex(){var e=r.PtgShort;let t=this._currentIndex;return void 0===t&&(t=this.getParentCell("currentIndex")),this.resolveCellValue(t,e)}set d(e){this.attributeSet("d"),this._d=e}get d(){let e;if(this.isDescendantOfSectionType([Y.Scratch]))e=r.vAny;else switch(this.getRowType()){case D.Ellipse:e=r.vLength;break;case D.EllipticalArcTo:case D.RelCubBezTo:case D.RelEllipticalArcTo:case D.NURBSTo:case D.SplineStart:e=r.vScalar;break;default:W.log("Incorrect cell type",{attributeName:"d",cells:this})}let t=this._d;return void 0===t&&(t=this.getParentCell("d")),this.resolveCellValue(t,e)}set dataLinked(e){this.attributeSet("dataLinked"),this._dataLinked=e}get dataLinked(){var e=r.PtgBool;let t=this._dataLinked;return void 0===t&&(t=this.getParentCell("dataLinked")),this.resolveCellValue(t,e)}set dblUnderline(e){this.attributeSet("dblUnderline"),this._dblUnderline=e}get dblUnderline(){var e=r.PtgBool;let t=this._dblUnderline;return void 0===t&&(t=this.getParentCell("dblUnderline")),this.resolveCellValue(t,e)}set __default(e){this.attributeSet("__default"),this.___default=e}get __default(){var e=r.PtgBool;let t=this.___default;return void 0===t&&(t=this.getParentCell("__default")),this.resolveCellValue(t,e)}set defaultTabStop(e){this.attributeSet("defaultTabStop"),this._defaultTabStop=e}get defaultTabStop(){var e=r.vLength;let t=this._defaultTabStop;return void 0===(t=void 0===t?this.getParentCell("defaultTabStop"):t)&&(t=this.getStylesheetTextStyleCell("defaultTabStop")),this.resolveCellValue(t,e)}set denoise(e){this.attributeSet("denoise"),this._denoise=e}get denoise(){var e=r.vScalar;let t=this._denoise;return void 0===t&&(t=this.getParentCell("denoise")),this.resolveCellValue(t,e)}set description(e){this.attributeSet("description"),this._description=e}get description(){var e=r.PtgString;let t=this._description;return void 0===t&&(t=this.getParentCell("description")),this.resolveCellValue(t,e)}set dirX(e){this.attributeSet("dirX"),this._dirX=e}get dirX(){var e=r.vLength;let t=this._dirX;return void 0===t&&(t=this.getParentCell("dirX")),this.resolveCellValue(t,e)}set dirY(e){this.attributeSet("dirY"),this._dirY=e}get dirY(){var e=r.vLength;let t=this._dirY;return void 0===t&&(t=this.getParentCell("dirY")),this.resolveCellValue(t,e)}set disabled(e){this.attributeSet("disabled"),this._disabled=e}get disabled(){var e=r.PtgBool;let t=this._disabled;return void 0===t&&(t=this.getParentCell("disabled")),this.resolveCellValue(t,e)}set displayLevel(e){this.attributeSet("displayLevel"),this._displayLevel=e}get displayLevel(){var e=r.PtgInt;let t=this._displayLevel;return void 0===t&&(t=this.getParentCell("displayLevel")),this.resolveCellValue(t,e)}set displayMode(e){this.attributeSet("displayMode"),this._displayMode=e}get displayMode(){var e=r.PtgByte;let t=this._displayMode;return void 0===t&&(t=this.getParentCell("displayMode")),this.resolveCellValue(t,e)}set distanceFromGround(e){this.attributeSet("distanceFromGround"),this._distanceFromGround=e}get distanceFromGround(){var e=r.vLength;let t=this._distanceFromGround;return void 0===t&&(t=this.getParentCell("distanceFromGround")),this.resolveCellValue(t,e)}set docLangID(e){this.attributeSet("docLangID"),this._docLangID=e}get docLangID(){var e=r.vLanguageString;let t=this._docLangID;return void 0===t&&(t=this.getParentCell("docLangID")),this.resolveCellValue(t,e)}set docLockDuplicatePage(e){this.attributeSet("docLockDuplicatePage"),this._docLockDuplicatePage=e}get docLockDuplicatePage(){var e=r.PtgBool;let t=this._docLockDuplicatePage;return void 0===t&&(t=this.getParentCell("docLockDuplicatePage")),this.resolveCellValue(t,e)}set docLockReplace(e){this.attributeSet("docLockReplace"),this._docLockReplace=e}get docLockReplace(){var e=r.PtgBool;let t=this._docLockReplace;return void 0===t&&(t=this.getParentCell("docLockReplace")),this.resolveCellValue(t,e)}set dontMoveChildren(e){this.attributeSet("dontMoveChildren"),this._dontMoveChildren=e}get dontMoveChildren(){var e=r.PtgBool;let t=this._dontMoveChildren;return void 0===t&&(t=this.getParentCell("dontMoveChildren")),this.resolveCellValue(t,e)}set doubleStrikethrough(e){this.attributeSet("doubleStrikethrough"),this._doubleStrikethrough=e}get doubleStrikethrough(){var e=r.PtgBool;let t=this._doubleStrikethrough;return void 0===t&&(t=this.getParentCell("doubleStrikethrough")),this.resolveCellValue(t,e)}set drawingResizeType(e){this.attributeSet("drawingResizeType"),this._drawingResizeType=e}get drawingResizeType(){var e=r.PtgByte;let t=this._drawingResizeType;return void 0===t&&(t=this.getParentCell("drawingResizeType")),this.resolveCellValue(t,e)}set drawingScale(e){this.attributeSet("drawingScale"),this._drawingScale=e}get drawingScale(){var e=r.vLength;let t=this._drawingScale;return void 0===t&&(t=this.getParentCell("drawingScale")),this.resolveCellValue(t,e)}set drawingScaleType(e){this.attributeSet("drawingScaleType"),this._drawingScaleType=e}get drawingScaleType(){var e=r.PtgByte;let t=this._drawingScaleType;return void 0===t&&(t=this.getParentCell("drawingScaleType")),this.resolveCellValue(t,e)}set drawingSizeType(e){this.attributeSet("drawingSizeType"),this._drawingSizeType=e}get drawingSizeType(){var e=r.PtgByte;let t=this._drawingSizeType;return void 0===t&&(t=this.getParentCell("drawingSizeType")),this.resolveCellValue(t,e)}set dropOnPageScale(e){this.attributeSet("dropOnPageScale"),this._dropOnPageScale=e}get dropOnPageScale(){var e=r.vScalar;let t=this._dropOnPageScale;return void 0===t&&(t=this.getParentCell("dropOnPageScale")),this.resolveCellValue(t,e)}set dynamicsOff(e){this.attributeSet("dynamicsOff"),this._dynamicsOff=e}get dynamicsOff(){var e=r.PtgBool;let t=this._dynamicsOff;return void 0===t&&(t=this.getParentCell("dynamicsOff")),this.resolveCellValue(t,e)}set dynFeedback(e){this.attributeSet("dynFeedback"),this._dynFeedback=e}get dynFeedback(){var e=r.PtgByte;let t=this._dynFeedback;return void 0===t&&(t=this.getParentCell("dynFeedback")),this.resolveCellValue(t,e)}set e(e){this.attributeSet("e"),this._e=e}get e(){var e=r.formulaExpression;let t=this._e;return void 0===t&&(t=this.getParentCell("e")),this.resolveCellValue(t,e)}set effectSchemeIndex(e){this.attributeSet("effectSchemeIndex"),this._effectSchemeIndex=e}get effectSchemeIndex(){var e=r.PtgByte;let t=this._effectSchemeIndex;return void 0===t&&(t=this.getParentCell("effectSchemeIndex")),this.resolveCellValue(t,e)}set embellishmentIndex(e){this.attributeSet("embellishmentIndex"),this._embellishmentIndex=e}get embellishmentIndex(){var e=r.PtgInt;let t=this._embellishmentIndex;return void 0===t&&(t=this.getParentCell("embellishmentIndex")),this.resolveCellValue(t,e)}set enableFillProps(e){this.attributeSet("enableFillProps"),this._enableFillProps=e}get enableFillProps(){var e=r.PtgBool;let t=this._enableFillProps;return void 0===t&&(t=this.getParentCell("enableFillProps")),this.resolveCellValue(t,e)}set enableGrid(e){this.attributeSet("enableGrid"),this._enableGrid=e}get enableGrid(){var e=r.PtgBool;let t=this._enableGrid;return void 0===t&&(t=this.getParentCell("enableGrid")),this.resolveCellValue(t,e)}set enableLineProps(e){this.attributeSet("enableLineProps"),this._enableLineProps=e}get enableLineProps(){var e=r.PtgBool;let t=this._enableLineProps;return void 0===t&&(t=this.getParentCell("enableLineProps")),this.resolveCellValue(t,e)}set enableTextProps(e){this.attributeSet("enableTextProps"),this._enableTextProps=e}get enableTextProps(){var e=r.PtgBool;let t=this._enableTextProps;return void 0===t&&(t=this.getParentCell("enableTextProps")),this.resolveCellValue(t,e)}set endArrow(e){this.attributeSet("endArrow"),this._endArrow=e}get endArrow(){var e=r.PtgByte;let t=this._endArrow;return void 0===t&&(t=this.getParentCell("endArrow")),this.resolveCellValue(t,e)}set endArrowSize(e){this.attributeSet("endArrowSize"),this._endArrowSize=e}get endArrowSize(){var e=r.PtgByte;let t=this._endArrowSize;return void 0===t&&(t=this.getParentCell("endArrowSize")),this.resolveCellValue(t,e)}set endTrigger(e){this.attributeSet("endTrigger"),this._endTrigger=e}get endTrigger(){var e=r.PtgByte;let t=this._endTrigger;return void 0===t&&(t=this.getParentCell("endTrigger")),this.resolveCellValue(t,e)}set endX(e){this.attributeSet("endX"),this._endX=e}get endX(){var e=r.vLength;let t=this._endX;return void 0===t&&(t=this.getParentCell("endX")),this.resolveCellValue(t,e)}set endY(e){this.attributeSet("endY"),this._endY=e}get endY(){var e=r.vLength;let t=this._endY;return void 0===t&&(t=this.getParentCell("endY")),this.resolveCellValue(t,e)}set eventDblClick(e){this.attributeSet("eventDblClick"),this._eventDblClick=e}get eventDblClick(){var e=r.vScalar;let t=this._eventDblClick;return void 0===t&&(t=this.getParentCell("eventDblClick")),this.resolveCellValue(t,e)}set eventDrop(e){this.attributeSet("eventDrop"),this._eventDrop=e}get eventDrop(){var e=r.vScalar;let t=this._eventDrop;return void 0===t&&(t=this.getParentCell("eventDrop")),this.resolveCellValue(t,e)}set eventMultiDrop(e){this.attributeSet("eventMultiDrop"),this._eventMultiDrop=e}get eventMultiDrop(){var e=r.vScalar;let t=this._eventMultiDrop;return void 0===t&&(t=this.getParentCell("eventMultiDrop")),this.resolveCellValue(t,e)}set eventXFMod(e){this.attributeSet("eventXFMod"),this._eventXFMod=e}get eventXFMod(){var e=r.vScalar;let t=this._eventXFMod;return void 0===t&&(t=this.getParentCell("eventXFMod")),this.resolveCellValue(t,e)}set extraInfo(e){this.attributeSet("extraInfo"),this._extraInfo=e}get extraInfo(){var e=r.PtgString;let t=this._extraInfo;return void 0===t&&(t=this.getParentCell("extraInfo")),this.resolveCellValue(t,e)}set fillBkgnd(e){this.attributeSet("fillBkgnd"),this._fillBkgnd=e}get fillBkgnd(){var e=r.vColor;let t=this._fillBkgnd;return void 0===(t=void 0===t?this.getParentCell("fillBkgnd"):t)&&(t=this.getStylesheetFillStyleCell("fillBkgnd")),this.resolveCellValue(t,e)}set fillBkgndTrans(e){this.attributeSet("fillBkgndTrans"),this._fillBkgndTrans=e}get fillBkgndTrans(){var e=r.vScalar;let t=this._fillBkgndTrans;return void 0===(t=void 0===t?this.getParentCell("fillBkgndTrans"):t)&&(t=this.getStylesheetFillStyleCell("fillBkgndTrans")),this.resolveCellValue(t,e)}set fillForegnd(e){this.attributeSet("fillForegnd"),this._fillForegnd=e}get fillForegnd(){var e=r.vColor;let t=this._fillForegnd;return void 0===(t=void 0===t?this.getParentCell("fillForegnd"):t)&&(t=this.getStylesheetFillStyleCell("fillForegnd")),this.resolveCellValue(t,e)}set fillForegndTrans(e){this.attributeSet("fillForegndTrans"),this._fillForegndTrans=e}get fillForegndTrans(){var e=r.vScalar;let t=this._fillForegndTrans;return void 0===(t=void 0===t?this.getParentCell("fillForegndTrans"):t)&&(t=this.getStylesheetFillStyleCell("fillForegndTrans")),this.resolveCellValue(t,e)}set fillGradientAngle(e){this.attributeSet("fillGradientAngle"),this._fillGradientAngle=e}get fillGradientAngle(){var e=r.vAngle;let t=this._fillGradientAngle;return void 0===t&&(t=this.getParentCell("fillGradientAngle")),this.resolveCellValue(t,e)}set fillGradientDir(e){this.attributeSet("fillGradientDir"),this._fillGradientDir=e}get fillGradientDir(){var e=r.PtgByte;let t=this._fillGradientDir;return void 0===t&&(t=this.getParentCell("fillGradientDir")),this.resolveCellValue(t,e)}set fillGradientEnabled(e){this.attributeSet("fillGradientEnabled"),this._fillGradientEnabled=e}get fillGradientEnabled(){var e=r.PtgBool;let t=this._fillGradientEnabled;return void 0===t&&(t=this.getParentCell("fillGradientEnabled")),this.resolveCellValue(t,e)}set fillPattern(e){this.attributeSet("fillPattern"),this._fillPattern=e}get fillPattern(){var e=r.PtgByte;let t=this._fillPattern;return void 0===(t=void 0===t?this.getParentCell("fillPattern"):t)&&(t=this.getStylesheetFillStyleCell("fillPattern")),this.resolveCellValue(t,e)}set flags(e){this.attributeSet("flags"),this._flags=e}get flags(){var e=r.PtgByte;let t=this._flags;return void 0===t&&(t=this.getParentCell("flags")),this.resolveCellValue(t,e)}set flipX(e){this.attributeSet("flipX"),this._flipX=e}get flipX(){var e=r.vScalar;let t=this._flipX;return void 0===t&&(t=this.getParentCell("flipX")),this.resolveCellValue(t,e)}set flipY(e){this.attributeSet("flipY"),this._flipY=e}get flipY(){var e=r.vScalar;let t=this._flipY;return void 0===t&&(t=this.getParentCell("flipY")),this.resolveCellValue(t,e)}set flyoutChild(e){this.attributeSet("flyoutChild"),this._flyoutChild=e}get flyoutChild(){var e=r.PtgBool;let t=this._flyoutChild;return void 0===t&&(t=this.getParentCell("flyoutChild")),this.resolveCellValue(t,e)}set font(e){this.attributeSet("font"),this._font=e}get font(){var e=r.vFont;let t=this._font;return void 0===t&&(t=this.getParentCell("font")),this.resolveCellValue(t,e)}set fontScale(e){this.attributeSet("fontScale"),this._fontScale=e}get fontScale(){var e=r.vScalar;let t=this._fontScale;return void 0===t&&(t=this.getParentCell("fontScale")),this.resolveCellValue(t,e)}set fontSchemeIndex(e){this.attributeSet("fontSchemeIndex"),this._fontSchemeIndex=e}get fontSchemeIndex(){var e=r.PtgByte;let t=this._fontSchemeIndex;return void 0===t&&(t=this.getParentCell("fontSchemeIndex")),this.resolveCellValue(t,e)}set format(e){this.attributeSet("format"),this._format=e}get format(){var e=r.vFormatString;let t=this._format;return void 0===t&&(t=this.getParentCell("format")),this.resolveCellValue(t,e)}set frame(e){this.attributeSet("frame"),this._frame=e}get frame(){var e=r.PtgString;let t=this._frame;return void 0===t&&(t=this.getParentCell("frame")),this.resolveCellValue(t,e)}set gamma(e){this.attributeSet("gamma"),this._gamma=e}get gamma(){var e=r.vScalar;let t=this._gamma;return void 0===t&&(t=this.getParentCell("gamma")),this.resolveCellValue(t,e)}set glowColor(e){this.attributeSet("glowColor"),this._glowColor=e}get glowColor(){var e=r.vColor;let t=this._glowColor;return void 0===t&&(t=this.getParentCell("glowColor")),this.resolveCellValue(t,e)}set glowColorTrans(e){this.attributeSet("glowColorTrans"),this._glowColorTrans=e}get glowColorTrans(){var e=r.vScalar;let t=this._glowColorTrans;return void 0===t&&(t=this.getParentCell("glowColorTrans")),this.resolveCellValue(t,e)}set glowSize(e){this.attributeSet("glowSize"),this._glowSize=e}get glowSize(){var e=r.vLength;let t=this._glowSize;return void 0===t&&(t=this.getParentCell("glowSize")),this.resolveCellValue(t,e)}set glue(e){this.attributeSet("glue"),this._glue=e}get glue(){var e=r.PtgBool;let t=this._glue;return void 0===t&&(t=this.getParentCell("glue")),this.resolveCellValue(t,e)}set glueType(e){this.attributeSet("glueType"),this._glueType=e}get glueType(){var e=r.PtgByte;let t=this._glueType;return void 0===t&&(t=this.getParentCell("glueType")),this.resolveCellValue(t,e)}set gradientStopColor(e){this.attributeSet("gradientStopColor"),this._gradientStopColor=e}get gradientStopColor(){var e=r.vColor;let t=this._gradientStopColor;return void 0===t&&(t=this.getParentCell("gradientStopColor")),this.resolveCellValue(t,e)}set gradientStopColorTrans(e){this.attributeSet("gradientStopColorTrans"),this._gradientStopColorTrans=e}get gradientStopColorTrans(){var e=r.vScalar;let t=this._gradientStopColorTrans;return void 0===t&&(t=this.getParentCell("gradientStopColorTrans")),this.resolveCellValue(t,e)}set gradientStopPosition(e){this.attributeSet("gradientStopPosition"),this._gradientStopPosition=e}get gradientStopPosition(){var e=r.vScalar;let t=this._gradientStopPosition;return void 0===t&&(t=this.getParentCell("gradientStopPosition")),this.resolveCellValue(t,e)}set height(e){this.attributeSet("height"),this._height=e}get height(){var e=r.vLength;let t=this._height;return void 0===t&&(t=this.getParentCell("height")),this.resolveCellValue(t,e)}set helpTopic(e){this.attributeSet("helpTopic"),this._helpTopic=e}get helpTopic(){var e=r.PtgString;let t=this._helpTopic;return void 0===t&&(t=this.getParentCell("helpTopic")),this.resolveCellValue(t,e)}set hideForApply(e){this.attributeSet("hideForApply"),this._hideForApply=e}get hideForApply(){var e=r.PtgBool;let t=this._hideForApply;return void 0===t&&(t=this.getParentCell("hideForApply")),this.resolveCellValue(t,e)}set hideText(e){this.attributeSet("hideText"),this._hideText=e}get hideText(){var e=r.vScalar;let t=this._hideText;return void 0===t&&(t=this.getParentCell("hideText")),this.resolveCellValue(t,e)}set horzAlign(e){this.attributeSet("horzAlign"),this._horzAlign=e}get horzAlign(){var e=r.PtgByte;let t=this._horzAlign;return void 0===t&&(t=this.getParentCell("horzAlign")),this.resolveCellValue(t,e)}set imgHeight(e){this.attributeSet("imgHeight"),this._imgHeight=e}get imgHeight(){var e=r.vLength;let t=this._imgHeight;return void 0===t&&(t=this.getParentCell("imgHeight")),this.resolveCellValue(t,e)}set imgOffsetX(e){this.attributeSet("imgOffsetX"),this._imgOffsetX=e}get imgOffsetX(){var e=r.vLength;let t=this._imgOffsetX;return void 0===t&&(t=this.getParentCell("imgOffsetX")),this.resolveCellValue(t,e)}set imgOffsetY(e){this.attributeSet("imgOffsetY"),this._imgOffsetY=e}get imgOffsetY(){var e=r.vLength;let t=this._imgOffsetY;return void 0===t&&(t=this.getParentCell("imgOffsetY")),this.resolveCellValue(t,e)}set imgWidth(e){this.attributeSet("imgWidth"),this._imgWidth=e}get imgWidth(){var e=r.vLength;let t=this._imgWidth;return void 0===t&&(t=this.getParentCell("imgWidth")),this.resolveCellValue(t,e)}set indFirst(e){this.attributeSet("indFirst"),this._indFirst=e}get indFirst(){var e=r.vLength;let t=this._indFirst;return void 0===t&&(t=this.getParentCell("indFirst")),this.resolveCellValue(t,e)}set indLeft(e){this.attributeSet("indLeft"),this._indLeft=e}get indLeft(){var e=r.vLength;let t=this._indLeft;return void 0===t&&(t=this.getParentCell("indLeft")),this.resolveCellValue(t,e)}set indRight(e){this.attributeSet("indRight"),this._indRight=e}get indRight(){var e=r.vLength;let t=this._indRight;return void 0===t&&(t=this.getParentCell("indRight")),this.resolveCellValue(t,e)}set inhibitSnap(e){this.attributeSet("inhibitSnap"),this._inhibitSnap=e}get inhibitSnap(){var e=r.PtgBool;let t=this._inhibitSnap;return void 0===t&&(t=this.getParentCell("inhibitSnap")),this.resolveCellValue(t,e)}set initials(e){this.attributeSet("initials"),this._initials=e}get initials(){var e=r.PtgString;let t=this._initials;return void 0===t&&(t=this.getParentCell("initials")),this.resolveCellValue(t,e)}set invisible(e){this.attributeSet("invisible"),this._invisible=e}get invisible(){var e=r.PtgBool;let t=this._invisible;return void 0===t&&(t=this.getParentCell("invisible")),this.resolveCellValue(t,e)}set isDropSource(e){this.attributeSet("isDropSource"),this._isDropSource=e}get isDropSource(){var e=r.PtgBool;let t=this._isDropSource;return void 0===t&&(t=this.getParentCell("isDropSource")),this.resolveCellValue(t,e)}set isDropTarget(e){this.attributeSet("isDropTarget"),this._isDropTarget=e}get isDropTarget(){var e=r.PtgBool;let t=this._isDropTarget;return void 0===t&&(t=this.getParentCell("isDropTarget")),this.resolveCellValue(t,e)}set isSnapTarget(e){this.attributeSet("isSnapTarget"),this._isSnapTarget=e}get isSnapTarget(){var e=r.PtgBool;let t=this._isSnapTarget;return void 0===t&&(t=this.getParentCell("isSnapTarget")),this.resolveCellValue(t,e)}set isTextEditTarget(e){this.attributeSet("isTextEditTarget"),this._isTextEditTarget=e}get isTextEditTarget(){var e=r.PtgBool;let t=this._isTextEditTarget;return void 0===t&&(t=this.getParentCell("isTextEditTarget")),this.resolveCellValue(t,e)}set keepTextFlat(e){this.attributeSet("keepTextFlat"),this._keepTextFlat=e}get keepTextFlat(){var e=r.PtgBool;let t=this._keepTextFlat;return void 0===t&&(t=this.getParentCell("keepTextFlat")),this.resolveCellValue(t,e)}set label(e){this.attributeSet("label"),this._label=e}get label(){var e=r.PtgString;let t=this._label;return void 0===t&&(t=this.getParentCell("label")),this.resolveCellValue(t,e)}set langID(e){this.attributeSet("langID"),this._langID=e}get langID(){var e=r.vLanguageString;let t=this._langID;return void 0===t&&(t=this.getParentCell("langID")),this.resolveCellValue(t,e)}set layerMember(e){this.attributeSet("layerMember"),this._layerMember=e}get layerMember(){var e=r.PtgString;let t=this._layerMember;return void 0===t&&(t=this.getParentCell("layerMember")),this.resolveCellValue(t,e)}set leftMargin(e){this.attributeSet("leftMargin"),this._leftMargin=e}get leftMargin(){var e=r.vLength;let t=this._leftMargin;return void 0===(t=void 0===t?this.getParentCell("leftMargin"):t)&&(t=this.getStylesheetTextStyleCell("leftMargin")),this.resolveCellValue(t,e)}set letterspace(e){this.attributeSet("letterspace"),this._letterspace=e}get letterspace(){var e=r.vLength;let t=this._letterspace;return void 0===t&&(t=this.getParentCell("letterspace")),this.resolveCellValue(t,e)}set lineAdjustFrom(e){this.attributeSet("lineAdjustFrom"),this._lineAdjustFrom=e}get lineAdjustFrom(){var e=r.PtgByte;let t=this._lineAdjustFrom;return void 0===t&&(t=this.getParentCell("lineAdjustFrom")),this.resolveCellValue(t,e)}set lineAdjustTo(e){this.attributeSet("lineAdjustTo"),this._lineAdjustTo=e}get lineAdjustTo(){var e=r.PtgByte;let t=this._lineAdjustTo;return void 0===t&&(t=this.getParentCell("lineAdjustTo")),this.resolveCellValue(t,e)}set lineCap(e){this.attributeSet("lineCap"),this._lineCap=e}get lineCap(){var e=r.PtgByte;let t=this._lineCap;return void 0===t&&(t=this.getParentCell("lineCap")),this.resolveCellValue(t,e)}set lineColor(e){this.attributeSet("lineColor"),this._lineColor=e}get lineColor(){var e=r.vColor;let t=this._lineColor;return void 0===(t=void 0===t?this.getParentCell("lineColor"):t)&&(t=this.getStylesheetLineStyleCell("lineColor")),this.resolveCellValue(t,e)}set lineColorTrans(e){this.attributeSet("lineColorTrans"),this._lineColorTrans=e}get lineColorTrans(){var e=r.vScalar;let t=this._lineColorTrans;return void 0===(t=void 0===t?this.getParentCell("lineColorTrans"):t)&&(t=this.getStylesheetLineStyleCell("lineColorTrans")),this.resolveCellValue(t,e)}set lineGradientAngle(e){this.attributeSet("lineGradientAngle"),this._lineGradientAngle=e}get lineGradientAngle(){var e=r.vAngle;let t=this._lineGradientAngle;return void 0===t&&(t=this.getParentCell("lineGradientAngle")),this.resolveCellValue(t,e)}set lineGradientDir(e){this.attributeSet("lineGradientDir"),this._lineGradientDir=e}get lineGradientDir(){var e=r.PtgByte;let t=this._lineGradientDir;return void 0===t&&(t=this.getParentCell("lineGradientDir")),this.resolveCellValue(t,e)}set lineGradientEnabled(e){this.attributeSet("lineGradientEnabled"),this._lineGradientEnabled=e}get lineGradientEnabled(){var e=r.PtgBool;let t=this._lineGradientEnabled;return void 0===t&&(t=this.getParentCell("lineGradientEnabled")),this.resolveCellValue(t,e)}set lineJumpCode(e){this.attributeSet("lineJumpCode"),this._lineJumpCode=e}get lineJumpCode(){var e=r.PtgByte;let t=this._lineJumpCode;return void 0===t&&(t=this.getParentCell("lineJumpCode")),this.resolveCellValue(t,e)}set lineJumpFactorX(e){this.attributeSet("lineJumpFactorX"),this._lineJumpFactorX=e}get lineJumpFactorX(){var e=r.vScalar;let t=this._lineJumpFactorX;return void 0===t&&(t=this.getParentCell("lineJumpFactorX")),this.resolveCellValue(t,e)}set lineJumpFactorY(e){this.attributeSet("lineJumpFactorY"),this._lineJumpFactorY=e}get lineJumpFactorY(){var e=r.vScalar;let t=this._lineJumpFactorY;return void 0===t&&(t=this.getParentCell("lineJumpFactorY")),this.resolveCellValue(t,e)}set lineJumpStyle(e){this.attributeSet("lineJumpStyle"),this._lineJumpStyle=e}get lineJumpStyle(){var e=r.PtgByte;let t=this._lineJumpStyle;return void 0===t&&(t=this.getParentCell("lineJumpStyle")),this.resolveCellValue(t,e)}set linePattern(e){this.attributeSet("linePattern"),this._linePattern=e}get linePattern(){var e=r.PtgByte;let t=this._linePattern;return void 0===(t=void 0===t?this.getParentCell("linePattern"):t)&&(t=this.getStylesheetLineStyleCell("linePattern")),this.resolveCellValue(t,e)}set lineRouteExt(e){this.attributeSet("lineRouteExt"),this._lineRouteExt=e}get lineRouteExt(){var e=r.PtgByte;let t=this._lineRouteExt;return void 0===t&&(t=this.getParentCell("lineRouteExt")),this.resolveCellValue(t,e)}set lineToLineX(e){this.attributeSet("lineToLineX"),this._lineToLineX=e}get lineToLineX(){var e=r.vScalar;let t=this._lineToLineX;return void 0===t&&(t=this.getParentCell("lineToLineX")),this.resolveCellValue(t,e)}set lineToLineY(e){this.attributeSet("lineToLineY"),this._lineToLineY=e}get lineToLineY(){var e=r.vScalar;let t=this._lineToLineY;return void 0===t&&(t=this.getParentCell("lineToLineY")),this.resolveCellValue(t,e)}set lineToNodeX(e){this.attributeSet("lineToNodeX"),this._lineToNodeX=e}get lineToNodeX(){var e=r.vScalar;let t=this._lineToNodeX;return void 0===t&&(t=this.getParentCell("lineToNodeX")),this.resolveCellValue(t,e)}set lineToNodeY(e){this.attributeSet("lineToNodeY"),this._lineToNodeY=e}get lineToNodeY(){var e=r.vScalar;let t=this._lineToNodeY;return void 0===t&&(t=this.getParentCell("lineToNodeY")),this.resolveCellValue(t,e)}set lineWeight(e){this.attributeSet("lineWeight"),this._lineWeight=e}get lineWeight(){var e=r.vLength;let t=this._lineWeight;return void 0===(t=void 0===t?this.getParentCell("lineWeight"):t)&&(t=this.getStylesheetLineStyleCell("lineWeight")),this.resolveCellValue(t,e)}set localizeMerge(e){this.attributeSet("localizeMerge"),this._localizeMerge=e}get localizeMerge(){var e=r.PtgBool;let t=this._localizeMerge;return void 0===t&&(t=this.getParentCell("localizeMerge")),this.resolveCellValue(t,e)}set lock(e){this.attributeSet("lock"),this._lock=e}get lock(){var e=r.PtgBool;let t=this._lock;return void 0===t&&(t=this.getParentCell("lock")),this.resolveCellValue(t,e)}set lockAspect(e){this.attributeSet("lockAspect"),this._lockAspect=e}get lockAspect(){var e=r.PtgBool;let t=this._lockAspect;return void 0===t&&(t=this.getParentCell("lockAspect")),this.resolveCellValue(t,e)}set lockBegin(e){this.attributeSet("lockBegin"),this._lockBegin=e}get lockBegin(){var e=r.PtgBool;let t=this._lockBegin;return void 0===t&&(t=this.getParentCell("lockBegin")),this.resolveCellValue(t,e)}set lockCalcWH(e){this.attributeSet("lockCalcWH"),this._lockCalcWH=e}get lockCalcWH(){var e=r.PtgBool;let t=this._lockCalcWH;return void 0===t&&(t=this.getParentCell("lockCalcWH")),this.resolveCellValue(t,e)}set lockCrop(e){this.attributeSet("lockCrop"),this._lockCrop=e}get lockCrop(){var e=r.PtgBool;let t=this._lockCrop;return void 0===t&&(t=this.getParentCell("lockCrop")),this.resolveCellValue(t,e)}set lockCustProp(e){this.attributeSet("lockCustProp"),this._lockCustProp=e}get lockCustProp(){var e=r.PtgBool;let t=this._lockCustProp;return void 0===t&&(t=this.getParentCell("lockCustProp")),this.resolveCellValue(t,e)}set lockDelete(e){this.attributeSet("lockDelete"),this._lockDelete=e}get lockDelete(){var e=r.PtgBool;let t=this._lockDelete;return void 0===t&&(t=this.getParentCell("lockDelete")),this.resolveCellValue(t,e)}set lockEnd(e){this.attributeSet("lockEnd"),this._lockEnd=e}get lockEnd(){var e=r.PtgBool;let t=this._lockEnd;return void 0===t&&(t=this.getParentCell("lockEnd")),this.resolveCellValue(t,e)}set lockFormat(e){this.attributeSet("lockFormat"),this._lockFormat=e}get lockFormat(){var e=r.PtgBool;let t=this._lockFormat;return void 0===t&&(t=this.getParentCell("lockFormat")),this.resolveCellValue(t,e)}set lockFromGroupFormat(e){this.attributeSet("lockFromGroupFormat"),this._lockFromGroupFormat=e}get lockFromGroupFormat(){var e=r.PtgBool;let t=this._lockFromGroupFormat;return void 0===t&&(t=this.getParentCell("lockFromGroupFormat")),this.resolveCellValue(t,e)}set lockGroup(e){this.attributeSet("lockGroup"),this._lockGroup=e}get lockGroup(){var e=r.PtgBool;let t=this._lockGroup;return void 0===t&&(t=this.getParentCell("lockGroup")),this.resolveCellValue(t,e)}set lockHeight(e){this.attributeSet("lockHeight"),this._lockHeight=e}get lockHeight(){var e=r.PtgBool;let t=this._lockHeight;return void 0===t&&(t=this.getParentCell("lockHeight")),this.resolveCellValue(t,e)}set lockMoveX(e){this.attributeSet("lockMoveX"),this._lockMoveX=e}get lockMoveX(){var e=r.PtgBool;let t=this._lockMoveX;return void 0===t&&(t=this.getParentCell("lockMoveX")),this.resolveCellValue(t,e)}set lockMoveY(e){this.attributeSet("lockMoveY"),this._lockMoveY=e}get lockMoveY(){var e=r.PtgBool;let t=this._lockMoveY;return void 0===t&&(t=this.getParentCell("lockMoveY")),this.resolveCellValue(t,e)}set lockPreview(e){this.attributeSet("lockPreview"),this._lockPreview=e}get lockPreview(){var e=r.PtgBool;let t=this._lockPreview;return void 0===t&&(t=this.getParentCell("lockPreview")),this.resolveCellValue(t,e)}set lockReplace(e){this.attributeSet("lockReplace"),this._lockReplace=e}get lockReplace(){var e=r.PtgBool;let t=this._lockReplace;return void 0===t&&(t=this.getParentCell("lockReplace")),this.resolveCellValue(t,e)}set lockRotate(e){this.attributeSet("lockRotate"),this._lockRotate=e}get lockRotate(){var e=r.PtgBool;let t=this._lockRotate;return void 0===t&&(t=this.getParentCell("lockRotate")),this.resolveCellValue(t,e)}set lockSelect(e){this.attributeSet("lockSelect"),this._lockSelect=e}get lockSelect(){var e=r.PtgBool;let t=this._lockSelect;return void 0===t&&(t=this.getParentCell("lockSelect")),this.resolveCellValue(t,e)}set lockTextEdit(e){this.attributeSet("lockTextEdit"),this._lockTextEdit=e}get lockTextEdit(){var e=r.PtgBool;let t=this._lockTextEdit;return void 0===t&&(t=this.getParentCell("lockTextEdit")),this.resolveCellValue(t,e)}set lockThemeColors(e){this.attributeSet("lockThemeColors"),this._lockThemeColors=e}get lockThemeColors(){var e=r.PtgBool;let t=this._lockThemeColors;return void 0===t&&(t=this.getParentCell("lockThemeColors")),this.resolveCellValue(t,e)}set lockThemeConnectors(e){this.attributeSet("lockThemeConnectors"),this._lockThemeConnectors=e}get lockThemeConnectors(){var e=r.PtgBool;let t=this._lockThemeConnectors;return void 0===t&&(t=this.getParentCell("lockThemeConnectors")),this.resolveCellValue(t,e)}set lockThemeEffects(e){this.attributeSet("lockThemeEffects"),this._lockThemeEffects=e}get lockThemeEffects(){var e=r.PtgBool;let t=this._lockThemeEffects;return void 0===t&&(t=this.getParentCell("lockThemeEffects")),this.resolveCellValue(t,e)}set lockThemeFonts(e){this.attributeSet("lockThemeFonts"),this._lockThemeFonts=e}get lockThemeFonts(){var e=r.PtgBool;let t=this._lockThemeFonts;return void 0===t&&(t=this.getParentCell("lockThemeFonts")),this.resolveCellValue(t,e)}set lockThemeIndex(e){this.attributeSet("lockThemeIndex"),this._lockThemeIndex=e}get lockThemeIndex(){var e=r.PtgBool;let t=this._lockThemeIndex;return void 0===t&&(t=this.getParentCell("lockThemeIndex")),this.resolveCellValue(t,e)}set lockVariation(e){this.attributeSet("lockVariation"),this._lockVariation=e}get lockVariation(){var e=r.PtgBool;let t=this._lockVariation;return void 0===t&&(t=this.getParentCell("lockVariation")),this.resolveCellValue(t,e)}set lockVtxEdit(e){this.attributeSet("lockVtxEdit"),this._lockVtxEdit=e}get lockVtxEdit(){var e=r.PtgBool;let t=this._lockVtxEdit;return void 0===t&&(t=this.getParentCell("lockVtxEdit")),this.resolveCellValue(t,e)}set lockWidth(e){this.attributeSet("lockWidth"),this._lockWidth=e}get lockWidth(){var e=r.PtgBool;let t=this._lockWidth;return void 0===t&&(t=this.getParentCell("lockWidth")),this.resolveCellValue(t,e)}set locPinX(e){this.attributeSet("locPinX"),this._locPinX=e}get locPinX(){var e=r.vLength;let t=this._locPinX;return void 0===t&&(t=this.getParentCell("locPinX")),this.resolveCellValue(t,e)}set locPinY(e){this.attributeSet("locPinY"),this._locPinY=e}get locPinY(){var e=r.vLength;let t=this._locPinY;return void 0===t&&(t=this.getParentCell("locPinY")),this.resolveCellValue(t,e)}set menu(e){this.attributeSet("menu"),this._menu=e}get menu(){var e=r.PtgString;let t=this._menu;return void 0===t&&(t=this.getParentCell("menu")),this.resolveCellValue(t,e)}set name(e){this.attributeSet("name"),this._name=e}get name(){var e=r.PtgString;let t=this._name;return void 0===t&&(t=this.getParentCell("name")),this.resolveCellValue(t,e)}set nameUniv(e){this.attributeSet("nameUniv"),this._nameUniv=e}get nameUniv(){var e=r.PtgString;let t=this._nameUniv;return void 0===t&&(t=this.getParentCell("nameUniv")),this.resolveCellValue(t,e)}set newWindow(e){this.attributeSet("newWindow"),this._newWindow=e}get newWindow(){var e=r.PtgBool;let t=this._newWindow;return void 0===t&&(t=this.getParentCell("newWindow")),this.resolveCellValue(t,e)}set noAlignBox(e){this.attributeSet("noAlignBox"),this._noAlignBox=e}get noAlignBox(){var e=r.PtgBool;let t=this._noAlignBox;return void 0===t&&(t=this.getParentCell("noAlignBox")),this.resolveCellValue(t,e)}set noCoauth(e){this.attributeSet("noCoauth"),this._noCoauth=e}get noCoauth(){var e=r.PtgBool;let t=this._noCoauth;return void 0===t&&(t=this.getParentCell("noCoauth")),this.resolveCellValue(t,e)}set noCtlHandles(e){this.attributeSet("noCtlHandles"),this._noCtlHandles=e}get noCtlHandles(){var e=r.PtgBool;let t=this._noCtlHandles;return void 0===t&&(t=this.getParentCell("noCtlHandles")),this.resolveCellValue(t,e)}set noFill(e){this.attributeSet("noFill"),this._noFill=e}get noFill(){var e=r.PtgBool;let t=this._noFill;return void 0===t&&(t=this.getParentCell("noFill")),this.resolveCellValue(t,e)}set noLine(e){this.attributeSet("noLine"),this._noLine=e}get noLine(){var e=r.PtgBool;let t=this._noLine;return void 0===t&&(t=this.getParentCell("noLine")),this.resolveCellValue(t,e)}set noLiveDynamics(e){this.attributeSet("noLiveDynamics"),this._noLiveDynamics=e}get noLiveDynamics(){var e=r.PtgBool;let t=this._noLiveDynamics;return void 0===t&&(t=this.getParentCell("noLiveDynamics")),this.resolveCellValue(t,e)}set nonPrinting(e){this.attributeSet("nonPrinting"),this._nonPrinting=e}get nonPrinting(){var e=r.PtgBool;let t=this._nonPrinting;return void 0===t&&(t=this.getParentCell("nonPrinting")),this.resolveCellValue(t,e)}set noObjHandles(e){this.attributeSet("noObjHandles"),this._noObjHandles=e}get noObjHandles(){var e=r.PtgBool;let t=this._noObjHandles;return void 0===t&&(t=this.getParentCell("noObjHandles")),this.resolveCellValue(t,e)}set noProofing(e){this.attributeSet("noProofing"),this._noProofing=e}get noProofing(){var e=r.PtgBool;let t=this._noProofing;return void 0===t&&(t=this.getParentCell("noProofing")),this.resolveCellValue(t,e)}set noQuickDrag(e){this.attributeSet("noQuickDrag"),this._noQuickDrag=e}get noQuickDrag(){var e=r.PtgBool;let t=this._noQuickDrag;return void 0===t&&(t=this.getParentCell("noQuickDrag")),this.resolveCellValue(t,e)}set noShow(e){this.attributeSet("noShow"),this._noShow=e}get noShow(){var e=r.PtgBool;let t=this._noShow;return void 0===t&&(t=this.getParentCell("noShow")),this.resolveCellValue(t,e)}set noSnap(e){this.attributeSet("noSnap"),this._noSnap=e}get noSnap(){var e=r.PtgBool;let t=this._noSnap;return void 0===t&&(t=this.getParentCell("noSnap")),this.resolveCellValue(t,e)}set objectKind(e){this.attributeSet("objectKind"),this._objectKind=e}get objectKind(){var e=r.PtgByte;let t=this._objectKind;return void 0===t&&(t=this.getParentCell("objectKind")),this.resolveCellValue(t,e)}set objType(e){this.attributeSet("objType"),this._objType=e}get objType(){var e=r.PtgByte;let t=this._objType;return void 0===t&&(t=this.getParentCell("objType")),this.resolveCellValue(t,e)}set onPage(e){this.attributeSet("onPage"),this._onPage=e}get onPage(){var e=r.PtgBool;let t=this._onPage;return void 0===t&&(t=this.getParentCell("onPage")),this.resolveCellValue(t,e)}set outputFormat(e){this.attributeSet("outputFormat"),this._outputFormat=e}get outputFormat(){var e=r.PtgByte;let t=this._outputFormat;return void 0===t&&(t=this.getParentCell("outputFormat")),this.resolveCellValue(t,e)}set overline(e){this.attributeSet("overline"),this._overline=e}get overline(){var e=r.PtgBool;let t=this._overline;return void 0===t&&(t=this.getParentCell("overline")),this.resolveCellValue(t,e)}set pageBottomMargin(e){this.attributeSet("pageBottomMargin"),this._pageBottomMargin=e}get pageBottomMargin(){var e=r.vScalar;let t=this._pageBottomMargin;return void 0===(t=void 0===t?this.getParentCell("pageBottomMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)}set pageHeight(e){this.attributeSet("pageHeight"),this._pageHeight=e}get pageHeight(){var e=r.vLength;let t=this._pageHeight;return void 0===t&&(t=this.getParentCell("pageHeight")),this.resolveCellValue(t,e)}set pageLeftMargin(e){this.attributeSet("pageLeftMargin"),this._pageLeftMargin=e}get pageLeftMargin(){var e=r.vScalar;let t=this._pageLeftMargin;return void 0===(t=void 0===t?this.getParentCell("pageLeftMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)}set pageLineJumpDirX(e){this.attributeSet("pageLineJumpDirX"),this._pageLineJumpDirX=e}get pageLineJumpDirX(){var e=r.PtgByte;let t=this._pageLineJumpDirX;return void 0===t&&(t=this.getParentCell("pageLineJumpDirX")),this.resolveCellValue(t,e)}set pageLineJumpDirY(e){this.attributeSet("pageLineJumpDirY"),this._pageLineJumpDirY=e}get pageLineJumpDirY(){var e=r.PtgByte;let t=this._pageLineJumpDirY;return void 0===t&&(t=this.getParentCell("pageLineJumpDirY")),this.resolveCellValue(t,e)}set pageLockDuplicate(e){this.attributeSet("pageLockDuplicate"),this._pageLockDuplicate=e}get pageLockDuplicate(){var e=r.PtgBool;let t=this._pageLockDuplicate;return void 0===t&&(t=this.getParentCell("pageLockDuplicate")),this.resolveCellValue(t,e)}set pageLockReplace(e){this.attributeSet("pageLockReplace"),this._pageLockReplace=e}get pageLockReplace(){var e=r.PtgBool;let t=this._pageLockReplace;return void 0===t&&(t=this.getParentCell("pageLockReplace")),this.resolveCellValue(t,e)}set pageRightMargin(e){this.attributeSet("pageRightMargin"),this._pageRightMargin=e}get pageRightMargin(){var e=r.vScalar;let t=this._pageRightMargin;return void 0===(t=void 0===t?this.getParentCell("pageRightMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)}set pageScale(e){this.attributeSet("pageScale"),this._pageScale=e}get pageScale(){var e=r.vLength;let t=this._pageScale;return void 0===t&&(t=this.getParentCell("pageScale")),this.resolveCellValue(t,e)}set pageShapeSplit(e){this.attributeSet("pageShapeSplit"),this._pageShapeSplit=e}get pageShapeSplit(){var e=r.PtgByte;let t=this._pageShapeSplit;return void 0===t&&(t=this.getParentCell("pageShapeSplit")),this.resolveCellValue(t,e)}set pagesX(e){this.attributeSet("pagesX"),this._pagesX=e}get pagesX(){var e=r.PtgUnsShort;let t=this._pagesX;return void 0===t&&(t=this.getParentCell("pagesX")),this.resolveCellValue(t,e)}set pagesY(e){this.attributeSet("pagesY"),this._pagesY=e}get pagesY(){var e=r.PtgUnsShort;let t=this._pagesY;return void 0===t&&(t=this.getParentCell("pagesY")),this.resolveCellValue(t,e)}set pageTopMargin(e){this.attributeSet("pageTopMargin"),this._pageTopMargin=e}get pageTopMargin(){var e=r.vScalar;let t=this._pageTopMargin;return void 0===(t=void 0===t?this.getParentCell("pageTopMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)}set pageWidth(e){this.attributeSet("pageWidth"),this._pageWidth=e}get pageWidth(){var e=r.vLength;let t=this._pageWidth;return void 0===t&&(t=this.getParentCell("pageWidth")),this.resolveCellValue(t,e)}set paperKind(e){this.attributeSet("paperKind"),this._paperKind=e}get paperKind(){var e=r.PtgUnsShort;let t=this._paperKind;return void 0===t&&(t=this.getParentCell("paperKind")),this.resolveCellValue(t,e)}set paperSource(e){this.attributeSet("paperSource"),this._paperSource=e}get paperSource(){var e=r.PtgUnsShort;let t=this._paperSource;return void 0===t&&(t=this.getParentCell("paperSource")),this.resolveCellValue(t,e)}set perspective(e){this.attributeSet("perspective"),this._perspective=e}get perspective(){let e=this._perspective;void 0===e&&(e=this.getParentCell("perspective"));var t=r.vAngle;return W.log('resolve cell type "perspective"'),e.units&&W.log("vScalar unclear"),this.resolveCellValue(e,t)}set pinX(e){this.attributeSet("pinX"),this._pinX=e}get pinX(){var e=r.vLength;let t=this._pinX;return void 0===t&&(t=this.getParentCell("pinX")),this.resolveCellValue(t,e)}set pinY(e){this.attributeSet("pinY"),this._pinY=e}get pinY(){var e=r.vLength;let t=this._pinY;return void 0===t&&(t=this.getParentCell("pinY")),this.resolveCellValue(t,e)}set placeDepth(e){this.attributeSet("placeDepth"),this._placeDepth=e}get placeDepth(){var e=r.PtgByte;let t=this._placeDepth;return void 0===t&&(t=this.getParentCell("placeDepth")),this.resolveCellValue(t,e)}set placeFlip(e){this.attributeSet("placeFlip"),this._placeFlip=e}get placeFlip(){var e=r.PtgByte;let t=this._placeFlip;return void 0===t&&(t=this.getParentCell("placeFlip")),this.resolveCellValue(t,e)}set placeStyle(e){this.attributeSet("placeStyle"),this._placeStyle=e}get placeStyle(){var e=r.PtgByte;let t=this._placeStyle;return void 0===t&&(t=this.getParentCell("placeStyle")),this.resolveCellValue(t,e)}set plowCode(e){this.attributeSet("plowCode"),this._plowCode=e}get plowCode(){var e=r.PtgByte;let t=this._plowCode;return void 0===t&&(t=this.getParentCell("plowCode")),this.resolveCellValue(t,e)}set pos(e){this.attributeSet("pos"),this._pos=e}get pos(){var e=r.PtgByte;let t=this._pos;return void 0===t&&(t=this.getParentCell("pos")),this.resolveCellValue(t,e)}set position(e){this.attributeSet("position"),this._position=e}get position(){var e=r.vLength;let t=this._position;return void 0===t&&(t=this.getParentCell("position")),this.resolveCellValue(t,e)}set previewQuality(e){this.attributeSet("previewQuality"),this._previewQuality=e}get previewQuality(){var e=r.PtgByte;let t=this._previewQuality;return void 0===t&&(t=this.getParentCell("previewQuality")),this.resolveCellValue(t,e)}set previewScope(e){this.attributeSet("previewScope"),this._previewScope=e}get previewScope(){var e=r.PtgByte;let t=this._previewScope;return void 0===t&&(t=this.getParentCell("previewScope")),this.resolveCellValue(t,e)}set print(e){this.attributeSet("print"),this._print=e}get print(){var e=r.PtgBool;let t=this._print;return void 0===t&&(t=this.getParentCell("print")),this.resolveCellValue(t,e)}set printGrid(e){this.attributeSet("printGrid"),this._printGrid=e}get printGrid(){var e=r.PtgBool;let t=this._printGrid;return void 0===t&&(t=this.getParentCell("printGrid")),this.resolveCellValue(t,e)}set printPageOrientation(e){this.attributeSet("printPageOrientation"),this._printPageOrientation=e}get printPageOrientation(){var e=r.PtgByte;let t=this._printPageOrientation;return void 0===t&&(t=this.getParentCell("printPageOrientation")),this.resolveCellValue(t,e)}set prompt(e){this.attributeSet("prompt"),this._prompt=e}get prompt(){var e=r.PtgString;let t=this._prompt;return void 0===t&&(t=this.getParentCell("prompt")),this.resolveCellValue(t,e)}set quickStyleEffectsMatrix(e){this.attributeSet("quickStyleEffectsMatrix"),this._quickStyleEffectsMatrix=e}get quickStyleEffectsMatrix(){var e=r.PtgByte;let t=this._quickStyleEffectsMatrix;return void 0===t&&(t=this.getParentCell("quickStyleEffectsMatrix")),this.resolveCellValue(t,e)}set quickStyleFillColor(e){this.attributeSet("quickStyleFillColor"),this._quickStyleFillColor=e}get quickStyleFillColor(){var e=r.PtgByte;let t=this._quickStyleFillColor;return void 0===t&&(t=this.getParentCell("quickStyleFillColor")),this.resolveCellValue(t,e)}set quickStyleFillMatrix(e){this.attributeSet("quickStyleFillMatrix"),this._quickStyleFillMatrix=e}get quickStyleFillMatrix(){var e=r.PtgByte;let t=this._quickStyleFillMatrix;return void 0===t&&(t=this.getParentCell("quickStyleFillMatrix")),this.resolveCellValue(t,e)}set quickStyleFontColor(e){this.attributeSet("quickStyleFontColor"),this._quickStyleFontColor=e}get quickStyleFontColor(){var e=r.PtgByte;let t=this._quickStyleFontColor;return void 0===t&&(t=this.getParentCell("quickStyleFontColor")),this.resolveCellValue(t,e)}set quickStyleFontMatrix(e){this.attributeSet("quickStyleFontMatrix"),this._quickStyleFontMatrix=e}get quickStyleFontMatrix(){var e=r.PtgByte;let t=this._quickStyleFontMatrix;return void 0===t&&(t=this.getParentCell("quickStyleFontMatrix")),this.resolveCellValue(t,e)}set quickStyleLineColor(e){this.attributeSet("quickStyleLineColor"),this._quickStyleLineColor=e}get quickStyleLineColor(){var e=r.PtgByte;let t=this._quickStyleLineColor;return void 0===t&&(t=this.getParentCell("quickStyleLineColor")),this.resolveCellValue(t,e)}set quickStyleLineMatrix(e){this.attributeSet("quickStyleLineMatrix"),this._quickStyleLineMatrix=e}get quickStyleLineMatrix(){var e=r.PtgByte;let t=this._quickStyleLineMatrix;return void 0===t&&(t=this.getParentCell("quickStyleLineMatrix")),this.resolveCellValue(t,e)}set quickStyleShadowColor(e){this.attributeSet("quickStyleShadowColor"),this._quickStyleShadowColor=e}get quickStyleShadowColor(){var e=r.PtgByte;let t=this._quickStyleShadowColor;return void 0===t&&(t=this.getParentCell("quickStyleShadowColor")),this.resolveCellValue(t,e)}set quickStyleType(e){this.attributeSet("quickStyleType"),this._quickStyleType=e}get quickStyleType(){var e=r.PtgInt;let t=this._quickStyleType;return void 0===t&&(t=this.getParentCell("quickStyleType")),this.resolveCellValue(t,e)}set quickStyleVariation(e){this.attributeSet("quickStyleVariation"),this._quickStyleVariation=e}get quickStyleVariation(){var e=r.PtgByte;let t=this._quickStyleVariation;return void 0===t&&(t=this.getParentCell("quickStyleVariation")),this.resolveCellValue(t,e)}set readOnly(e){this.attributeSet("readOnly"),this._readOnly=e}get readOnly(){var e=r.PtgBool;let t=this._readOnly;return void 0===t&&(t=this.getParentCell("readOnly")),this.resolveCellValue(t,e)}set reflectionBlur(e){this.attributeSet("reflectionBlur"),this._reflectionBlur=e}get reflectionBlur(){var e=r.vLength;let t=this._reflectionBlur;return void 0===t&&(t=this.getParentCell("reflectionBlur")),this.resolveCellValue(t,e)}set reflectionDist(e){this.attributeSet("reflectionDist"),this._reflectionDist=e}get reflectionDist(){var e=r.vLength;let t=this._reflectionDist;return void 0===t&&(t=this.getParentCell("reflectionDist")),this.resolveCellValue(t,e)}set reflectionSize(e){this.attributeSet("reflectionSize"),this._reflectionSize=e}get reflectionSize(){var e=r.vScalar;let t=this._reflectionSize;return void 0===t&&(t=this.getParentCell("reflectionSize")),this.resolveCellValue(t,e)}set reflectionTrans(e){this.attributeSet("reflectionTrans"),this._reflectionTrans=e}get reflectionTrans(){var e=r.vScalar;let t=this._reflectionTrans;return void 0===t&&(t=this.getParentCell("reflectionTrans")),this.resolveCellValue(t,e)}set relationships(e){this.attributeSet("relationships"),this._relationships=e}get relationships(){var e=r.PtgBool;let t=this._relationships;return void 0===t&&(t=this.getParentCell("relationships")),this.resolveCellValue(t,e)}set replaceCopyCells(e){this.attributeSet("replaceCopyCells"),this._replaceCopyCells=e}get replaceCopyCells(){var e=r.PtgByte;let t=this._replaceCopyCells;return void 0===t&&(t=this.getParentCell("replaceCopyCells")),this.resolveCellValue(t,e)}set replaceLockFormat(e){this.attributeSet("replaceLockFormat"),this._replaceLockFormat=e}get replaceLockFormat(){var e=r.PtgByte;let t=this._replaceLockFormat;return void 0===t&&(t=this.getParentCell("replaceLockFormat")),this.resolveCellValue(t,e)}set replaceLockShapeData(e){this.attributeSet("replaceLockShapeData"),this._replaceLockShapeData=e}get replaceLockShapeData(){var e=r.PtgByte;let t=this._replaceLockShapeData;return void 0===t&&(t=this.getParentCell("replaceLockShapeData")),this.resolveCellValue(t,e)}set replaceLockText(e){this.attributeSet("replaceLockText"),this._replaceLockText=e}get replaceLockText(){var e=r.PtgByte;let t=this._replaceLockText;return void 0===t&&(t=this.getParentCell("replaceLockText")),this.resolveCellValue(t,e)}set resizeMode(e){this.attributeSet("resizeMode"),this._resizeMode=e}get resizeMode(){var e=r.PtgByte;let t=this._resizeMode;return void 0===t&&(t=this.getParentCell("resizeMode")),this.resolveCellValue(t,e)}set resizePage(e){this.attributeSet("resizePage"),this._resizePage=e}get resizePage(){var e=r.PtgBool;let t=this._resizePage;return void 0===t&&(t=this.getParentCell("resizePage")),this.resolveCellValue(t,e)}set reviewerID(e){this.attributeSet("reviewerID"),this._reviewerID=e}get reviewerID(){var e=r.PtgShort;let t=this._reviewerID;return void 0===t&&(t=this.getParentCell("reviewerID")),this.resolveCellValue(t,e)}set rightMargin(e){this.attributeSet("rightMargin"),this._rightMargin=e}get rightMargin(){var e=r.vLength;let t=this._rightMargin;return void 0===(t=void 0===t?this.getParentCell("rightMargin"):t)&&(t=this.getStylesheetTextStyleCell("rightMargin")),this.resolveCellValue(t,e)}set rotateGradientWithShape(e){this.attributeSet("rotateGradientWithShape"),this._rotateGradientWithShape=e}get rotateGradientWithShape(){var e=r.PtgBool;let t=this._rotateGradientWithShape;return void 0===t&&(t=this.getParentCell("rotateGradientWithShape")),this.resolveCellValue(t,e)}set rotationType(e){this.attributeSet("rotationType"),this._rotationType=e}get rotationType(){var e=r.PtgByte;let t=this._rotationType;return void 0===t&&(t=this.getParentCell("rotationType")),this.resolveCellValue(t,e)}set rotationXAngle(e){this.attributeSet("rotationXAngle"),this._rotationXAngle=e}get rotationXAngle(){var e=r.vAngle;let t=this._rotationXAngle;return void 0===t&&(t=this.getParentCell("rotationXAngle")),this.resolveCellValue(t,e)}set rotationYAngle(e){this.attributeSet("rotationYAngle"),this._rotationYAngle=e}get rotationYAngle(){var e=r.vAngle;let t=this._rotationYAngle;return void 0===t&&(t=this.getParentCell("rotationYAngle")),this.resolveCellValue(t,e)}set rotationZAngle(e){this.attributeSet("rotationZAngle"),this._rotationZAngle=e}get rotationZAngle(){var e=r.vAngle;let t=this._rotationZAngle;return void 0===t&&(t=this.getParentCell("rotationZAngle")),this.resolveCellValue(t,e)}set rounding(e){this.attributeSet("rounding"),this._rounding=e}get rounding(){var e=r.vLength;let t=this._rounding;return void 0===t&&(t=this.getParentCell("rounding")),this.resolveCellValue(t,e)}set routeStyle(e){this.attributeSet("routeStyle"),this._routeStyle=e}get routeStyle(){var e=r.PtgByte;let t=this._routeStyle;return void 0===t&&(t=this.getParentCell("routeStyle")),this.resolveCellValue(t,e)}set scaleX(e){this.attributeSet("scaleX"),this._scaleX=e}get scaleX(){var e=r.vScalar;let t=this._scaleX;return void 0===t&&(t=this.getParentCell("scaleX")),this.resolveCellValue(t,e)}set scaleY(e){this.attributeSet("scaleY"),this._scaleY=e}get scaleY(){var e=r.vScalar;let t=this._scaleY;return void 0===t&&(t=this.getParentCell("scaleY")),this.resolveCellValue(t,e)}set selectMode(e){this.attributeSet("selectMode"),this._selectMode=e}get selectMode(){var e=r.PtgByte;let t=this._selectMode;return void 0===t&&(t=this.getParentCell("selectMode")),this.resolveCellValue(t,e)}set shapeFixedCode(e){this.attributeSet("shapeFixedCode"),this._shapeFixedCode=e}get shapeFixedCode(){var e=r.PtgByte;let t=this._shapeFixedCode;return void 0===t&&(t=this.getParentCell("shapeFixedCode")),this.resolveCellValue(t,e)}set shapeKeywords(e){this.attributeSet("shapeKeywords"),this._shapeKeywords=e}get shapeKeywords(){var e=r.PtgString;let t=this._shapeKeywords;return void 0===t&&(t=this.getParentCell("shapeKeywords")),this.resolveCellValue(t,e)}set shapePermeablePlace(e){this.attributeSet("shapePermeablePlace"),this._shapePermeablePlace=e}get shapePermeablePlace(){var e=r.PtgBool;let t=this._shapePermeablePlace;return void 0===t&&(t=this.getParentCell("shapePermeablePlace")),this.resolveCellValue(t,e)}set shapePermeableX(e){this.attributeSet("shapePermeableX"),this._shapePermeableX=e}get shapePermeableX(){var e=r.PtgBool;let t=this._shapePermeableX;return void 0===t&&(t=this.getParentCell("shapePermeableX")),this.resolveCellValue(t,e)}set shapePermeableY(e){this.attributeSet("shapePermeableY"),this._shapePermeableY=e}get shapePermeableY(){var e=r.PtgBool;let t=this._shapePermeableY;return void 0===t&&(t=this.getParentCell("shapePermeableY")),this.resolveCellValue(t,e)}set shapePlaceFlip(e){this.attributeSet("shapePlaceFlip"),this._shapePlaceFlip=e}get shapePlaceFlip(){var e=r.PtgByte;let t=this._shapePlaceFlip;return void 0===t&&(t=this.getParentCell("shapePlaceFlip")),this.resolveCellValue(t,e)}set shapePlaceStyle(e){this.attributeSet("shapePlaceStyle"),this._shapePlaceStyle=e}get shapePlaceStyle(){var e=r.PtgByte;let t=this._shapePlaceStyle;return void 0===t&&(t=this.getParentCell("shapePlaceStyle")),this.resolveCellValue(t,e)}set shapePlowCode(e){this.attributeSet("shapePlowCode"),this._shapePlowCode=e}get shapePlowCode(){var e=r.PtgByte;let t=this._shapePlowCode;return void 0===t&&(t=this.getParentCell("shapePlowCode")),this.resolveCellValue(t,e)}set shapeRouteStyle(e){this.attributeSet("shapeRouteStyle"),this._shapeRouteStyle=e}get shapeRouteStyle(){var e=r.PtgByte;let t=this._shapeRouteStyle;return void 0===t&&(t=this.getParentCell("shapeRouteStyle")),this.resolveCellValue(t,e)}set shapeShdwBlur(e){this.attributeSet("shapeShdwBlur"),this._shapeShdwBlur=e}get shapeShdwBlur(){var e=r.vLength;let t=this._shapeShdwBlur;return void 0===t&&(t=this.getParentCell("shapeShdwBlur")),this.resolveCellValue(t,e)}set shapeShdwObliqueAngle(e){this.attributeSet("shapeShdwObliqueAngle"),this._shapeShdwObliqueAngle=e}get shapeShdwObliqueAngle(){var e=r.vAngle;let t=this._shapeShdwObliqueAngle;return void 0===t&&(t=this.getParentCell("shapeShdwObliqueAngle")),this.resolveCellValue(t,e)}set shapeShdwOffsetX(e){this.attributeSet("shapeShdwOffsetX"),this._shapeShdwOffsetX=e}get shapeShdwOffsetX(){var e=r.vLength;let t=this._shapeShdwOffsetX;return void 0===t&&(t=this.getParentCell("shapeShdwOffsetX")),this.resolveCellValue(t,e)}set shapeShdwOffsetY(e){this.attributeSet("shapeShdwOffsetY"),this._shapeShdwOffsetY=e}get shapeShdwOffsetY(){var e=r.vLength;let t=this._shapeShdwOffsetY;return void 0===t&&(t=this.getParentCell("shapeShdwOffsetY")),this.resolveCellValue(t,e)}set shapeShdwScaleFactor(e){this.attributeSet("shapeShdwScaleFactor"),this._shapeShdwScaleFactor=e}get shapeShdwScaleFactor(){var e=r.vScalar;let t=this._shapeShdwScaleFactor;return void 0===t&&(t=this.getParentCell("shapeShdwScaleFactor")),this.resolveCellValue(t,e)}set shapeShdwShow(e){this.attributeSet("shapeShdwShow"),this._shapeShdwShow=e}get shapeShdwShow(){var e=r.PtgByte;let t=this._shapeShdwShow;return void 0===t&&(t=this.getParentCell("shapeShdwShow")),this.resolveCellValue(t,e)}set shapeShdwType(e){this.attributeSet("shapeShdwType"),this._shapeShdwType=e}get shapeShdwType(){var e=r.PtgByte;let t=this._shapeShdwType;return void 0===t&&(t=this.getParentCell("shapeShdwType")),this.resolveCellValue(t,e)}set shapeSplit(e){this.attributeSet("shapeSplit"),this._shapeSplit=e}get shapeSplit(){var e=r.PtgByte;let t=this._shapeSplit;return void 0===t&&(t=this.getParentCell("shapeSplit")),this.resolveCellValue(t,e)}set shapeSplittable(e){this.attributeSet("shapeSplittable"),this._shapeSplittable=e}get shapeSplittable(){var e=r.PtgByte;let t=this._shapeSplittable;return void 0===t&&(t=this.getParentCell("shapeSplittable")),this.resolveCellValue(t,e)}set sharpen(e){this.attributeSet("sharpen"),this._sharpen=e}get sharpen(){var e=r.vScalar;let t=this._sharpen;return void 0===t&&(t=this.getParentCell("sharpen")),this.resolveCellValue(t,e)}set shdwForegnd(e){this.attributeSet("shdwForegnd"),this._shdwForegnd=e}get shdwForegnd(){var e=r.vColor;let t=this._shdwForegnd;return void 0===t&&(t=this.getParentCell("shdwForegnd")),this.resolveCellValue(t,e)}set shdwForegndTrans(e){this.attributeSet("shdwForegndTrans"),this._shdwForegndTrans=e}get shdwForegndTrans(){var e=r.vScalar;let t=this._shdwForegndTrans;return void 0===t&&(t=this.getParentCell("shdwForegndTrans")),this.resolveCellValue(t,e)}set shdwObliqueAngle(e){this.attributeSet("shdwObliqueAngle"),this._shdwObliqueAngle=e}get shdwObliqueAngle(){var e=r.vScalar;let t=this._shdwObliqueAngle;return void 0===t&&(t=this.getParentCell("shdwObliqueAngle")),this.resolveCellValue(t,e)}set shdwOffsetX(e){this.attributeSet("shdwOffsetX"),this._shdwOffsetX=e}get shdwOffsetX(){var e=r.vLength;let t=this._shdwOffsetX;return void 0===t&&(t=this.getParentCell("shdwOffsetX")),this.resolveCellValue(t,e)}set shdwOffsetY(e){this.attributeSet("shdwOffsetY"),this._shdwOffsetY=e}get shdwOffsetY(){var e=r.vLength;let t=this._shdwOffsetY;return void 0===t&&(t=this.getParentCell("shdwOffsetY")),this.resolveCellValue(t,e)}set shdwPattern(e){this.attributeSet("shdwPattern"),this._shdwPattern=e}get shdwPattern(){var e=r.PtgByte;let t=this._shdwPattern;return void 0===t&&(t=this.getParentCell("shdwPattern")),this.resolveCellValue(t,e)}set shdwScaleFactor(e){this.attributeSet("shdwScaleFactor"),this._shdwScaleFactor=e}get shdwScaleFactor(){var e=r.vScalar;let t=this._shdwScaleFactor;return void 0===t&&(t=this.getParentCell("shdwScaleFactor")),this.resolveCellValue(t,e)}set shdwType(e){this.attributeSet("shdwType"),this._shdwType=e}get shdwType(){var e=r.PtgByte;let t=this._shdwType;return void 0===t&&(t=this.getParentCell("shdwType")),this.resolveCellValue(t,e)}set size(e){this.attributeSet("size"),this._size=e}get size(){var e=r.vLength;let t=this._size;return void 0===t&&(t=this.getParentCell("size")),this.resolveCellValue(t,e)}set sketchAmount(e){this.attributeSet("sketchAmount"),this._sketchAmount=e}get sketchAmount(){var e=r.PtgInt;let t=this._sketchAmount;return void 0===t&&(t=this.getParentCell("sketchAmount")),this.resolveCellValue(t,e)}set sketchEnabled(e){this.attributeSet("sketchEnabled"),this._sketchEnabled=e}get sketchEnabled(){var e=r.PtgBool;let t=this._sketchEnabled;return void 0===t&&(t=this.getParentCell("sketchEnabled")),this.resolveCellValue(t,e)}set sketchFillChange(e){this.attributeSet("sketchFillChange"),this._sketchFillChange=e}get sketchFillChange(){var e=r.vScalar;let t=this._sketchFillChange;return void 0===t&&(t=this.getParentCell("sketchFillChange")),this.resolveCellValue(t,e)}set sketchLineChange(e){this.attributeSet("sketchLineChange"),this._sketchLineChange=e}get sketchLineChange(){var e=r.vScalar;let t=this._sketchLineChange;return void 0===t&&(t=this.getParentCell("sketchLineChange")),this.resolveCellValue(t,e)}set sketchLineWeight(e){this.attributeSet("sketchLineWeight"),this._sketchLineWeight=e}get sketchLineWeight(){var e=r.vLength;let t=this._sketchLineWeight;return void 0===t&&(t=this.getParentCell("sketchLineWeight")),this.resolveCellValue(t,e)}set sketchSeed(e){this.attributeSet("sketchSeed"),this._sketchSeed=e}get sketchSeed(){var e=r.PtgInt;let t=this._sketchSeed;return void 0===t&&(t=this.getParentCell("sketchSeed")),this.resolveCellValue(t,e)}set snap(e){this.attributeSet("snap"),this._snap=e}get snap(){var e=r.PtgBool;let t=this._snap;return void 0===t&&(t=this.getParentCell("snap")),this.resolveCellValue(t,e)}set softEdgesSize(e){this.attributeSet("softEdgesSize"),this._softEdgesSize=e}get softEdgesSize(){var e=r.vLength;let t=this._softEdgesSize;return void 0===t&&(t=this.getParentCell("softEdgesSize")),this.resolveCellValue(t,e)}set sortKey(e){this.attributeSet("sortKey"),this._sortKey=e}get sortKey(){var e=r.PtgString;let t=this._sortKey;return void 0===t&&(t=this.getParentCell("sortKey")),this.resolveCellValue(t,e)}set spAfter(e){this.attributeSet("spAfter"),this._spAfter=e}get spAfter(){var e=r.vLength;let t=this._spAfter;return void 0===t&&(t=this.getParentCell("spAfter")),this.resolveCellValue(t,e)}set spBefore(e){this.attributeSet("spBefore"),this._spBefore=e}get spBefore(){var e=r.vLength;let t=this._spBefore;return void 0===t&&(t=this.getParentCell("spBefore")),this.resolveCellValue(t,e)}set spLine(e){this.attributeSet("spLine"),this._spLine=e}get spLine(){var e=r.vLength;let t=this._spLine;return void 0===t&&(t=this.getParentCell("spLine")),this.resolveCellValue(t,e)}set status(e){this.attributeSet("status"),this._status=e}get status(){var e=r.PtgByte;let t=this._status;return void 0===t&&(t=this.getParentCell("status")),this.resolveCellValue(t,e)}set strikethru(e){this.attributeSet("strikethru"),this._strikethru=e}get strikethru(){var e=r.PtgBool;let t=this._strikethru;return void 0===t&&(t=this.getParentCell("strikethru")),this.resolveCellValue(t,e)}set style(e){this.attributeSet("style"),this._style=e}get style(){var e=r.PtgByte;let t=this._style;return void 0===t&&(t=this.getParentCell("style")),this.resolveCellValue(t,e)}set subAddress(e){this.attributeSet("subAddress"),this._subAddress=e}get subAddress(){var e=r.PtgString;let t=this._subAddress;return void 0===t&&(t=this.getParentCell("subAddress")),this.resolveCellValue(t,e)}set tagName(e){this.attributeSet("tagName"),this._tagName=e}get tagName(){var e=r.PtgString;let t=this._tagName;return void 0===t&&(t=this.getParentCell("tagName")),this.resolveCellValue(t,e)}set textBkgnd(e){this.attributeSet("textBkgnd"),this._textBkgnd=e}get textBkgnd(){var e=r.PtgColorRGB;let t=this._textBkgnd;return void 0===(t=void 0===t?this.getParentCell("textBkgnd"):t)&&(t=this.getStylesheetTextStyleCell("textBkgnd")),this.resolveCellValue(t,e)}set textBkgndTrans(e){this.attributeSet("textBkgndTrans"),this._textBkgndTrans=e}get textBkgndTrans(){var e=r.vScalar;let t=this._textBkgndTrans;return void 0===(t=void 0===t?this.getParentCell("textBkgndTrans"):t)&&(t=this.getStylesheetTextStyleCell("textBkgndTrans")),this.resolveCellValue(t,e)}set textDirection(e){this.attributeSet("textDirection"),this._textDirection=e}get textDirection(){var e=r.vScalar;let t=this._textDirection;return void 0===t&&(t=this.getParentCell("textDirection")),this.resolveCellValue(t,e)}set textPosAfterBullet(e){this.attributeSet("textPosAfterBullet"),this._textPosAfterBullet=e}get textPosAfterBullet(){var e=r.vLength;let t=this._textPosAfterBullet;return void 0===t&&(t=this.getParentCell("textPosAfterBullet")),this.resolveCellValue(t,e)}set theData(e){this.attributeSet("theData"),this._theData=e}get theData(){var e=r.vScalar;let t=this._theData;return void 0===t&&(t=this.getParentCell("theData")),this.resolveCellValue(t,e)}set themeIndex(e){this.attributeSet("themeIndex"),this._themeIndex=e}get themeIndex(){var e=r.PtgInt;let t=this._themeIndex;return void 0===t&&(t=this.getParentCell("themeIndex")),this.resolveCellValue(t,e)}set theText(e){this.attributeSet("theText"),this._theText=e}get theText(){var e=r.vScalar;let t=this._theText;return void 0===t&&(t=this.getParentCell("theText")),this.resolveCellValue(t,e)}set topMargin(e){this.attributeSet("topMargin"),this._topMargin=e}get topMargin(){var e=r.vLength;let t=this._topMargin;return void 0===(t=void 0===t?this.getParentCell("topMargin"):t)&&(t=this.getStylesheetTextStyleCell("topMargin")),this.resolveCellValue(t,e)}set transparency(e){this.attributeSet("transparency"),this._transparency=e}get transparency(){var e=r.vScalar;let t=this._transparency;return void 0===t&&(t=this.getParentCell("transparency")),this.resolveCellValue(t,e)}set txtAngle(e){this.attributeSet("txtAngle"),this._txtAngle=e}get txtAngle(){let e=this._txtAngle;void 0===e&&(e=this.getParentCell("txtAngle"));var t=r.vAngle;return W.log('resolve cell type "txtAngle"'),e&&"0"!==e.value&&e.units&&e.units!==h.DEG&&W.log("txtAngle unclear"),this.resolveCellValue(e,t)}set txtHeight(e){this.attributeSet("txtHeight"),this._txtHeight=e}get txtHeight(){var e=r.vLength;let t=this._txtHeight;return void 0===t&&(t=this.getParentCell("txtHeight")),this.resolveCellValue(t,e)}set txtLocPinX(e){this.attributeSet("txtLocPinX"),this._txtLocPinX=e}get txtLocPinX(){var e=r.vLength;let t=this._txtLocPinX;return void 0===t&&(t=this.getParentCell("txtLocPinX")),this.resolveCellValue(t,e)}set txtLocPinY(e){this.attributeSet("txtLocPinY"),this._txtLocPinY=e}get txtLocPinY(){var e=r.vLength;let t=this._txtLocPinY;return void 0===t&&(t=this.getParentCell("txtLocPinY")),this.resolveCellValue(t,e)}set txtPinX(e){this.attributeSet("txtPinX"),this._txtPinX=e}get txtPinX(){var e=r.vLength;let t=this._txtPinX;return void 0===t&&(t=this.getParentCell("txtPinX")),this.resolveCellValue(t,e)}set txtPinY(e){this.attributeSet("txtPinY"),this._txtPinY=e}get txtPinY(){var e=r.vLength;let t=this._txtPinY;return void 0===t&&(t=this.getParentCell("txtPinY")),this.resolveCellValue(t,e)}set txtWidth(e){this.attributeSet("txtWidth"),this._txtWidth=e}get txtWidth(){var e=r.vLength;let t=this._txtWidth;return void 0===t&&(t=this.getParentCell("txtWidth")),this.resolveCellValue(t,e)}set type(e){this.attributeSet("type"),this._type=e}get type(){var e=r.vScalar;let t=this._type;return void 0===t&&(t=this.getParentCell("type")),this.resolveCellValue(t,e)}set uICat(e){this.attributeSet("uICat"),this._uICat=e}get uICat(){var e=r.vScalar;let t=this._uICat;return void 0===t&&(t=this.getParentCell("uICat")),this.resolveCellValue(t,e)}set uICod(e){this.attributeSet("uICod"),this._uICod=e}get uICod(){var e=r.vScalar;let t=this._uICod;return void 0===t&&(t=this.getParentCell("uICod")),this.resolveCellValue(t,e)}set uIFmt(e){this.attributeSet("uIFmt"),this._uIFmt=e}get uIFmt(){var e=r.vScalar;let t=this._uIFmt;return void 0===t&&(t=this.getParentCell("uIFmt")),this.resolveCellValue(t,e)}set uIVisibility(e){this.attributeSet("uIVisibility"),this._uIVisibility=e}get uIVisibility(){var e=r.PtgBool;let t=this._uIVisibility;return void 0===t&&(t=this.getParentCell("uIVisibility")),this.resolveCellValue(t,e)}set updateAlignBox(e){this.attributeSet("updateAlignBox"),this._updateAlignBox=e}get updateAlignBox(){var e=r.PtgBool;let t=this._updateAlignBox;return void 0===t&&(t=this.getParentCell("updateAlignBox")),this.resolveCellValue(t,e)}set useGroupGradient(e){this.attributeSet("useGroupGradient"),this._useGroupGradient=e}get useGroupGradient(){var e=r.PtgBool;let t=this._useGroupGradient;return void 0===t&&(t=this.getParentCell("useGroupGradient")),this.resolveCellValue(t,e)}set value(e){this.attributeSet("value"),this._value=e}get value(){var e=r.vAny;let t=this._value;return void 0===t&&(t=this.getParentCell("value")),this.resolveCellValue(t,e)}set variationColorIndex(e){this.attributeSet("variationColorIndex"),this._variationColorIndex=e}get variationColorIndex(){var e=r.PtgInt;let t=this._variationColorIndex;return void 0===t&&(t=this.getParentCell("variationColorIndex")),this.resolveCellValue(t,e)}set variationStyleIndex(e){this.attributeSet("variationStyleIndex"),this._variationStyleIndex=e}get variationStyleIndex(){var e=r.PtgInt;let t=this._variationStyleIndex;return void 0===t&&(t=this.getParentCell("variationStyleIndex")),this.resolveCellValue(t,e)}set verify(e){this.attributeSet("verify"),this._verify=e}get verify(){var e=r.PtgBool;let t=this._verify;return void 0===t&&(t=this.getParentCell("verify")),this.resolveCellValue(t,e)}set verticalAlign(e){this.attributeSet("verticalAlign"),this._verticalAlign=e}get verticalAlign(){var e=r.vScalar;let t=this._verticalAlign;return void 0===(t=void 0===t?this.getParentCell("verticalAlign"):t)&&(t=this.getStylesheetTextStyleCell("verticalAlign")),this.resolveCellValue(t,e)}set viewMarkup(e){this.attributeSet("viewMarkup"),this._viewMarkup=e}get viewMarkup(){var e=r.PtgBool;let t=this._viewMarkup;return void 0===t&&(t=this.getParentCell("viewMarkup")),this.resolveCellValue(t,e)}set visible(e){this.attributeSet("visible"),this._visible=e}get visible(){var e=r.PtgBool;let t=this._visible;return void 0===t&&(t=this.getParentCell("visible")),this.resolveCellValue(t,e)}set walkPreference(e){this.attributeSet("walkPreference"),this._walkPreference=e}get walkPreference(){var e=r.PtgByte;let t=this._walkPreference;return void 0===t&&(t=this.getParentCell("walkPreference")),this.resolveCellValue(t,e)}set width(e){this.attributeSet("width"),this._width=e}get width(){var e=r.vLength;let t=this._width;return void 0===t&&(t=this.getParentCell("width")),this.resolveCellValue(t,e)}set x(e){this.attributeSet("x"),this._x=e}get x(){let e;if(this.isDescendantOfSectionType([Y.Control,Y.Scratch,Y.ActionTag,Y.Connection]))e=r.vLength;else switch(this.getRowType()){case D.ArcTo:case D.Ellipse:case D.EllipticalArcTo:case D.InfiniteLine:case D.LineTo:case D.MoveTo:case D.NURBSTo:case D.PolylineTo:case D.SplineKnot:case D.SplineStart:e=r.vLength;break;case D.RelCubBezTo:case D.RelEllipticalArcTo:case D.RelLineTo:case D.RelMoveTo:case D.RelQuadBezTo:e=r.vScalar;break;default:W.log("Incorrect cell type",{attributeName:"x",cells:this,rowType:this.getRowType()})}let t=this._x;return void 0===t&&(t=this.getParentCell("x")),this.resolveCellValue(t,e)}set xCon(e){this.attributeSet("xCon"),this._xCon=e}get xCon(){var e=r.PtgByte;let t=this._xCon;return void 0===t&&(t=this.getParentCell("xCon")),this.resolveCellValue(t,e)}set xDyn(e){this.attributeSet("xDyn"),this._xDyn=e}get xDyn(){var e=r.vLength;let t=this._xDyn;return void 0===t&&(t=this.getParentCell("xDyn")),this.resolveCellValue(t,e)}set xGridDensity(e){this.attributeSet("xGridDensity"),this._xGridDensity=e}get xGridDensity(){var e=r.PtgByte;let t=this._xGridDensity;return void 0===t&&(t=this.getParentCell("xGridDensity")),this.resolveCellValue(t,e)}set xGridOrigin(e){this.attributeSet("xGridOrigin"),this._xGridOrigin=e}get xGridOrigin(){var e=r.vLength;let t=this._xGridOrigin;return void 0===t&&(t=this.getParentCell("xGridOrigin")),this.resolveCellValue(t,e)}set xGridSpacing(e){this.attributeSet("xGridSpacing"),this._xGridSpacing=e}get xGridSpacing(){var e=r.vLength;let t=this._xGridSpacing;return void 0===t&&(t=this.getParentCell("xGridSpacing")),this.resolveCellValue(t,e)}set xJustify(e){this.attributeSet("xJustify"),this._xJustify=e}get xJustify(){var e=r.PtgByte;let t=this._xJustify;return void 0===t&&(t=this.getParentCell("xJustify")),this.resolveCellValue(t,e)}set xRulerDensity(e){this.attributeSet("xRulerDensity"),this._xRulerDensity=e}get xRulerDensity(){var e=r.PtgByte;let t=this._xRulerDensity;return void 0===t&&(t=this.getParentCell("xRulerDensity")),this.resolveCellValue(t,e)}set xRulerOrigin(e){this.attributeSet("xRulerOrigin"),this._xRulerOrigin=e}get xRulerOrigin(){var e=r.vLength;let t=this._xRulerOrigin;return void 0===t&&(t=this.getParentCell("xRulerOrigin")),this.resolveCellValue(t,e)}set y(e){this.attributeSet("y"),this._y=e}get y(){let e;if(this.isDescendantOfSectionType([Y.Control,Y.Scratch,Y.ActionTag,Y.Connection]))e=r.vLength;else switch(this.getRowType()){case D.ArcTo:case D.Ellipse:case D.EllipticalArcTo:case D.InfiniteLine:case D.LineTo:case D.MoveTo:case D.NURBSTo:case D.PolylineTo:case D.SplineKnot:case D.SplineStart:e=r.vLength;break;case D.RelCubBezTo:case D.RelEllipticalArcTo:case D.RelLineTo:case D.RelMoveTo:case D.RelQuadBezTo:e=r.vScalar;break;default:W.log("Incorrect cell type",{attributeName:"a",cells:this})}let t=this._y;return void 0===t&&(t=this.getParentCell("y")),this.resolveCellValue(t,e)}set yCon(e){this.attributeSet("yCon"),this._yCon=e}get yCon(){var e=r.PtgByte;let t=this._yCon;return void 0===t&&(t=this.getParentCell("yCon")),this.resolveCellValue(t,e)}set yDyn(e){this.attributeSet("yDyn"),this._yDyn=e}get yDyn(){var e=r.vLength;let t=this._yDyn;return void 0===t&&(t=this.getParentCell("yDyn")),this.resolveCellValue(t,e)}set yGridDensity(e){this.attributeSet("yGridDensity"),this._yGridDensity=e}get yGridDensity(){var e=r.PtgByte;let t=this._yGridDensity;return void 0===t&&(t=this.getParentCell("yGridDensity")),this.resolveCellValue(t,e)}set yGridOrigin(e){this.attributeSet("yGridOrigin"),this._yGridOrigin=e}get yGridOrigin(){var e=r.vLength;let t=this._yGridOrigin;return void 0===t&&(t=this.getParentCell("yGridOrigin")),this.resolveCellValue(t,e)}set yGridSpacing(e){this.attributeSet("yGridSpacing"),this._yGridSpacing=e}get yGridSpacing(){var e=r.vLength;let t=this._yGridSpacing;return void 0===t&&(t=this.getParentCell("yGridSpacing")),this.resolveCellValue(t,e)}set yJustify(e){this.attributeSet("yJustify"),this._yJustify=e}get yJustify(){var e=r.PtgByte;let t=this._yJustify;return void 0===t&&(t=this.getParentCell("yJustify")),this.resolveCellValue(t,e)}set yRulerDensity(e){this.attributeSet("yRulerDensity"),this._yRulerDensity=e}get yRulerDensity(){var e=r.PtgByte;let t=this._yRulerDensity;return void 0===t&&(t=this.getParentCell("yRulerDensity")),this.resolveCellValue(t,e)}set yRulerOrigin(e){this.attributeSet("yRulerOrigin"),this._yRulerOrigin=e}get yRulerOrigin(){var e=r.vLength;let t=this._yRulerOrigin;return void 0===t&&(t=this.getParentCell("yRulerOrigin")),this.resolveCellValue(t,e)}}let tt=["MoveTo","RelMoveTo","LineTo","RelLineTo","ArcTo","InfiniteLine","Ellipse","EllipticalArcTo","RelEllipticalArcTo","SplineStart","SplineKnow","PolylineTo","NURBSTo","RelCubBezTo","RelQuadBezTo"];class it extends Pe{constructor(e){let{...t}=e;super(t);var{cells:e=new et({archive:this.archive})}=t;this.cells=e,this.debugType=t.debugType,this.jxon=t.jxon,t.type&&(this.type=t.type),t.debugType===p.Named?this.name=t.name:this.index=t.index}set type(e){tt.includes(e)&&this.jxon&&(this.jxon[q.Type]=e),this._type=e}get type(){return this._type}}let rt={Geometry:["NoFill","NoLine","NoShow","NoSnap","NoQuickDrag"]},lt={Actions:["Menu","Action","Checked","Disabled","ReadOnly","Invisible","BeginGroup","FlyoutChild","TagName","ButtonFace","SortKey"],Character:["Font","Color","Style","Case","Pos","FontScale","Size","DblUnderline","Overline","Strikethru","DoubleStrikethrough","Letterspace","ColorTrans","AsianFont","ComplexScriptFont","ComplexScriptSize","LangID"],Connection:["X","Y","DirX","DirY","Type","AutoGen","Prompt"],Control:["X","Y","XDyn","YDyn","XCon","YCon","CanGlue","Prompt"],Field:["Value","Format","Type","UICat","UICod","UIFmt","Calendar","ObjectKind"],FillGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Geometry:["X","Y","A","B","C","D","E"],Hyperlink:["Description","Address","SubAddress","ExtraInfo","Frame","NewWindow","Default","Invisible","SortKey"],Layer:["Name","Color","Status","Visible","Print","Active","Lock","Snap","Glue","NameUniv","ColorTrans"],LineGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Paragraph:["IndFirst","IndLeft","IndRight","SpLine","SpBefore","SpAfter","HorzAlign","Bullet","BulletStr","BulletFont","BulletFontSize","TextPosAfterBullet","Flags"],Property:["Value","Prompt","Label","Format","SortKey","Type","Invisible","Verify","DataLinked","LangID","Calendar"],Reviewer:["Name","Initials","Color","ReviewerID","CurrentIndex"],Scratch:["X","Y","A","B","C","D"],ActionTag:["X","Y","TagName","XJustify","YJustify","DisplayMode","ButtonFace","Disabled","Description"],Tabs:["Position","Alignment"],User:["Value","Prompt"]};class at extends Ce{constructor(t){super(t);var{rows:e=[],cells:i=new et({archive:this.archive})}=t;this.cells=i,this.rows=e.map(e=>new it({...e,archive:t.archive}))}getRows(){var e=this.rows;return e||[]}getRow(){}addRow(){}removeRow(){}static from(e){return new(e.type===Y.Geometry?ht:e.type===Y.Property||e.type===Y.User?ot:Z[e.type]===p.Indexed?st:nt)(e)}}class st extends at{getRow(e){e=this.rows[e];return e||null}addRow(){var e=this.rows.map(e=>e.index).sort().pop(),e=Number.isInteger(e)?e+1:1,t={[U.Id]:e.toString(),Cell:[]};let i=new it({debugType:p.Indexed,index:e,jxon:t,archive:this.archive});return lt[this.type].forEach(e=>i.setCell(e,{value:""})),this.jxon.Row.push(i.jxon),this.rows.push(i),i}removeRow(e){return this.rows.splice(e,1),this.jxon.Row.splice(e,1),this.rows}}class nt extends at{getRow(t){var e=this.rows.find(e=>e.name===t);return e||null}addRow(t){if(-1<this.rows.findIndex(e=>e.name===t))throw new Error(`Row named "${t}" already exists.`);var e={[U.Name]:t,Cell:[]};let i=new it({name:t,jxon:e,debugType:p.Named,archive:this.archive});return lt[this.type].forEach(e=>i.setCell(e,{value:""})),this.jxon.Row.push(i.jxon),this.rows.push(i),i}removeRow(t){return this.rows=this.rows.filter(e=>e.name!==t),this.jxon.Row=this.jxon.Row.filter(e=>e["@N"]!==t),this.rows}}class ot extends nt{getProperty(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"value",e=this.getRow(e);return e?e.cells[t]:null}getPropertyNames(){return this.rows.map(e=>e.name)}}class ht extends st{constructor(e){super(e),e.cells?this.cells=e.cells:(this.cells=new et({archive:this.archive}),this.jxon.Cell=[],rt.Geometry.forEach(e=>{var t=fe(e);this.cells.has(t)||this.cells["_"+t]||this.setCell(e,{value:""})}))}getOwnCellNames(){return Pe.prototype.getOwnCellNames.call(this)}getCell(e){return Pe.prototype.getCell.call(this,e)}setCell(e,t){rt.Geometry.includes(e)?Pe.prototype.setCell.call(this,e,t):W.log(`Cannot add ${e} cell to Geometry section.`)}removeCell(e){Pe.prototype.removeCell.call(this,e)}toPath(e,t){var{rows:i=[]}=this,i=me({rows:i},{width:e,height:t}),i=z.V.normalizePathData(i),r=new z.g.Path(i);let l=r.segments.length;for(;2<l&&r.segments[l-1].end.equals(r.segments[l-2].end);)r.removeSegment(l-2),l--;return r.translate(0,-t).scale(1,-1),r}addRow(e){var t=super.addRow();let i=e;return i=i||(1===this.getRows().length?D.RelMoveTo:D.RelLineTo),t.type=i,t}}function ut(e){var t=/^rId(\d+)$/;return t.test(e)||W.log("incorrect format of relationship to master",e),te(e.match(t)[1])}function gt(e){var t;return t=e,1!==Object.keys(t).length&&W.log("Rel should have one attribute",t),ut(e[$.RelId])}function ct(e,t){dt(e)||(e.content=[]),e.content.push(t)}function dt(e){return Array.isArray(e.content)}function pt(e,t){var{characterPropertiesIndex:t,paragraphPropertiesIndex:i,tabsPropertiesIndex:r}=t,l={};return null!==t&&(l.characterPropertiesIndex=t),null!==i&&(l.paragraphPropertiesIndex=i),null!==r&&(l.tabsPropertiesIndex=r),e.push(l),l}function vt(e,r){return r||W.log("path not defined"),b(e).reduce((e,t)=>{"object"!=typeof(i=t)&&W.log("Cell is not object.",i),[s.Name].forEach(e=>{i.hasOwnProperty(e)||W.log('Cell required key "${key}" missing.',i)});var i,t=function(e,t){var i=(e=>e[s.Name])(e);y.hasOwnProperty(i)||W.log("unknown cell attribute name",i);return{name:(e=>"Case"===e?"uppercase":fe(e))(i),value:(e=>{var t=s.Value;return t in e?e[t]:e.keyValue})(e),formula:(e=>e[s.Formula])(e)||null,units:(e=>e[s.Units])(e)}}.call(this,t,r);return e[t.name]=t,e},{})}function St(e,t){return function(r,e,t){e=1<arguments.length&&void 0!==e?e:{};let l=2<arguments.length&&void 0!==t?t:null;return Object.entries(r).filter(e=>{var[e,,]=e;return"@"!==e[0]}).reduce((e,t)=>{var[t,i]=t,t=ke(t,l),i=(e.hasOwnProperty(t)&&W.log("keys collision "+t,r),i.hasOwnProperty("keyValue")?i.keyValue:null);return e[t]=_e(t,i),e},e)}(e,Te(e,g.DocumentSettings,t))}function mt(r,e){t=r,1!==Object.keys(t).length&&W.log("DocumentColor should have one attribute",{documentColorJxon:t}),(t=new Map).set(0,"#000000"),t.set(1,"#FFFFFF"),t.set(2,"#FF0000"),t.set(3,"#00FF00"),t.set(4,"#0000FF"),t.set(5,"#FFFF00"),t.set(6,"#FF00FF"),t.set(7,"#00FFFF"),t.set(8,"#800000"),t.set(9,"#008000"),t.set(10,"#000080"),t.set(11,"#808000"),t.set(12,"#800080"),t.set(13,"#008080"),t.set(14,"#C0C0C0"),t.set(15,"#E6E6E6"),t.set(16,"#CDCDCD"),t.set(17,"#B3B3B3"),t.set(18,"#9A9A9A"),t.set(19,"#808080"),t.set(20,"#666666"),t.set(21,"#4D4D4D"),t.set(22,"#333333"),t.set(23,"#1A1A1A");var t;return b(r[d.ColorEntry]).reduce((e,t)=>{i=t,2!==Object.keys(i).length&&W.log("documentColorEntryRgbJxon should have two attributes",{documentColorEntryRgbJxon:i});var i=t[d.Ix],t=t[d.Rgb];return e.has(i)&&W.log("Color override",{colorsJxon:r}),e.set(i,t),e},t)}function Ct(e){var{endArrow:e,endArrowSize:t,beginArrow:i,beginArrowSize:r,lineWeight:l}=e,a={};return a.sourceMarker=i?ft(i,r,l):null,a.targetMarker=e?ft(e,t,l):null,a}function ft(e,t,i){t=1<arguments.length&&void 0!==t?t:0,i=2<arguments.length?i:void 0;let r="#000000",l="#000000";e=(e=>{switch(e){case 0:return null;case 1:return{d:"M 1 -1 L 0 0 L 1 1",type:"stroke"};case 2:return{d:"M 1 1 L 0 0 L 1 -1 L 1 1",type:"fill"};case 3:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 4:return{d:"M 2 -1 0 0 2 1 Z",type:"fill"};case 5:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67173 -0.364515 1.67301 0.372641 1.98465 1.00043",type:"fill"};case 6:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"fill"};case 7:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452",type:"stroke"};case 8:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452 C 1.67173 0.364515 1.67301 -0.372641 1.84309 -0.959455",type:"fill"};case 9:return{d:"M -1 -1 0 0 1 1",type:"stroke"};case 10:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"fill"};case 11:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"fill"};case 12:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 13:return{d:"M 3 -1 0 0 3 1 Z",type:"fill"};case 14:return{d:"M 3 -1 0 0 3 1 Z",type:"stroke-empty"};case 15:return{d:"M 1 -1 0 0 1 1 Z",type:"stroke-empty"};case 16:return{d:"M 2 -1 0 0 2 1 Z",type:"stroke-empty"};case 17:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67051 -0.362037 1.67309 0.378293 1.98815 1.00746",type:"stroke-empty"};case 18:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"stroke-empty"};case 19:return{d:"M 1.95144 1.125 C 1.55653 0.440984 1.54919 -0.400016 1.93211 -1.09082 L 1.92863 -1.09117 C 1.52903 -0.42613 0.815004 -0.013884 0.0392696 -0.000342899 L 0.0392671 0.000342659 C 0.815002 0.0138829 1.52903 0.426128 1.92863 1.09116",type:"stroke-empty"};case 20:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"stroke-empty"};case 21:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"stroke-empty"};case 22:return{d:"M 0 0 2 -1 4 0 2 1 z",type:"stroke-empty"};case 23:return{d:"M 2.5 -1 1.5 1",type:"stroke"};case 24:return{d:"M 1.5 -0.75 L 1.5 0.75",type:"stroke"};case 25:return{d:"M 1.5 -0.75 1.5 0.75 M 2.25 -0.75 2.25 0.75",type:"stroke"};case 26:return{d:"M 1.5 -0.75 L 1.5 0.75 M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke"};case 27:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75",type:"stroke"};case 28:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75 M 2 -0.75 L 2 0.75",type:"stroke"};case 29:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0 -0.75 L 1.5 0 L 0 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 30:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0.75 -0.75 L 0.75 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 31:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke-empty"};case 32:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke-empty"};case 33:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75 M 3.75 -0.75 L 3.75 0.75",type:"stroke-empty"};case 34:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 L 6 0 L 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 35:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke"};case 36:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 37:return{d:"",type:"fill"};case 38:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 M 3.75 -1.15 L 6 0 M 6 0 L 3.75 1.15 M 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 39:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"fill"};case 40:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"stroke-empty"};case 41:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z",type:"stroke-empty"};case 42:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 43:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1",type:"stroke"};case 44:return{d:"M 2 -1 L 0 0 L 2 1 M 3 0.75 L 3 -0.75",type:"stroke"};case 45:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1 M 5 0.75 L 5 -0.75",type:"stroke"}}})(e);if(!e)return null;let{d:a,type:s}=e;(a.includes("A")||a.includes("a"))&&(a=z.V.normalizePathData(a));e=new z.g.Path(a),t=(e=>{switch(e){case 0:return 3.253333333333325;case 1:return 3.7333333333333236;case 2:return 4.693333333333321;case 3:return 5.653333333333319;case 4:return 6.613333333333316;case 5:return 13.3333333333333;case 6:return 25.333333333333268;default:return 4.693333333333321}})(t);return e.scale(t,t),"stroke"===s&&(r="none"),"fill"===s&&(l="none"),"stroke-empty"===s&&(r="#ffffff"),{type:"path",d:e.serialize(),"stroke-width":i,fill:r,stroke:l}}function yt(e){switch(e){case 1:default:return"none";case 2:return"7 5";case 3:return"0 5";case 4:return"7 5 0 5";case 5:return"7 5 0 5 0 5";case 6:return"7 5 7 5 0 5";case 7:return"19 5 7 5";case 8:return"19 5 7 5 7 5";case 9:return"3 3";case 10:return"0 5";case 11:return"3 3 0 3";case 12:return"3 3 0 3 0 3";case 13:return"3 3 3 3 0 3";case 14:return"9 3 3 3";case 15:return"9 3 3 3 3 3";case 16:return"15 9";case 17:return"0 9";case 18:return"15 9 0 9";case 19:return"15 9 0 9 0 9";case 20:return"15 9 15 9 0 9";case 21:return"39 9 15 9";case 22:return"39 9 15 9 15 9";case 23:return"1 2"}}function Pt(e,t,i){var r=e.getShape(),l=(e=>{var[t]=e.getComputedGeometry();if(!t)return null;let{width:i,height:r,pageContent:l}=e,{locPinX:a,locPinY:s,angle:n,flipX:o,flipY:h}=e.cells;var[t]=t.toPath(i,r).toPolylines(),u=(t.simplify(),t.points);let g=o&&!h||h&&!o,c=(u.forEach(e=>{var t=a,i=s;e.translate(0,-r).scale(1,-1),n&&e.rotate({x:t,y:i},g?-n:n)}),t.scale(o?-1:1,h?-1:1,{x:a,y:s}),(t=e.getPageMatrix()).e),d=l.page.height-t.f;return u.map(e=>{var{x:e,y:t}=e;return{x:c+e,y:d-t}})})(r);if(!Array.isArray(l)||l.length<2)return null;var a={},{sourceMarker:s=null,targetMarker:n=null}=Ct(r.cells),{lineWeight:o=1,lineColor:h="#000000",linePattern:u="none"}=r.cells,s={line:{sourceMarker:s,targetMarker:n,stroke:h,strokeWidth:Math.max(o,1),strokeDasharray:yt(u)}},n=(r.getComputedGeometry().every(e=>e.cells.noShow)&&(s.line.visibility="hidden"),W.level&W.TOOLTIPS&&(s.root={title:""+e.tooltip}),a.attrs=s,l.shift());if(t){var{dx:h,dy:o}=xt(t,n);a.source={id:t.id,anchor:{name:"modelCenter",args:{dx:h,dy:o,rotate:!0}}}}else{if(e.getSource())return null;a.source=new z.g.Point(n.x,n.y).toJSON()}u=l.pop();if(i){var{dx:r,dy:s}=xt(i,u);a.target={id:i.id,anchor:{name:"modelCenter",args:{dx:r,dy:s,rotate:!0}}}}else{if(e.getTarget())return null;a.target=new z.g.Point(u.x,u.y).toJSON()}return a.vertices=l,a}function bt(e,t){var e=function e(t,i){let r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;let l=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;let a=i.id;if(t.has(a))return{shapeId:a,offsetX:r,offsetY:l};if(i.parent)return e(t,i.parent,r,l);return null}(t,e);return e?(e=e.shapeId,t.get(e)):(W.log("no nearestElement source"),null)}function xt(e,t){var t=1<arguments.length&&void 0!==t?t:{x:0,y:0},{x:i,y:r}=e.get("position"),{width:e,height:l}=e.get("size");return{dx:t.x-i-e/2,dy:t.y-r-l/2}}function wt(i){if(!z.util.isObject(i))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");var r=i.id||i.type+this.svg.id+z.util.hashCode(JSON.stringify(i));if(!this.isDefined(r)){var l=i.type;let e,t;switch(i.type){case"linearGradient":case"radialGradient":({gradientSVGString:e,gradientAttrs:t}=((e,t,i)=>{var{stops:r,rotate:l=0,scale:a="1 1",viewBox:s}=e;if(r)return r=`<${i}>\n                ${b(r).map(e=>{var{offset:e,color:t,opacity:i}=e;return`\n                    <stop\n                    offset="${e}"\n                    stop-color="${t}"\n                    stop-opacity="${i}"/>`}).join("")}\n                </${i}>`,i={id:t,gradientTransform:`rotate(${l}) scale(${a})`},s&&(i.viewBox=s),{gradientSVGString:r,gradientAttrs:z.util.assign(i,e.attrs)};throw new TypeError('dia.Paper: definePattern() requires "stops" attribute not empty.')})(i,r,l));break;default:W.log("Unknown Gradient",i)}z.V(e,t).appendTo(this.defs)}return r}let _t=z.dia.Element.define("visio.Element",{},{},{attributes:{filter:{qualify:z.util.isPlainObject,set:function(e){return`url(#${function(e){if(!z.util.isObject(e))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");let t=e.id;var i=e.name;if(t=t||i+this.svg.id+z.util.hashCode(JSON.stringify(e)),!this.isDefined(t)){var r=z.util.filter,r=r[i]&&r[i](e.args||{});if(!r)throw new Error("Non-existing filter "+i);i=z.util.assign({filterUnits:"userSpaceOnUse"},e.attrs,{id:t});z.V(r,i).appendTo(this.defs)}return t}.call(this.paper,e)})`}},fill:{qualify:z.util.isPlainObject,set:function(e){switch(e.type){case"linearGradient":case"radialGradient":return"url(#"+wt.call(this.paper,e)+")";case"pattern":return"url(#"+function(e){if(!z.util.isObject(e))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");var t=e.id||e.type+this.svg.id+z.util.hashCode(JSON.stringify(e));if(!this.isDefined(t)){var{d:i,backgroundColor:r="#ffffff",color:l="#000000",strokeWidth:a=1,x:s=0,y:n=0,width:o=10,height:h=10,patternUnits:u="userSpaceOnUse",strokeOpacity:g=1,fillOpacity:c=1,rotate:d=0,scale:p="1 1",viewBox:v="0 0 10 10"}=e;if(!i)throw new TypeError('dia.Paper: definePattern() requires "d" attribute not empty.');r=`<pattern>\n             <rect\n                width="100%"\n                height="100%"\n                fill-opacity="1"\n                fill="${r}"\n                ></rect>\n            <path\n                d="${i}"\n                stroke="${l}"\n                stroke-width="${a}"\n                stroke-opacity="${g}"\n                fill="${l}"\n                fill-opacity="${c}"\n                ></path>\n                </pattern>`,i=z.util.assign({id:t,patternUnits:u,x:s,y:n,width:o,height:h,patternTransform:`rotate(${d}) scale(${p})`,viewBox:v},e.attrs);z.V(r,i).appendTo(this.defs)}return t}.call(this.paper,e)+")"}}}}}),Tt=z.dia.Link.define("visio.Link",{attrs:{line:{connection:!0},wrapper:{connection:!0}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":10}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none","stroke-linejoin":"round","stroke-linecap":"round",stroke:"#333333"}}]},{});function kt(e,t){e=e.toElementAttributes(t);return e?new _t(e):null}function Lt(e,t,i,r){t=e.toLinkAttributes(t,i);return t?new Tt(t):kt(e.getShape(),r)}function Vt(e,t){e=e.toElementAttributes({noGeometry:!0});return[new _t(e)]}let At=["emf"];class Mt extends Ce{constructor(e){super(e,new Set([v.source,v.target]))}referencePageContent(e){this.pageContent=e}getShape(){return this.pageContent.getShape(this.shapeId)}getSource(){var e=this._source;return e?this.pageContent.getShape(e.shapeId):(e=this.getShape()).isRootShape()?null:e.getRootShape()}getTarget(){var e=this._target;return e?this.pageContent.getShape(e.shapeId):null}get tooltip(){var e=this.getShape();return`connectId: ${e.id} (shapeId)\n`+"type: "+e.type}toLinkAttributes(e,t){e=Pt(this,e,t);return e?(t=this.getShape(),e.z=t.getPageZIndex(),e):null}toLink(e){var t,i,{importConnect:r=Lt,ignoreNonPrinting:l=!0}=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"function"!=typeof r||(t=this.getShape(),l&&!t.isPrintable())?null:(t={ignoreNonPrinting:l},l=this.getSource(),i=this.getTarget(),r(this,l?bt(l,e):null,i?bt(i,e):null,t))}toLinkLabels(e){var{importLabels:t=Vt}=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return t(this.getShape(),e)}}function Ft(t,i){t=b(t[n.Connect]).map(e=>Te(e,n.Connect,i));{let r=new Map,e=(e=>{let i=new Map;return e.forEach(e=>{var t=e.fromSheet,t=(i.has(t)||i.set(t,{source:null,target:null}),i.get(t));"BeginX"===e.fromCell?(t.source&&W.log("source already set"),t.source={shapeId:e.toSheet,cell:e.toCell,part:e.toPart}):(t.target&&W.log("target already set"),t.target={shapeId:e.toSheet,cell:e.toCell,part:e.toPart})}),i})(t);return e.forEach((e,t)=>{var{source:e,target:i}=e;r.set(t,{shapeId:t,source:e||null,target:i||null})}),r}}class Dt{constructor(e){this._attributes={},void 0!==e&&this.setAttributes(e)}set(e,t){"archive"!==e&&(this._attributes[e]=t)}setAttributes(e){Object.entries(e).forEach(e=>{var[e,t]=e;return this.set(e,t)})}get attributes(){return this._attributes}get isDummyResult(){return!0}}let Bt={"http://schemas.iaresearch.com/JCVGantt":!0},It={ElementNode:1,TextNode:3,CdataSectionNode:4,ProcessingInstructionNode:7,CommentNode:8,DocumentNode:9,DocumentTypeNode:10,DocumentFragmentNode:11};function Rt(e,t){var i=t&&t.name,t=Bt[t&&t.namespaceURI];return/^(?:true|false)$/i.test(e)&&"PlainText"!==i&&!t?"true"===e.toLowerCase():e}function Et(e){let i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];e.hasChildNodes()&&(this.orderedNodes=Array.from(e.childNodes).filter(e=>[It.TextNode,It.CdataSectionNode,It.ElementNode].includes(e.nodeType)).map(e=>{var t;return(t=e).nodeType===It.TextNode||t.nodeType===It.CdataSectionNode?e.nodeValue:(t=e,"undefined"!=typeof HTMLHtmlElement&&t.constructor===HTMLHtmlElement?e:i.includes(e.nodeName)?new Et(e):((t=new Nt(e))._tagName=e.tagName,t))})),((e=e).hasAttributes&&e.hasAttributes()?e.attributes:[]).forEach(e=>this["@"+e.name]=Rt(e.value,e))}function Nt(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(t.includes(e.nodeName))this[e.nodeName]=new Et(e,t);else if(e.hasChildNodes()){for(var i,r,l="",a=0;a<e.childNodes.length;a++)(r=e.childNodes.item(a)).nodeType===It.TextNode?l+=r.nodeValue.trim():r.nodeType===It.CdataSectionNode?l+=r.nodeValue:r.nodeType===It.ElementNode&&(i=r.nodeName,t.includes(i)?this[i]=new Et(r,t):"undefined"!=typeof HTMLHtmlElement&&r.constructor===HTMLHtmlElement?this[i]=r:(r=new Nt(r,t),this.hasOwnProperty(i)?(this[i].constructor!==Array&&(this[i]=[this[i]]),this[i].push(r)):this[i]=r));l&&(this.keyValue=Rt(l))}if(e.hasAttributes&&e.hasAttributes())for(var s,n=0;n<e.attributes.length;n++)this["@"+(s=e.attributes.item(n)).name]=Rt(s.value,s)}function Gt(e){var{knownNameSpaces:e,element:t,qualifiedName:i,namespaceURI:r}=e;return Xt({knownNameSpaces:e,qualifiedName:i,namespaceURI:r}),t.createElementNS(r,i)}function Xt(e){var{knownNameSpaces:e,qualifiedName:t,namespaceURI:i}=e;e[t]=i}function Ot(e,S,m){let C={"xmlns:xs":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"};return function i(r,e){var l,a;if(e.constructor===String||e.constructor===Number||e.constructor===Boolean){if(r.appendChild(S.createTextNode(e.toString())),e===e.valueOf())return}else e.constructor===Date&&r.appendChild(S.createTextNode(e.toGMTString()));var t=Object.keys(e);0<t.indexOf("@N")&&(t.splice(t.indexOf("@N"),1),t.unshift("@N"));for(var s=0,n=t.length;s<n;s++){var o,h,u,g,c,d,p=t[s];if(!isFinite(p))if(l=e[p],"keyValue"===p)null!==l&&!0!==l&&r.appendChild(S.createTextNode(l.constructor===Date?l.toGMTString():String(l)));else if("keyAttributes"===p)for(var v in l)r.setAttribute(v,l[v]);else if("@"===p.charAt(0))r.namespaceURI!==l&&(o=d=c=g=u=h=void 0,{oParentEl:h,knownNameSpaces:u,slicedSName:g,vValue:c}=h={oParentEl:r,knownNameSpaces:C,slicedSName:p.slice(1),vValue:l},(d=g.split(":")).length<2?h.setAttribute(g,c):(String(c).match(/^http/)&&Xt({knownNameSpaces:u,qualifiedName:g,namespaceURI:c}),d=d[0],o=Object.keys(u).filter(e=>"xmlns"===e.split(":")[0]).map(e=>e.split(":")[1]),"xmlns"===d?h.setAttributeNS("http://www.w3.org/2000/xmlns/",g,c):o.includes(d)?(o=u["xmlns:"+d],h.setAttributeNS(o,g,c)):"r:id"===g&&h.setAttribute(g,c)));else if(l.constructor===HTMLHtmlElement)r.appendChild(l);else if(l.constructor===Array)for(let t=0;t<l.length;t++){let e=m[p.split(":")[0]];e=e||r.namespaceURI,i(a=Gt({knownNameSpaces:C,element:S,namespaceURI:e,qualifiedName:p}),l[t]),r.appendChild(a)}else{let e=m[p.split(":")[0]];e=e||r.namespaceURI,a=Gt({knownNameSpaces:C,element:S,namespaceURI:e,qualifiedName:p}),l instanceof Object?i(a,l):null!==l&&!0!==l&&a.appendChild(S.createTextNode(l.toString())),r.appendChild(a)}}}(S.documentElement,e),S}async function w(e,t,r){var{structurePathEnrichObject:l=null}=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=(e&&t&&r||W.log("Missing required param."),r.slice()),l=(r.push(Le(t,e,r,{structurePathEnrichObject:l})),new Dt),t=(l.set("jxon",e),l.setAttributes(Te(e,t,r)),this&&(t=e[o.Cell]||[],l.set(v.cells,new et({archive:this,structurePath:r,...vt.call(this,t,r)}))),e[o.Row]),t=(t&&l.set(v.rows,await async function(e,t){var e=b(e),i=[];for(var r of e){r=await zt.call(this,r,t);null!==r&&i.push(r)}return i}.call(this,t,r)),e[o.Section]),t=(t&&l.set(v.sections,await async function(e,t){e||W.log("Empty section");var e=b(e),i=[];for(var r of e){r=await w.call(this,r,g.Section,t);i.push(r)}e=i.filter(e=>null!==e);return function(e){return e.reduce((e,t)=>{var t=at.from({...t,archive:this}),i=t.type;return e.has(i)||e.set(i,[]),e.get(i).push(t),e},new Map)}.call(this,e)}.call(this,t,r)),e[o.Text]),t=(t&&l.set(v.text,function(e,t){var i,r,l,t=Te(e,g.ShapeText,t),{orderedNodes:a=[]}=e,s=[];let n=null,o=null,h=null,u=pt(s,{characterPropertiesIndex:n,paragraphPropertiesIndex:o,tabsPropertiesIndex:h});for(i of a)"string"==typeof i?ct(u,i):(r=i._tagName,l=m(i["@IX"]),["cp","pp","tp"].includes(r)?(dt(u)&&(u=pt(s,{characterPropertiesIndex:n,paragraphPropertiesIndex:o,tabsPropertiesIndex:h})),"cp"===r&&(n=l,u.characterPropertiesIndex=l),"pp"===r&&(o=l,u.paragraphPropertiesIndex=l),"tp"===r&&(h=l,u.tabsPropertiesIndex=l)):"fld"===r?ct(u,{fieldIndex:l,defaultValue:i.keyValue}):W.log("Unknown text tag.",{tagName:r,textJxon:e}));return void 0===s[s.length-1].content&&s.pop(),t.structure=s,t}.call(this,t,r)),e[o.Rel]),t=(t&&l.set(v._rel,gt.call(this,t,r)),e[o.PageSheet]),t=(t&&l.set(v.pageSheet,await async function(e,t){return w.call(this,e,g.PageSheet,t)}.call(this,t,r)),e[o.Icon]),t=(t&&l.set(v.icon,await async function(e,t){t=await w.call(this,e,g.Icon,t);e.hasOwnProperty(J.Content)&&(t[v.base64]=e[J.Content]);return t}.call(this,t,r)),e[o.ForeignData]),t=(t&&l.set(v.foreignData,await async function(e,t){let i=await w(e,g.ForeignData,t),r,l=t[0].jxonType;{var a;l===g.Page?(a=this.document.pages.get(t[0].pageId),r=await a.getRelsMapCachedAsync()):l===g.Master?(a=t[0].masterId,t=this.document.masters.get(a),r=await t.getRelsMapCachedAsync()):W.log("Unhandled ForeignData Type",e)}if(!r.has(g.Image))return W.log("missing foreign object relation"),null;t=r.get(g.Image);if(!t.has(i._rel))return W.log("missing foreign object relation"),null;e=t.get(i._rel);return e}.call(this,t,r)),e[d.DocumentSettings]),t=(t&&l.set(v.documentSettings,St.call(this,t,r)),e[d.Colors]),t=(t&&l.set(v.colors,mt.call(this,t,r)),e[d.FaceNames]),t=(t&&l.set(v.faceNames,await async function(e,t){var e=b(e.FaceName),i=[];for(var r of e){r=await w.call(this,r,g.FaceName,t);i.push(r)}return i}.call(this,t,r)),e[d.StyleSheets]),t=(t&&l.set(v.styleSheets,await async function(e,t){var e=b(e.StyleSheet),i=new Map;for(var r of e){r=await w.call(this,r,g.StyleSheet,t);i.set(r.id,r)}return i}.call(this,t,r)),e[d.DocumentSheet]);t&&l.set(v.documentSheet,async function(e,t){return w.call(this,e,g.DocumentSheet,t)}.call(this,t,r));let a=e[n.Shapes];if(a){t=await Wt.call(this,a,r);let i=new Map;t.forEach((e,t)=>{null!==e?i.set(t,e):W.log("Skipped shape === null",{shapesJxon:a})}),l.set(v.shapes,i)}let s=e[j.Shape];if(s){t=await Wt.call(this,s,r);let i=new Map;t.forEach((e,t)=>{null!==e?i.set(t,e):W.log("Skipped shape === null",{shapeJxon:s})}),l.set(v.shape,i)}t=e[n.Connects];return t&&(e=t,0!==Object.keys(e).length)&&l.set(v.connects,function(e){let i=new Map;return e.forEach((e,t)=>i.set(t,new Mt({archive:this,...e}))),i}.call(this,Ft.call(this,t,r))),l.isDummyResult?l.attributes:l}async function zt(e,t){t=await w.call(this,e,g.Row,t,{type:name});return void 0===t.index&&void 0===t.name?(W.log("row skipped - invalid XML (no required field)",{parsedRow:t,rowJxon:e,cellsDebug:t.cells?t.cells.debug:"no cells"}),null):(t.debugType=void 0!==t.index?p.Indexed:p.Named,t)}let Yt=0;async function Wt(e,t){e&&t||W.log("Missing required parameter.");var i,e=b(e[j.Shape]),r=new Map;for(i of e){var l=await Ut.call(this,i,t);r.set(l.id,{structurePath:t,...l})}return r}async function Ut(e,t){var i=await w.call(this,e,g.Shape,t),t=(4294967295===i.id&&(i.id="deleted-"+Yt++),i.structurePath=t,i[v.type]);if(t===f.Shape)i.debugType=K.ShapeSimple;else if(t===f.Group)i.debugType=K.ShapeGroup,i.shapes||W.log("property shapes undefined");else if(t===f.Foreign)i.debugType=K.ShapeForeign;else if(t===f.Guide)i.debugType=K.ShapeGuide,W.log("VisioShapeType.Guide investigate");else{if(void 0!==t||!i.hasOwnProperty(v.deleted))return W.log(`Implement VisioShapeType "${t}"`,{shape:e}),null;i.debugType=K.ShapeDeleteOverride}return i}function jt(e,t,r){let l=(e=>{let i=new Map;return e.forEach((e,t)=>i.set(t,e.map(qt))),i})(e);return t.forEach((e,t)=>{if(!l.get(t))return l.set(t,e);var i=l.get(t);l.set(t,function(l){let e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],{_type:a,shape:s}=2<arguments.length?arguments[2]:void 0;return e.forEach(e=>{let{index:t,deleted:i}=e;var r=l.findIndex(e=>e.index===t);i?l.splice(r,1):-1===r?l.push(e):function(e,t){var{_type:i,shape:r}=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Jt(e)!==Jt(t)&&(W.log(),W.log("Indexes are not same"));var l=e.rows,a=t.rows,l=(Ht(l),Ht(a),{type:t.type,rows:function(n){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];return e.forEach(e=>{let{index:t,name:i,debugType:r,deleted:l}=e;var a=n.findIndex(e=>r===p.Indexed?e.index===t:e.name===i),s=Boolean(n[a]);l?s&&n.splice(a,1):-1===a?n.push(e):n[a]=((m,C)=>{{var f,y=C;let{type:e,index:t,name:i,cells:r,deleted:l,debugType:a,jxon:s,...n}=m,{type:o,index:h,name:u,cells:g,debugType:c,jxon:d,_prefixList:p,_archive:v,...S}=y;a!==c&&W.log("Rows are different"),Object.keys(n).length&&W.log("Unexpected attribute"),Object.keys(S).length&&W.log("Unexpected attribute"),t!==h&&W.log("Rows are different"),i!==u&&W.log("Rows are different"),void 0!==t&&void 0!==i&&(W.log(),W.log("Row name and index can't be present together.",{indexMaster:t,nameMaster:i})),void 0===t&&void 0===i&&W.log("A missing index and name of the row. One is required.")}var e=$t(m.cells,C.cells);e.setRowType(C.type);let t;return C.jxon?t=C.jxon:m.jxon,e={type:C.type,debugType:C.debugType,jxon:t,cells:e},C.name&&(e.name=m.name),void 0!==C.index&&(e.index=m.index),e})(n[a],e)}),n}(l,a,{_type:i,shape:r})});(e.cells||t.cells)&&(l.cells=$t(e.cells,t.cells))}(l[r],e,{_type:a,shape:s})}),l}(i,e,{_type:t,shape:r}))}),l}function Ht(e){Array.isArray(e)||void 0===e||W.log("Is not array")}function Jt(e){let{type:t,rows:i,index:r,cells:l,jxon:a,_prefixList:s,_archive:n,...o}=e;return Y.hasOwnProperty(t)||W.log("Unknown type",t),Array.isArray(i)||void 0===i||W.log("Unexpected row type"),Object.keys(o).length&&W.log("Unexpected attribute"),r}function $t(t,i){return t?(i&&i.attributesSet.forEach(e=>t[e]=i.get(e)),t):i.clone()}function qt(e){var{type:e,rows:t,index:i,cells:r}=e,l={};return e&&(l.type=e),void 0!==i&&(l.index=i),t&&(l.rows=t.map(Kt)),r&&(l.cells=r.clone()),l}function Kt(e){var{type:e,index:t,name:i,cells:r,debugType:l}=e,a={};return e&&(a.type=e),i&&(a.name=i),void 0!==t&&(a.index=t),l&&(a.debugType=l),r&&(a.cells=r.clone()),a}function Qt(e,a){if(e&&e.structure)return(e=e.structure.reduce((t,r)=>{let l={};return[{parsedIndexName:"characterPropertiesIndex",sectionType:Y.Character,propertyName:"characterProperties"},{parsedIndexName:"paragraphPropertiesIndex",sectionType:Y.Paragraph,propertyName:"paragraphProperties"},{parsedIndexName:"tabsPropertiesIndex",sectionType:Y.Tabs,propertyName:"tabsProperties"}].forEach(e=>{var{parsedIndexName:e,sectionType:t,propertyName:i}=e,e=r[e];void 0!==e&&void 0!==(e=((e,t)=>(t=t.rows[e]).cells)(e,a.get(t)[0]))&&(l[i]={cells:e,values:e.directValues})}),r.content.map(e=>"string"==typeof e?e:(e=e.fieldIndex,void 0===(e=a.get(Y.Field)[0].rows[e].cells)&&W.log("fieldCells undefined"),e.value)).filter(e=>""!==e).forEach(e=>{t.push({content:e,...l})}),t},[])).some(e=>void 0===e.content)&&W.log("contentArray some undefined"),e}let l={linear:"linear",radial:"radial",rectangle:"rectangle",path:"path"};function Zt(e){var{fillGradientDir:e,fillGradientSection:t}=e,e=(e=>{switch(e){case 0:return{type:l.linear};case 1:return{type:l.radial,base:_.Shape,vertical:a.bottom,horizontal:a.right};case 2:return{type:l.radial,base:_.Shape,vertical:a.bottom,horizontal:a.left};case 3:return{type:l.radial,base:_.Shape,vertical:a.center,horizontal:a.center};case 4:return{type:l.radial,base:_.Shape,vertical:a.bottom,horizontal:a.center};case 5:return{type:l.radial,base:_.Shape,vertical:a.top,horizontal:a.center};case 6:case 7:return{type:l.radial,base:_.BoundingBox,vertical:a.bottom,horizontal:a.right};case 8:return{type:l.rectangle,base:_.Shape,vertical:a.bottom,horizontal:a.right};case 9:return{type:l.rectangle,base:_.Shape,vertical:a.bottom,horizontal:a.left};case 10:return{type:l.rectangle,base:_.Shape,vertical:a.center,horizontal:a.center};case 11:return{type:l.rectangle,base:_.Shape,vertical:a.top,horizontal:a.right};case 12:return{type:l.rectangle,base:_.Shape,vertical:a.top,horizontal:a.left};case 13:return{type:l.path}}})(e),t=(e=>(e=e.rows).map(e=>e.cells).map(e=>({offset:e.gradientStopPosition,color:e.gradientStopColor,opacity:1-e.gradientStopColorTrans})))(t);let i;switch(e.type){case l.linear:i="linearGradient";break;default:case l.radial:i="radialGradient"}return{type:i,stops:t,attrs:{}}}let a={left:"left",right:"right",top:"top",bottom:"bottom",center:"center"},_={Shape:"Shape",BoundingBox:"BoundingBox"};function ei(e){switch(e){case 2:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2,scale:"1 1"};case 3:return{d:"M 0 5 L 10 5 M 5 0 L 5 10"};case 4:return{d:"M 0 0 L 10 10 M 0 10 L 10 0"};case 5:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2,scale:"1 1"};case 6:return{d:"M 0 5 L 10 5"};case 7:return{d:"M 5 0 L 5 10"};case 8:case 9:case 10:return ti(e);case 11:return{d:"M 0 1 L 2 1 M 2 3 L 4 3",width:3,height:3,viewBox:"0 0 4 4"};case 12:return ti(e);case 13:return{d:"M 0 2.5 L 1 2.5",width:1,height:3};case 14:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 15:return{d:"M 2.5 0 L 2.5 1",rotate:45,width:5,height:1};case 16:return{d:"M 2.5 0 L 2.5 1",rotate:315,width:5,height:1};case 17:case 18:return ti(e);case 19:return{d:"M 0 2.5 L 1 2.5",width:1,height:5};case 20:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 21:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2};case 22:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2};case 23:return{d:"M 0 2.5 L 5 2.5 M 2.5 0 L 2.5 5",width:5,height:5};case 24:return ti(e)}}function ti(e){return W.log(`unimplemented fill pattern ${e}, `+"using pattern 2 instead"),ei(2)}function ii(e,t,i){var{origin:t={x:0,y:0},prefix:r="",isRoot:l=!1}=1<arguments.length&&void 0!==t?t:{},i=2<arguments.length&&void 0!==i?i:{};if(i.ignoreNonPrinting&&!e.isPrintable())return null;var{text:a,cells:s={},foreignData:n}=e,{angle:o=0,locPinX:h=0,locPinY:u=0,pinX:g,pinY:c,width:d,height:p,flipX:v,flipY:S,fillForegnd:m="white",fillBkgnd:C="#ff0000",lineColor:f="black",lineWeight:y,lineColorTrans:I=0,fillForegndTrans:P=0,linePattern:b=1,fillPattern:x=1,fillGradientDir:R=0,fillGradientAngle:E,fillGradientEnabled:N=!1}=s,w=[],_={},g=(W.level&W.TOOLTIPS&&(_.root={title:""+e.tooltip}),{x:t.x+g,y:t.y-p-c}),t={width:d,height:p};let T=v?-1:1,k=S?-1:1,L=-h,V=S?-2*p+u:u,G=T*k*o,X=h,O=p-u;l&&(L+=v?-d+h:h,V-=S?-p+u:u);var A,M,F,D,c=[`scale(${T}, ${k})`,`translate(${L}, ${V})`,`rotate(${G}, ${X}, ${O})`].join(" "),o=i.noGeometry?[]:e.getComputedGeometry(),B=(0<o.length&&(w.push({tagName:"g",selector:v=r+"foreground",children:((e,t)=>{let{width:r,height:l,prefix:a=""}=t;return e.map((e,t)=>{var i={d:e.toPath(r,l).toString(),"stroke-linecap":"round","stroke-linejoin":"round"},{cells:e={}}=e;return e.noFill&&(i.fill="none"),e.noLine&&(i.stroke="none"),e.noShow&&(i.visibility="hidden"),{tagName:"path",selector:a+"geometry-"+t,attributes:i}})})(o,{width:d,height:p,prefix:r}),attributes:{transform:c,"stroke-width":Math.max(y,1)}}),h=_[v]={},{shapeShdwType:i,shapeShdwOffsetX:c,shapeShdwOffsetY:y,shapeShdwBlur:v=0,shdwForegnd:m="#000",shdwForegndTrans:x=0}=(0===x?h.fill="none":(h.fill=1===x?m:(S=m,u=C,(i=ei(i=x))?({d:i,strokeWidth:o=1,x:c=0,y=0,width:v=10,height:m=10,patternUnits:x="userSpaceOnUse",strokeOpacity:D=1,fillOpacity:B=1,rotate:A=0,viewBox:M=void 0,scale:F="1 1"}=i,u={type:"pattern",color:S,backgroundColor:u,strokeWidth:o,d:i,x:c,y:y,width:v,height:m,patternUnits:x,strokeOpacity:D,fillOpacity:B,rotate:A,scale:F,viewBox:M},M&&(u.viewBox=M),u):S),h.fillOpacity=1-P),N&&(h.fillOpacity=1-P,o=e.getComputedSection(Y.FillGradient))&&(h.fill=Zt({fillGradientAngle:E,fillGradientDir:R,fillGradientSection:o,fillBkgnd:C})),0<b?(h.stroke=f,h.strokeOpacity=1-I,h.strokeDasharray=yt(b)):h.stroke="none",e.isOneDimensional()&&z.util.assign(h,Ct(s)),s),i)&&(h.filter={name:"dropShadow",args:{dx:c,dy:-y,color:m,opacity:1-x,blur:v}}),n&&(D="image"+n.id,w.push({tagName:"image",selector:r+"image",groupSelector:D,attributes:{x:-d/2,y:p/2,width:d,height:p}})),a&&a.length&&Be(e,{markup:w,attrs:_,prefix:r,isRootGroupText:l}),{markup:w,attrs:_,position:g,size:t});return 2===e.cells.objType&&z.util.setByPath(B,["attrs","foreground","fill"],"none"),B}let ri=0;class li extends Pe{getDefaultAttributes(){return{...super.getDefaultAttributes(),name:null,type:null,cells:null,sections:new Map,shapes:[],pageContent:null}}constructor(e){let{shapes:t,...i}=e;i.type||!0===i.deleted||W.log("Missing type, could not instantiate a VisioShape."),super(i,new Set([v.name,v.type,v.cells,v.sections,v.master,v.shapes,v.textStyle])),void 0!==this.masterId&&(this._master=this.masters.get(this.masterId)),t&&this.initShapes(t),this.pageContent.referenceShape(this)}initShapes(e){var t=this._master,i=this.masters&&this.masters.get(this.parentMasterId);t||i?t?this.shapes=this.traverseShapes(e,t.masterShapes):i&&(t=i.masterShapesMap.get(this.masterShapeId),this.shapes=this.traverseShapes(e,t.masterShapes)):this.shapes=this.instantiateShapes(e)}traverseShapes(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Map;let r=void 0!==this.masterId?this.masterId:this.parentMasterId,l=this.shapesByMasterShapeId(e),a=0,s=new Map;return t.forEach((e,t)=>{let i=l.get(t);(i=i||{id:"dummy-"+ri++,type:e.type}).deleted||s.set(i.id,this.factory({masterShape:e,parentMasterId:r,xmlGroupOrder:a++,...i}))}),s}factory(e){return new li({archive:this.archive,parent:this,pageContent:this.pageContent,masters:this.masters,...e})}getRootShape(){let e=this,t=e.parent;for(;t;)t=(e=t).parent;return e}isRootShape(){return!this.parent}shapesByMasterShapeId(e){let t=new Map;return e.forEach(e=>{e.masterShapeId||W.log("masterShapeId undefined"),t.set(e.masterShapeId,e)}),t}getComputedForeignData(){var{foreignData:e,masterShape:t}=this;return e||(t&&t.foreignData?t.foreignData:null)}hasImage(){return Boolean(this.getComputedForeignData())}async getImage(){var e,t=this.getComputedForeignData();return t?({targetFile:t,id:e}=t,{...await this.archive.getImageAsync(t.absolutePath),selector:"image"+e}):null}referenceMasters(){var e,t,i=void 0!==this.masterId?this.masterId:this.parentMasterId;void 0!==i&&(e=this.archive.document.masters,this.master=e.get(i),this.masterShapeId?(t=this.master.masterShapesMap,this._masterShape=t.get(this.masterShapeId)):this._masterSubShape=e.getSubShape(i))}get masterShape(){return this._masterShape||this._master}set masterShape(e){this._masterShape=e}instantiateShapes(e){let i=void 0!==this.masterId?this.masterId:this.parentMasterId,r=new Map;return e.forEach((e,t)=>r.set(t,this.factory({parentMasterId:i,...e}))),r}get x(){return this.cells.pinX-this.cells.locPinX}get y(){return this.cells.pinY-this.cells.locPinY}get angle(){return this.cells.angle}get height(){return this.cells.height}get width(){return this.cells.width}get matrix(){var{x:e,y:t,angle:i}=this;let r=z.V.createSVGMatrix().translate(e,t);return r=i?r.rotate(i):r}getPageMatrix(){let t=z.V.createSVGMatrix();return[...this.getAncestorShapes(),this].forEach(e=>{t=t.multiply(e.matrix)}),t}getPageOrigin(){var{parent:e,pageContent:t}=this,t=new z.g.Point(0,t.page.height);return e&&(e=e.getPageMatrix(),t.offset(e.e,-e.f)),t}getPageZIndex(){return this.getRootShape().xmlOrder}getPageAngle(){return this.getAncestorShapes().reduce((e,t)=>e+t.angle,this.angle)}getPagePosition(){return this.getPageBBox().origin()}getPageBBox(){var e=this.getPageMatrix(),{width:t,height:i,pageContent:r}=this,l=e.e,r=r.page.height-e.f-i;return new z.g.Rect(l,r,t,i).normalize()}get name(){var e=this.archive.document.languageDependent?this._name:this.nameU;return"string"==typeof e?e:null}get type(){return this._type}set type(e){this._type=e}get cells(){if(!this._cells){var e=this.masterShape;if(e&&e.cells)return e.cells}return this._cells}set cells(e){this._cells=e}get sections(){return this._cachedSections||this.cacheSections(),this._cachedSections}cacheSections(){let i=new Map;this.mergeSections().forEach((e,t)=>{e=e.map(e=>{e=at.from({...e,archive:this.archive});return this._sections.has(t)&&(e.jxon=this._sections.get(t)[0].jxon),e});i.set(t,e)}),this._cachedSections=i}mergeSections(){var e=this.getDefaultSections(),t=Boolean(this._sections),i=Boolean(this.masterShape&&this.masterShape.sections);return t||i?t&&!i?jt(e,this._sections,this):!t&&i?jt(e,this.masterShape.sections,this):(t=this._sections,i=jt(e,this.masterShape.sections,this),jt(i,t,this)):e}set sections(e){this._sections=e}get shapes(){return this._shapes}set shapes(e){this._shapes=e}get text(){if(null!==this._cachedText)return this._cachedText||(this._cachedText=this.calculateTextContent()),this._cachedText}getSubShapes(){return[...this._shapes.values()]}getAncestorShapes(){var e=[];let t=this.parent;for(;t;)e.unshift(t),t=t.parent;return e}getSectionNames(){return[...this.sections.keys()]}getOwnSectionNames(){return[...this._sections.keys()]}getSection(e){if(e===Y.Geometry)throw new Error("Use getGeometry instead.");var t;if(Y[e])return t=this._sections.get(e),Array.isArray(t)&&0!==t.length?t[0]:null;throw new Error("Wrong section name: "+e)}getComputedSection(e){if(e===Y.Geometry)throw new Error("Use getGeometry instead.");var t;if(Y[e])return t=this.sections.get(e),Array.isArray(t)&&0!==t.length?t[0]:null;throw new Error("Wrong section name: "+e)}getGeometry(){var e=this._sections.get(Y.Geometry);return e||[]}getComputedGeometry(){var e=this.sections.get(Y.Geometry);return e||[]}addSection(e){var t,i,r,l=Z[e];return void 0===l?(W.log("Unhandled section name: "+e),null):this.getSection(e)&&l!==Z.Geometry?(W.log(`Can not add a section "${e}" as it already exists.`),this.getSection(e)):(l={[O.Name]:e,Row:[]},t=at.from({type:e,jxon:l,archive:this.archive}),e===Y.Geometry?(r=(i=this.getComputedGeometry()).map(e=>e.index).sort().pop(),t.index=Number.isInteger(r)?r+1:0,this._sections.set(e,[...i,t]),l[O.Id]=t.index.toString()):this._sections.set(e,[t]),this.jxon.Section.push(l),this.cacheSections(),t)}removeSection(t){let i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;var e=Z[t];if(void 0!==e)if(e===p.Named){this.sections.delete(t);e=this.jxon.Section.findIndex(e=>e[O.Name]===t);this.jxon.Section[e]&&this.jxon.Section.splice(e,1)}else{if(!Number.isInteger(i))throw new Error("Index has to be an integer.");e=this.sections.get(t)||[];if(Array.isArray(e)&&!e[i])throw new Error("Index out of range.");e.splice(i,1),this.sections.set(t,e);e=this.jxon.Section.findIndex(e=>e[O.Name]===t&&e[O.Id]===i.toString());this.jxon.Section[e]&&this.jxon.Section.splice(e,1)}}getText(){var e=this.text;return Array.isArray(e)&&0!==e.length?e[0].content.trim():""}setText(e){e&&0<e.length&&(this.text=[{content:e}],this.jxon.Text=[{cp:{"@IX":"0"}},e])}calculateTextContent(){var e=this.sections,t=Qt(this._text,e);return t||((t=this.masterShape)?Qt(t.text,e):null)}getDefaultSections(){var e=this.textStyle,t=this.archive.document.styleSheets,i=t.get(e),i=(void 0===i&&W.log("styleSheet undefined"),i.sections||new Map);return 0===e?i:jt(t.get(0).sections,i,this)}set text(e){this._text=e}get master(){return this._master||(this._masterShape?this._masterShape.master:null)}getMaster(){return this.getRootShape().master}get tooltip(){let e="shapeId: "+this.id+`\nwidth: `+this.cells.width+`\nheight: `+this.cells.height+`\ntype: `+this.type;var t=this.masterShape,t=(t&&(e+=`\nmasterShapeId: `+t.id,t.shapeId)&&(e+=` (shapeId: ${t.shapeId})`),this.master);return t&&(e+=`\nmasterXml: `+t.xmlPath.split("/").pop()),e+=`\nshapeXml: `+this.pageContent.page.xmlPath.split("/").pop(),this.isOneDimensional()&&(e+="\nisOneDimensional"),e}set textStyle(e){this._textStyle=e}get textStyle(){var e;return void 0!==this._textStyle?this._textStyle:this.masterShape&&void 0!==this.masterShape.textStyle?this.masterShape.textStyle:(void 0===(e=this.archive.document.documentSettings.defaultTextStyle)&&W.log("defaultTextStyle undefined"),e)}set fillStyle(e){this._fillStyle=e}get fillStyle(){var e;return void 0!==this._fillStyle?this._fillStyle:this.masterShape&&void 0!==this.masterShape.fillStyle?this.masterShape.fillStyle:(void 0===(e=this.archive.document.documentSettings.defaultFillStyle)&&W.log("defaultFillStyle undefined"),e)}set lineStyle(e){this._lineStyle=e}get lineStyle(){var e;return void 0!==this._lineStyle?this._lineStyle:this.masterShape&&void 0!==this.masterShape.lineStyle?this.masterShape.lineStyle:(void 0===(e=this.archive.document.documentSettings.defaultLineStyle)&&W.log("defaultLineStyle undefined"),e)}isOneDimensional(){return this.cells.hasEvery([v.beginX,v.beginY,v.endX,v.endY])}isPrintable(){return!this.cells.nonPrinting}getConnect(){return this.pageContent.connects.get(this.id)||null}toElementAttributes(e){var t=this.getPageOrigin();let i;switch(this.type){case f.Group:i=function a(e,t,i){let{origin:r={x:0,y:0},prefix:s="group",isRoot:l=!1}=1<arguments.length&&void 0!==t?t:{},n=2<arguments.length&&void 0!==i?i:{};if(n.ignoreNonPrinting&&!e.isPrintable())return null;var{cells:t,shapes:i}=e;let{width:o,height:h,locPinX:u,locPinY:g,pinX:c,pinY:d,angle:p,flipX:v,flipY:S}=t;t=ii(e,{origin:{x:0,y:h},prefix:s,isRoot:l},n);if(!t)return null;let m=t.markup;var e=[],C=m.findIndex(e=>e.text);-1<C&&e.push(...m.splice(C,1));let f=t.attrs;C={x:r.x+c-u,y:r.y-d+g-h};let y=z.V.createSVGMatrix();p&&(y=y.translate(u,g).rotate(p).translate(-u,-g)),v&&(y=y.flipX().translate(-o,0)),S&&(y=y.flipY().translate(0,-h));t={width:o,height:h};return i.forEach((t,i)=>{if(t&&(!n.ignoreSubShapeConnects||!t.getConnect())){var r,l,i=""+s+i;let e;(e=("Group"===t.type?a:ii)(t,{origin:{x:0,y:h},prefix:i+"-"},n))&&({markup:t,position:r,attrs:l}=e,m.push({tagName:"g",selector:i,children:t,attributes:{transform:z.V.matrixToTransformString(y.translate(r.x,r.y))}}),"root"in l&&(l[i]=l.root,delete l.root),z.util.assign(f,l))}}),{markup:[...m,...e],attrs:f,position:C,size:t}}(this,{origin:t,isRoot:!0},e);break;case f.Shape:case f.Foreign:i=ii(this,{origin:t},e);break;default:return null}return i.z=this.getPageZIndex(),i}toElement(){var{importShape:e=kt,ignoreNonPrinting:t=!0,ignoreSubShapeConnects:i=!0}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return"function"!=typeof e||t&&!this.isPrintable()?null:e(this,{ignoreNonPrinting:t,ignoreSubShapeConnects:i})}static async fromMaster(e,t){var i=e.archive,r=await i.getJxonAsync(e.xmlPath),r=z.util.cloneDeep(r.Shapes.Shape),r=(!function t(e,i){if(!e)return;i?(e[n.MasterId]=i.id.toString(),e[M.NameU]=i.nameU):e[n.MasterShapeId]=e[n.Id];e[o.Id]=z.util.uniqueId();e.Cell=si(e.Cell);e.Section=ai(e.Section);e.Shapes&&(Array.isArray(e.Shapes.Shape)?e.Shapes.Shape.forEach(e=>t(e)):t(e.Shapes.Shape))}(r,e),await w.call(i,r,g.Master,[])),t=await t.getContent({overrideRels:!0});return r.master=e,new li({archive:i,pageContent:t,...r})}}function ai(e){return Array.isArray(e)?e.map(e=>{var t;return e.Cell=si(e.Cell),e.Row=(t=e.Row,Array.isArray(t)?t.map(e=>(e.Cell=si(e.Cell),e)):void 0!==t?[t]:[]),e}):void 0!==e?[e]:[]}function si(e){return Array.isArray(e)?e.filter(e=>e[s.Formula]&&-1===e[s.Formula].indexOf("!")):void 0!==e?[e]:[]}function ni(e){var t=e instanceof Array;t||(e=[e]);var i=document.createElement("div");let a=document.createElement("span"),s=(i.style.visibility="hidden",i.style.position="absolute",i.style.left="-9999px",i.style.top="0px",i.style.fontWeight="bold",i.style.fontSize="200px !important",a.appendChild(document.createTextNode("~iomwIOMW")),i.appendChild(a),document.body.appendChild(i),[]);return e.forEach(function(e,t){a.style.fontFamily=e+",monospace, monospace";var i=a.offsetWidth,r=a.offsetHeight,e=(a.style.fontFamily=e+",sans-serif",a.offsetWidth),l=a.offsetHeight;s[t]=i==e&&r==l}),document.body.removeChild(i),s=t||1!=s.length?s:s[0]}class oi{constructor(e){e||W.log("VisioPageContent can only be created using an instance of a Page.",{page:e}),this.page=e,this.rootShapes=new Map,this.shapes=new Map,this.connects=new Map,this.foreignShapes=new Map,this.linkShapes=new Map,this.elementShapes=new Map}async loadAsync(e){let i=this.page;var t=await i.archive.getJxonAsync(i.xmlPath),{shapes:t=[],connects:r=[]}=await w.call(i.archive,t,g.Page,[],{structurePathEnrichObject:{pageId:i.id}});await i.getRelsMapCachedAsync(e),await i.getMastersFromRelsAsync(),r.forEach(e=>{e.referencePageContent(this),this.connects.set(e.shapeId,e)}),[...t.values()].forEach((e,t)=>{t=new li({archive:i.archive,masters:i.archive.document.masters,pageContent:this,xmlOrder:t,...e});this.rootShapes.set(e.id,t),t.getConnect()||this.elementShapes.set(e.id,t)}),this.connects.forEach(e=>{e=e.getShape();e&&this.linkShapes.set(e.id,e)})}referenceShape(e){var t;this.shapes.set(e.id,e),e.foreignData&&this.setForeignShape(e.foreignData,e),e.masterShape&&e.masterShape.foreignData&&(t=e.masterShape,this.setForeignShape(t.foreignData,e,t)),this.referenceShapeInsideCellsDeep(e)}setForeignShape(e,t,i){var r=e.targetFile.absolutePath;this.foreignShapes.has(r)||this.foreignShapes.set(r,[]),this.foreignShapes.get(r).push({foreignData:e,shape:t,master:i})}referenceShapeInsideCellsDeep(t){this.referenceShapeInsideCells(t._cells,t),t._sections.forEach(e=>{e.forEach(e=>{e&&e.rows&&e.rows.forEach(e=>{this.referenceShapeInsideCells(e.cells,t)})})})}referenceShapeInsideCells(e,t){e&&(t instanceof li||W.log("shape must be instance of Shape"),(e.shape=t).masterShape)&&(e.parent=t.masterShape)}toGraphCells(){let{importShape:i=kt,importConnect:r=Lt,importLabels:l=Vt,importImage:a=function(e,t,i){var{extension:i,base64:r,selector:l}=i,a={};let s;return!r||At.includes(i)?(s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mN0qwcAAREAx9X+/mIAAAAASUVORK5CYII=",a.preserveAspectRatio="none"):s=r,a.xlinkHref=s,t.attr([l],a),s},ignoreNonPrinting:s=!0,ignoreSubShapeConnects:n=!0,onImagesLoad:t=null}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=new Map,h=new Map,u=new Map;this.getElementShapes().forEach(e=>{var t=e.toElement({importShape:i,ignoreNonPrinting:s,ignoreSubShapeConnects:n});t&&o.set(e.id,t)}),this.getLinkShapes().forEach(e=>{var t=e.getConnect().toLink(o,{importShape:i,importConnect:r,ignoreNonPrinting:s});t&&(h.set(e.id,t),t.isLink())&&(t=e.getConnect().toLinkLabels(t,{importLabels:l}))&&u.set(e.id,t)});var e=this.getForeignShapes().map(e=>e.map(e=>e.shape)).flat().map(i=>async()=>{var e,t=o.get(i.getRootShape().id);return t&&(e=await i.getImage())?a(i,t,e):null});return Promise.all(e.map(e=>e())).then(e=>{"function"==typeof t&&t(e.filter(e=>null!==e))}),[...o.values(),...h.values(),...u.values()].flat()}getRootShapes(){return[...this.rootShapes.values()]}getRootShape(e){return this.rootShapes.get(e)||null}getShapes(){return[...this.shapes.values()]}getShape(e){return this.shapes.get(e)||null}getConnects(){return[...this.connects.values()]}getConnect(e){return this.connects.get(e)||null}getForeignShapes(){return[...this.foreignShapes.values()]}getForeignShape(e){return this.foreignShapes.get(e)||null}getLinkShapes(){return[...this.linkShapes.values()]}getElementShapes(){return[...this.elementShapes.values()]}getFonts(){let t=new Set;return this.shapes.forEach(e=>{var e=e.getComputedSection(Y.Character);e&&(e=e.getRow(0))&&(e=e.getCell(y.Font).value,void 0===e||"Themed"===e||t.has(e)||t.add(e))}),[...t.values()]}getUnsupportedFonts(){return this.getFonts().filter(e=>!ni(e))}}class hi{constructor(e){this._zipApi=e,this._index=Object.entries(this._zipApi.files).reduce((e,t)=>{var[t,i]=t;return e.set(t,i)},new Map),this.cache={jxons:new Map,images:new Map}}getFileReference(e){return this._index.get(e)}async getJxonAsync(e){var t,i=this.cache.jxons.get(e);return i?(W.log("used cached copy of JXON: "+`%c${e} `,"color: orange;"),i):(i=(new Date).getTime(),(t=e)&&/(\.xml|\.rels)$/.test(t)||W.log("Can't convert to JXON (file extension doesn't match)",t),(t=this.getFileReference(e))?(t=await t.async("string"),t=t,t=new Nt((new DOMParser).parseFromString(t,"application/xml").documentElement,[n.Text]),this.cache.jxons.set(e,t),W.log("read XML and parse to JXON took: "+((new Date).getTime()-i)+`ms %c${e} `,"color: orange;"),t):null)}async getImageAsync(e){var t,i,r,l=this.cache.images.get(e);return l?(W.log("used cached copy of image: "+`%c${e} `,"color: orange;"),l):(l=(new Date).getTime(),(t=this.getFileReference(e))?(t=await t.async("base64"),[,r,i]=e.match(/([^/]+\.(jpeg|png|[a-zA-Z]*))$/),this.cache.images.set(e,r={absolutePath:e,file:r,extension:i,base64:`data:image/${i};base64,`+t}),W.log("read image and encode to base64 took: "+((new Date).getTime()-l)+`ms %c${e} `,"color: orange;"),r):null)}}function ui(e){let{relationshipOrArrayOfJxons:t,basePath:s}=e;e=b(t);return e.forEach(e=>{}),e.reduce((e,t)=>{var i,r,l,a=t[G.Type];return X.hasOwnProperty(a)?(l=function(e,t,i){var t="/"===t?e:t.match({0:/^(.*\/)[^/]?/,1:/^(.*\/)(.*\/)[^/]+$/,2:/^(.*\/)(.*\/)(.*\/)[^/]+$/}[2<arguments.length&&void 0!==i?i:0])[1]+e,r=t.split("/");for(let e=r.length-1;0<=e;e--)".."===r[e]&&(r.splice(e-1,2),e--);return r.join("/")}(r=t[G.Target],s),l={id:i=ut(t[G.Id]),targetFile:{relativePath:r,absolutePath:l},debugType:r=X[a]},e.has(r)||e.set(r,new Map),e.get(r).set(i,l)):W.log(`Unknown Relation Type "${a}"`,{relationshipJxon:t}),e},new Map)}function gi(e,t){e=e.get(t);return e?(e=>(1!==e.size&&W.log("Is not single record JXON",{singleRecordRelationMap:e}),e.values().next().value))(e).targetFile.absolutePath:null}class ci extends Ce{getDefaultAttributes(){return{...super.getDefaultAttributes(),rels:null,xmlPath:null}}constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;t.add(v.rels),t.add(v.xmlPath),super(e,t)}async getRelsMapCachedAsync(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return this.xmlPath||W.log("no xml path"),this.rels||(this.rels=await this.getRelsMapAsync.call(this.archive,this.xmlPath,e)),this.rels}async getRelsMapAsync(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).overrideRels,i=e.replace(/^(?<basePath>.*?)(?<filename>[^/]*?)$/,"$<basePath>_rels/$<filename>.rels");let r;if(t){t=this.document;if(!t||!t.masters||!t.masters.map)return null;r={"@xmlns":C.Relationships,Relationship:[]},t.masters.map.forEach((e,t)=>{r.Relationship.push({"@Id":"rId"+(t+1),"@Type":C.VisioMasterRelationship,"@Target":e._xmlPath.replace("visio","..")})})}else r=await this.getJxonAsync(i);return r?ui({relationshipOrArrayOfJxons:r.Relationship,basePath:e}):null}set rels(e){this._rels=e}get rels(){return this._rels}set xmlPath(e){this._xmlPath=e}get xmlPath(){return this._xmlPath}}class di extends ci{getDefaultAttributes(){return{...super.getDefaultAttributes(),_colors:null,_relations:null,_pages:null,documentSettings:null,faceNames:null,styleSheets:null,documentSheet:null,languageDependent:!0,masterShapesMap:new Map}}constructor(){super(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},new Set([v.colors,v.relations,v.pages]))}getMasters(){return[...this.masters.map.values()]}getMastersIdMap(){return Object.fromEntries(this.masters.map)}getMastersNameMap(){return this.getMasters().reduce((e,t)=>(e[t.name]=t,e),{})}getPages(){return this.pages.toArray()}getPage(e){return this.pages.get(e)}get name(){var{documentSheet:e,languageDependent:t}=this;return t?e.name:e.nameU}get colors(){return this._colors}set colors(e){this._colors=e}set pages(e){this._pages=e}get pages(){return this._pages}set documentSettings(e){this._documentSettings=e}get documentSettings(){return this._documentSettings}set faceNames(e){this._faceNames=e}set styleSheets(e){this._styleSheets=e}get styleSheets(){return this._styleSheets}set documentSheet(e){this._documentSheet=e}get documentSheet(){return this._documentSheet}}class pi extends ci{getDefaultAttributes(){return{...super.getDefaultAttributes(),pages:new Map}}constructor(e){super(e,new Set([v.pages])),Object.entries(e).forEach(e=>{var[e,t]=e;return this["_"+e]=t})}get(e){return this._pages.get(e)||null}add(e){var t=this._pages.size;e.index=t,this._pages.set(e.id,e)}toArray(){return[...this._pages.values()]}}function vi(e){var t;return"none"===e||"transparent"===e?e:((t=document.createElement("canvas").getContext("2d")).fillStyle=e,t.fillStyle)}let Si=/^rgba\(.*,(.+)\)/;function mi(e){return"string"==typeof e&&("transparent"===e||!!(e=Si.exec(e))&&([,e]=e,0===parseFloat(e)))}function Ci(e,r){let l=[];return e.segments.forEach(e=>{let t,i=[z.V.transformPoint(e.end,r)];switch(e.type){case"M":t="MoveTo";break;case"L":case"Z":t="LineTo";break;case"C":t="LineTo",(i=e.toPoints()).forEach((e,t)=>{i[t]=z.V.transformPoint(e,r)})}i.forEach(e=>{l.push({"@IX":(l.length+1).toString(),"@T":t,Cell:[{"@N":y.X,"@V":(e.x/96).toString()},{"@N":y.Y,"@V":(e.y/96).toString()}]})})}),l}let fi={G:!0,TITLE:!0,TSPAN:!0,TEXTPATH:!0};async function yi(u,g,c,d,e){var t=u.tagName();if("TEXT"===t)i=g,m=(p=u).node,0!==(m=Array.from(m.childNodes).map(e=>e.textContent).join("\n")).length&&(i.Text={cp:{"@IX":"0","@textPlaceholder":m}},m={"@N":Y.Character,Row:[{"@IX":"0",Cell:[]}]},v=m.Row[0].Cell,(S=p.attr("font-size"))&&v.push({"@N":y.Size,"@V":(S/96).toString()}),(S=p.attr("font-family"))&&v.push({"@N":y.Font,"@V":S}),(S=p.attr("fill"))&&"transparent"!==S&&v.push({"@N":y.Color,"@V":vi(S)}),i.Section.push(m),i.Cell.push({"@N":y.LeftMargin,"@V":"0"},{"@N":y.RightMargin,"@V":"0"},{"@N":y.TopMargin,"@V":"0"},{"@N":y.BottomMargin,"@V":"0"}));else if("IMAGE"===t)await(async(r,l,a)=>{if(h=r.attr("xlink:href")||r.attr("href")){let e=h,t="png";var s=await(async r=>new Promise((e,t)=>{let i=new Image;i.onload=function(){e(i)},i.onerror=function(){t("Could not load image with given URL.",r)},i.src=r}))(h),n=document.createElement("canvas");n.width=s.width,n.height=s.height,n.getContext("2d").drawImage(s,0,0,s.width,s.height);try{e=n.toDataURL("image/png")}catch(e){if(W.log(`Can not convert an image (${h}) to data URI:`,e),!/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/.test(h))return l;"image/svg+xml"===h.split(",")[0].split(":")[1].split(";")[0]&&(t="svg")}var o,n=a.jxon.Relationship.length+1,h=`image${n}.`+t;l.ForeignData={"@ForeignType":"Bitmap","@CompressionType":t.toUpperCase(),Rel:{"@r:id":"rId"+n.toString()}},l["@Type"]=f.Foreign;let i=r.getBBox();"none"!==r.attr("preserveAspectRatio")&&(r=i.width/s.width,o=i.height/s.height,o=s.width*(r=r<=o?r:o),s=s.height*r,i=new z.g.Rect({x:(i.width-o)/2,y:(i.height-s)/2,width:o,height:s})),l.Cell.push({"@N":y.ImgOffsetX,"@V":(i.x/96).toString()},{"@N":y.ImgOffsetY,"@V":(i.y/96).toString()},{"@N":y.ImgWidth,"@V":(i.width/96).toString()},{"@N":y.ImgHeight,"@V":(i.height/96).toString()}),a.jxon.Relationship.push({"@Id":"rId"+n,"@Type":C.DocumentImageRelationships,"@Target":"../media/"+h}),a.data.push({name:h,url:e})}})(u,g,e);else if(!(t in fi)){var p=u;var v=g;var S=c;m=d;let e=S.model,t=p.node,i=e.isElement()&&S.el===t,r=i?new z.g.Rect(e.attributes.size):S.getNodeBoundingRect(t),{scaleX:l,scaleY:a}=m,s=z.V.createSVGMatrix().scale(l,a).translate(0,r.height).flipY(),n=(i||(s=s.translate(-r.x,-r.y)),z.V.normalizePathData(p.convertToPathData())),o=new z.g.Path(n),h={"@IX":1..toString(),"@N":Y.Geometry,Cell:[],Row:Ci(o,s)};var S=p,m=h,{stroke:S,fill:p}=window.getComputedStyle(S.node),m=m.Cell;p&&m.push({"@N":"NoFill","@V":"none"===p?"1":"0"}),S&&m.push({"@N":"NoLine","@V":"0"}),v.Section.push(h)}var i=u,e=g,{stroke:i,fill:t,strokeWidth:c}=window.getComputedStyle(i.node),e=e.Cell;return"none"===t||t===mi(t)?e.push({"@N":"FillForegndTrans","@V":"1"}):e.push({"@N":"FillForegnd","@V":vi(t)}),"none"===i||mi(i)?e.push({"@N":"LineColorTrans","@V":"1"}):e.push({"@N":"LineColor","@V":vi(i)}),c&&e.push({"@N":"LineWeight","@V":String(parseFloat(c)/96)}),g}function Pi(e){var{width:e,height:t}=e.node.getBoundingClientRect();return 0!==e||0!==t}async function bi(e,t){var i,r,l,a;return Pi(e.vel)?e.model.isLink()?(r=t,l=(i=e).getConnection().bbox(),a=z.V.createSVGMatrix().translate(-l.x,-l.y),xi(i,r,l,a)):(i=t,l=(r=e).model,a=l.getBBox(),t=a.center(),l=r.rotatableNode?0:l.angle(),l=z.V.createSVGMatrix().rotate(l),xi(r,i,a,l,t)):null}async function xi(o,h,e,t,i){var{paper:r,vel:l}=o,r=r.getArea(),t=z.V.decomposeMatrix(t),r=await yi(l,Ti(l,e,r,{transformation:t,origin:i}),o,t,h),i=l.id;let u={[i]:r},g={[i]:e},c={};for(var a=async e=>{if(!Pi(e))return!1;var t=e.node,i=z.V.ensureId(e),r=t.parentNode,l=r.id,a=g[l],s=u[l],l=c[l];let n=e.getTransformToElement(r);l&&(n=l.multiply(n));r=0===e.children().length;return"G"===e.tagName()?!r&&(g[i]=a,u[i]=s,c[i]=n,!0):(await yi(e,e=Ti(e,g[t.id]=o.getNodeBoundingRect(t),a,{transformation:l=z.V.decomposeMatrix(n)}),o,l,h),s.Shapes.Shape.push(e),r||(u[i]=e),r)},s=l.children();0<s.length;){var n=s.shift();await a(n)&&s.unshift(...n.children())}return await 0,r}function wi(e){var{model:t,paper:i}=e;if(!t.isLink())throw new Error("Can not export dia.Element as a connection.");if(!Pi(e.vel))return null;t=e.getConnection();if(!t)return null;i.getArea();i=t.bbox(),e=((e,t)=>{var{vel:e,sourcePoint:i,targetPoint:r,paper:l}=e,e=_i(e),l=l.getArea().height;return(i=new z.g.Point(i)).y=l-i.y,(r=new z.g.Point(r)).y=l-r.y,e.Cell.unshift({"@N":y.BeginX,"@V":""+i.x/96,"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":y.BeginY,"@V":""+i.y/96,"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":y.EndX,"@V":""+r.x/96,"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":y.EndY,"@V":""+r.y/96,"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":y.Width,"@V":""+ne(r.x-i.x),"@F":"GUARD(EndX-BeginX)"},{"@N":y.Height,"@V":""+t.height/96,"@F":`GUARD(${t.height/96})`},{"@N":y.Angle,"@V":"0","@F":"GUARD(0 deg)"},{"@N":y.PinX,"@V":""+(i.x+r.x)/2/96,"@F":"GUARD((BeginX+EndX)/2))"},{"@N":y.PinY,"@V":""+(i.y+r.y)/2/96,"@F":"GUARD((BeginY+EndY)/2)"},{"@N":y.LocPinX,"@V":""+(r.x-i.x)/2/96,"@F":"GUARD(Width*0.5)"},{"@N":y.LocPinY,"@V":""+t.height/2/96,"@F":"GUARD(Height*0.5)"},{"@N":y.FlipX,"@V":"0","@F":"GUARD(FALSE)"},{"@N":y.FlipY,"@V":"0","@F":"GUARD(FALSE)"}),e})(e,i),i=z.V.createSVGMatrix().translate(0,i.height).flipY().translate(-i.x,-i.y),t={"@IX":"0","@N":Y.Geometry,Cell:[{"@N":y.NoFill,"@V":"1"},{"@N":y.NoLine,"@V":"0"},{"@N":y.NoShow,"@V":"0"},{"@N":y.NoSnap,"@V":"0"},{"@N":y.NoQuickDrag,"@V":"0"}],Row:Ci(t,i)};return e.Section.push(t),e}function _i(e){e="G"===e.tagName()?f.Group:f.Shape;return{"@ID":z.util.uniqueId(),"@LineStyle":"3","@Type":e,Cell:[{"@N":y.ResizeMode,"@V":"0"}],Section:[],Shapes:{Shape:[]}}}function Ti(e,t,i,r){var{transformation:r={},origin:l=new z.g.Point(0,0)}=r,{translateX:r=0,translateY:a=0,rotation:s=0,scaleX:n=1,scaleY:o=1}=r;let{width:h,height:u}=t;t=t.center(),1===n&&1===o||(t.scale(n,o),h*=n,u*=o),0!==s&&t.rotate(l,-s),n=new z.g.Point(h/2,u/2),o=new z.g.Point(r+t.x,i.height-(t.y+a)),l=_i(e);return l.Cell.unshift({"@N":y.PinX,"@V":""+o.x/96},{"@N":y.PinY,"@V":""+o.y/96},{"@N":y.Width,"@V":""+h/96},{"@N":y.Height,"@V":""+u/96},{"@N":y.LocPinX,"@V":""+n.x/96},{"@N":y.LocPinY,"@V":""+n.y/96},{"@N":y.Angle,"@V":""+z.g.toRad(-s)}),l}async function ki(t,e,i,r,l,a){var s=t.model;let n=new Map;var o,h="function"==typeof l,u={fromConnection:async e=>Vi(e,n),fromNodes:async e=>Li(e,r)};for await(o of s.getElements()){var g=o.findView(t);let e;(e=h?await(async(e,t,i,r)=>(i=await i(e,t,r))?i.jxon:null)(g,i,l,u):await Li(g,r))&&n.set(o.id,e)}var c,d,p,v,S=[],m=[],C="function"==typeof a;for await(c of s.getLinks()){var f=c.findView(t);let e;(e=C?await(async(e,t,i,r)=>{if(!(i=await i(e,t,r)))return null;let l=i.jxon,a=wi(e);return["BeginX","BeginY","EndX","EndY"].forEach(t=>{var e,i=a.Cell.find(e=>e["@N"]===t);i&&(-1<(e=l.Cell.findIndex(e=>e["@N"]===t))?l.Cell.splice(e,1,i):l.Cell.push(i))}),l})(f,i,a,u):Vi(f,n))&&(f=c,d=e,p=n,v=void 0,d=d["@ID"].toString(),v=f.source(),v=p.get(v.id),f=f.target(),p=p.get(f.id),f=[{"@FromSheet":d,"@FromCell":y.BeginX,"@FromPart":"3","@ToSheet":v?v["@ID"].toString():d,"@ToCell":v?y.PinX:y.EndX,"@ToPart":v?"3":"9"},{"@FromSheet":d,"@FromCell":y.EndX,"@FromPart":"3","@ToSheet":p?p["@ID"].toString():d,"@ToCell":p?y.PinX:y.BeginX,"@ToPart":p?"3":"9"}],m.push(...f),S.push(e))}return e.Shapes={Shape:[...n.values(),...S]},e.Connects={Connect:[...m]},e}async function Li(e,t){return bi(e,t)}function Vi(e,t){var i=e.model,e=wi(e),r=(e["@Type"]=f.Shape,i.source()),i=i.target(),r=t.get(r.id),t=t.get(i.id),i=`${r?"Sheet":"Dynamic connector"}.`+(r||e)["@ID"],l=`${t?"Sheet":"Dynamic connector"}.`+(t||e)["@ID"];return e.Cell.push({"@N":y.BegTrigger,"@V":r?"2":"1","@F":`_XFTRIGGER(${i}!EventXFMod)`},{"@N":y.EndTrigger,"@V":t?"2":"1","@F":`_XFTRIGGER(${l}!EventXFMod)`},{"@N":y.ObjType,"@V":"2"}),e}let Ai={XML:"xml",IMAGE:"image"};async function Mi(e,t,i){var{exportElement:i,exportLink:r}=2<arguments.length&&void 0!==i?i:{};let s={};var l,a,n,o=t.archive,h={data:[],jxon:{Relationship:[]}},u=(s["docProps/custom.xml"]={type:Ai.XML,content:(u=await(u=o).getJxonAsync("docProps/custom.xml"),n={"@fmtid":"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}","@pid":((n=Math.max.apply(Math,u.property.map(e=>Number.parseInt(e["@pid"]))))+1).toString(),"@name":"RecalcDocument","vt:bool":{keyValue:"true"}},u.property.push(n),n=document.implementation.createDocument(C.CustomProperties,"Properties",null),u=Ot(u,n,{vt:C.DocPropsVTypes}),await('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(n=(new XMLSerializer).serializeToString(u))))},t.fileName),g=(s[`visio/pages/${u}.xml`]={type:Ai.XML,content:(n=e,a=h,i=i,r=r,g=await(l=t).archive.getJxonAsync(l.xmlPath),n=await ki(n,g,l,a,i,r),g=document.implementation.createDocument(C.Main,"PageContents",null),l=Ot(n,g,{xmlns:C.Main,r:C.DocumentRelationships}),a=new XMLSerializer,await('<?xml version="1.0" encoding="utf-8"?>'+(i=a.serializeToString(l).replace(/(<cp IX="0")(?: textPlaceholder="(.*?)")(\/>)/gm,function(){var[,e,t,i]=arguments;return e+i+t}))))},s["visio/pages/pages.xml"]={type:Ai.XML,content:await(async(e,t,i)=>{i=await i.getJxonAsync("visio/pages/pages.xml"),e=e.getArea(),Array.isArray(i.Page)||(i.Page=[i.Page]);var r,l=i.Page.find(e=>e["@ID"]===t.id.toString()),a=(l?(l=l.PageSheet.Cell,r=l.findIndex(e=>e["@N"]===y.PageWidth),s=l.findIndex(e=>e["@N"]===y.PageHeight),a={"@N":y.PageWidth,"@V":(e.width/96).toString()},Number.isNaN(r)?l.push(a):l[r]=a,r={"@N":y.PageHeight,"@V":(e.height/96).toString()},Number.isNaN(s)?l.push(r):l[s]=r):W.log(`Page with id ${t.id} was not found.`),document.implementation.createDocument(C.Main,"Pages",null)),e=Ot(i,a,{xmlns:C.Main,r:C.DocumentRelationships}),s=(l=new XMLSerializer).serializeToString(e);return'<?xml version="1.0" encoding="utf-8"?>'+s})(e,t,o)},s[`visio/pages/_rels/${u}.xml.rels`]={type:Ai.XML,content:(r=h.jxon,n=document.implementation.createDocument(C.Relationships,"Relationships",null),r=Ot(r,n,{xmlns:C.Relationships}),await('<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(n=(new XMLSerializer).serializeToString(r))))},await o.getJxonAsync("[Content_Types].xml")),c=(s["[Content_Types].xml"]={type:Ai.XML,content:(async t=>{let i=t.Default.map(e=>e["@Extension"]),e=([{name:"emf",type:"image/x-emf"},{name:"png",type:"image/png"},{name:"gif",type:"image/gif"},{name:"jpeg",type:"image/jpeg"},{name:"svg",type:"image/svg+xml"}].forEach(e=>{-1===i.indexOf(e.name)&&t.Default.unshift({"@Extension":e.name,"@ContentType":e.type})}),document.implementation.createDocument(C.ContentTypes,"Types",null)),r=Ot(t,e,{xmlns:C.ContentTypes}),l=(new XMLSerializer).serializeToString(r);return'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+l})(g)},[]);for(let a of h.data)c.push(new Promise((r,l)=>{z.util.imageToDataUri(a.url,(e,t)=>{e&&l();let i;try{i=z.util.dataUriToBlob(t)}catch(e){W.log("Can not convert an image to blob: "+e)}i&&(s["visio/media/"+a.name]={type:Ai.IMAGE,content:i}),r()})}));return Promise.all(c).then(()=>s)}class Fi extends ci{getDefaultAttributes(){return{...super.getDefaultAttributes(),shapes:new Map,connects:new Map,pages:null,foreignShapes:new Map,allShapes:new Map,cache:new Map}}constructor(){super(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},new Set([v.pages,v.shapes,v.connects,v.foreignShapes,v.background,v.backPage]))}setAttributes(e){let{pageSheet:t,...i}=e;super.setAttributes({pageSheet:t,...i}),t&&this.referenceInCells()}referenceInCells(){var{pageSheet:e,archive:t}=this;e&&e.cells&&(e.cells.parent=t.document.pageSheet)}async getContent(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=new oi(this);return await t.loadAsync(e),t}async getMastersFromRelsAsync(){var e=this.archive.document.masters;if(!this.rels)return null;var t=this.rels.get(c.Master);t&&await e.loadMasters(t)}get background(){return Boolean(this._background)}get backPage(){var e=this._backPage;return void 0===e?null:e}get width(){return this.pageSheet.cells.pageWidth}get height(){return this.pageSheet.cells.pageHeight}get pages(){return this._pages}get fileName(){var[,e]=/^visio\/pages\/(.*)\.xml$/gm.exec(this.xmlPath);return e}async fromPaper(e){var{exportElement:t=null,exportLink:i=null}=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=await Mi(e,this,{exportElement:t,exportLink:i});this.archive.addEntries(e)}get printerPaperSize(){var{paperKind:e,printPageOrientation:t}=this.pageSheet.cells,{width:e,height:i}=this.constructor.getPrinterPaperSize(e);return 2===t?{width:i,height:e}:{width:e,height:i}}static getPrinterPaperSize(e){var t=e=>le(e,h.MM),i=e=>le(e,h.IN);switch(e){default:case 0:case 1:case 2:return{width:i(8.5),height:i(11)};case 3:return{width:i(11),height:i(17)};case 4:return{width:i(17),height:i(11)};case 5:return{width:i(8.5),height:i(14)};case 6:return{width:i(5.5),height:i(8.5)};case 7:return{width:i(7.25),height:i(10.5)};case 8:return{width:t(297),height:t(420)};case 9:case 10:return{width:t(210),height:t(297)};case 11:return{width:t(148),height:t(210)};case 12:return{width:t(250),height:t(354)};case 13:return{width:t(182),height:t(257)};case 14:return{width:i(8.5),height:i(13)};case 15:return{width:t(215),height:t(275)};case 16:return{width:i(10),height:i(14)};case 17:return{width:i(11),height:i(17)};case 18:return{width:i(2),height:i(11)};case 19:return{width:i(3.875),height:i(8.875)};case 20:return{width:i(4.125),height:i(9.5)};case 21:return{width:i(4.5),height:i(10.375)};case 22:return{width:i(4),height:i(11)};case 23:return{width:i(5),height:i(11.5)};case 24:return{width:t(917),height:t(1297)};case 25:return{width:t(771),height:t(1090)};case 26:return{width:t(878),height:t(1242)};case 27:return{width:t(110),height:t(220)};case 28:return{width:t(162),height:t(229)};case 29:return{width:t(324),height:t(458)};case 30:return{width:t(229),height:t(324)};case 31:return{width:t(114),height:t(162)};case 32:return{width:t(114),height:t(229)};case 33:return{width:t(250),height:t(353)};case 34:return{width:t(176),height:t(250)};case 35:return{width:t(176),height:t(125)};case 36:return{width:t(110),height:t(230)};case 37:return{width:i(3.875),height:i(7.5)};case 38:return{width:i(3.625),height:i(6.5)};case 39:return{width:i(14.875),height:i(11)};case 40:return{width:i(8.5),height:i(12)};case 41:return{width:i(8.5),height:i(13)};case 42:return{width:t(250),height:t(353)};case 43:return{width:t(100),height:t(148)};case 44:return{width:i(9),height:i(11)};case 45:return{width:i(10),height:i(11)};case 46:return{width:i(15),height:i(11)};case 47:return{width:i(220),height:i(220)};case 50:return{width:i(9),height:i(12)};case 51:return{width:i(9),height:i(15)};case 52:return{width:i(11.69),height:i(18)};case 53:return{width:i(9.27),height:i(12.69)};case 54:return{width:i(8),height:i(11)};case 55:return{width:t(210),height:t(297)};case 56:return{width:i(9),height:i(12)};case 57:return{width:t(227),height:t(356)};case 58:return{width:t(305),height:t(487)};case 59:return{width:i(8.5),height:i(12.69)};case 60:return{width:t(210),height:t(330)};case 61:return{width:t(148),height:t(210)};case 62:return{width:t(182),height:t(257)};case 63:return{width:t(322),height:t(445)};case 64:return{width:t(174),height:t(235)};case 65:return{width:t(201),height:t(276)};case 66:return{width:t(420),height:t(594)};case 67:return{width:t(297),height:t(420)};case 68:return{width:t(322),height:t(445)}}}}async function Di(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],r=g.Page,i=i.concat(Le(r,e,i)),e=await w.call(this,e,r,i),r=t.rels.get(g.Page),i=e._rel,r=r.get(i).targetFile.absolutePath;return new Fi({archive:this,pages:t,xmlPath:r,...e})}class Bi extends Ce{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;t.add("cells"),t.add("sections"),super(e,t)}setAttributes(e){let{shapes:t,...i}=e;super.setAttributes(i),t&&this.master.initMasterSubshapes(t,this)}get cells(){return this._cells}set cells(e){this._cells=e}get sections(){return this._sections}set sections(e){this._sections=e}}class Ii extends ci{constructor(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;t.add("cells"),t.add("sections"),t.add("id"),t.add("name"),t.add("icon"),super(e,t)}setAttributes(e){let{shapes:t,...i}=e;super.setAttributes(i),i.cells&&this.referenceMasterShapeInsideCellsDeep(this),t&&this.initMasterSubshapes(t,this)}setMasterContents(i){i=i.shapes;if(1<i.size)this.initMasterSubshapes(i,this);else{let{id:e,...t}=[...i.values()][0];this.setAttributes({masterAndShape:!0,shapeId:e,...t}),this.masterContentsSet=!0}}initMasterSubshapes(e,i){i.masterShapes||(i.masterShapes=new Map),this.masterShapesMap||(this.masterShapesMap=new Map),e.forEach((e,t)=>{e=new Bi({archive:this.archive,master:this,masterId:this.id,...e});this.referenceMasterShapeInsideCellsDeep(e),i.masterShapes.set(t,e),this.masterShapesMap.set(t,e)})}referenceMasterShapeInsideCellsDeep(t){t._cells&&this.referenceMasterShapeInsideCells(t._cells,t),this._sections&&this._sections.forEach(e=>{e.forEach(e=>{e.rows&&e.rows.forEach(e=>{e.cells&&this.referenceMasterShapeInsideCells(e.cells,t)})})})}referenceMasterShapeInsideCells(e,t){e.masterShape=t}get cells(){return this._cells}set cells(e){this._cells=e}get sections(){return this._sections}set sections(e){this._sections=e}get id(){return this._id}get name(){return this._name}getIconBase64(){return this._icon&&this._icon.base64?"data:image/png;base64,"+this._icon.base64:null}}class Ri extends ci{constructor(e,t){super(e,t),this.map=new Map}add(e){var t=e.id,i=this.getRelById(e._rel),i=(i.masterId=t,i.targetFile.absolutePath),i=new Ii({archive:this.archive,masters:this,xmlPath:i,masterContentsSet:!1,...e});return this.map.set(t,i),i}getRelById(e){return this.rels.get(g.Master).get(e)}addIntoById(e,t){this.map.get(e).setMasterContents({...t})}getIdByPath(t){var e=[...this.rels.get(g.Master).values()].find(e=>e.targetFile.absolutePath===t);return e||W.log("Unknown master"),e.masterId}get(e){return this.map.get(e)}async loadMasters(e){var t,i=this.archive;for([,t]of e.entries()){var r=t.targetFile.absolutePath,l=this.getIdByPath(r),a=this.get(l);a.masterContentsSet||(r=await i.getJxonAsync(r),r=await w.call(i,r,g.Master,[],{structurePathEnrichObject:{masterId:l}}),a.setMasterContents(r))}}}async function Ei(){var e,t=this,{topRelationsMap:i=this.topRelationsMap,documentRelationsMap:r=this.documentRelationsMap,getJxonAsync:l=function(){return t.getJxonAsync(...arguments)}}=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=await l(gi(i,c.document)),a=(a=i,s=V.Main,C.hasOwnProperty(s)||W.log(`Unknown xmlSchemaKey "${s}"`,{jxonTree:a}),s===V.DrawingML&&a["@xmlns:a"]===C.DrawingML||s===V.Theme&&a["@xmlns:vt"]===C.Theme||(a.hasOwnProperty("@xmlns")&&a["@xmlns"]||W.log('"@xmlns" attribute not found',{jxonTree:a}),a["@xmlns"]!==C[s]&&W.log(`Unexpected schema actual: "${a["@xmlns"]}" `+`(expected "${C[s]}")`)),Le(g.Document,i,[]),this.document=new di({archive:this}),i[d.Colors]),s=(a&&this.document.setAttributes({colors:mt(a)},new Set([v.colors])),await w.call(this,i,g.Document,[])),a=(this.document.setAttributes(s),this.document.pageSheet={debug:"dummyPageSheet",cells:this.document.styleSheets.get(0).cells},gi(r,c.Pages)),i=(this.document.pages=new pi({archive:this,xmlPath:a}),await this.document.pages.getRelsMapCachedAsync(),await l(a));for(e of b(i.Page)){var n=await Di.call(this,e,this.document.pages);this.document.pages.add(n)}s=gi(r,c.Masters);if(s){var o,h=this.document.masters=new Ri({archive:this,xmlPath:s}),a=(await this.document.masters.getRelsMapCachedAsync(),await l(s));for(o of b(a.Master)){var u=await w.call(this,o,g.Master,[]);h.add(u)}}return this.document}let Ni={array:"array",arraybuffer:"arraybuffer",base64:"base64",binarystring:"binarystring",blob:"blob",uint8array:"uint8array"};class Gi{constructor(){this.document=null,this.source=null,this.zip=null,this.jxonAsync=null,this.topRelationsMap=null,this.documentRelationsMap=null}async load(e){if(!(e instanceof ArrayBuffer))throw new Error("Not an instance of ArrayBuffer.");var t=await(new L).loadAsync(e);this.source=e,this.zip=t,this.jxonAsync=new hi(t),this.topRelationsMap=await async function(){return ui({relationshipOrArrayOfJxons:(await this.getJxonAsync("_rels/.rels")).Relationship,basePath:"/"})}.call(this),this.documentRelationsMap=await async function(){return ui({relationshipOrArrayOfJxons:(await this.getJxonAsync("visio/_rels/document.xml.rels")).Relationship,basePath:"visio/"})}.call(this),await Ei.call(this)}async getJxonAsync(e){return this.jxonAsync.getJxonAsync(e)}async getImageAsync(e){return this.jxonAsync.getImageAsync(e)}async toVSDX(){var e,t,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{type:r="blob"}=i;let l=r;return r&&Ni[r]&&(e=L.support,(t=e.hasOwnProperty(r))&&e[r]||!t?l=Ni[r]:W.log(`Browser does not support export type: "${r}", using Blob as fallback.`)),this.zip.generateAsync({...i,type:l})}static async fromURL(l){if("string"!=typeof l||""===l)throw new Error("Missing parameter");return new Promise((t,i)=>{let r=new XMLHttpRequest;r.open("GET",l,!0),r.setRequestHeader("Content-Type","application/vnd-ms-visio.drawing;charset=utf-8"),r.responseType="blob",r.onerror=()=>{i(new Error(`Failed to load file ${l}, status: ${r.status} (${r.statusText})`))},r.onload=()=>{var e;200===r.status?((e=new FileReader).onload=e=>{e=e.target.result;t(this.fromArrayBuffer(e))},e.onerror=()=>{i(new Error("Error occurred reading file: "+l))},e.readAsArrayBuffer(r.response)):i(new Error(`Failed to load file ${l}, status: ${r.status} (${r.statusText})`))},r.send()})}static async fromArrayBuffer(e){var t=new this;return await t.load(e),t}static async fromBase64(e){return this.fromArrayBuffer(new Uint8Array([...atob(e)].map(e=>e.charCodeAt(0))))}addEntries(e){for(var t in e)e.hasOwnProperty(t)&&this.zip.file(t,e[t].content)}}var k={fromPixels:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:h.IN;switch(void 0!==e&&t||W.log("Value and target unit type are required to convert a pixel value."),e=Number.parseFloat(e),Number.isNaN(e)&&W.log("fromPixels requires a numeric value."),t){case h.IN:case h.IN_F:case h.DL:case h.DP:return e/96;case h.DT:case h.PT:var i=e;return 72*(i/=96);case h.MM:return se(e);case h.CM:i=e;return(i=se(i))/10;default:return W.log(`Unsupported numeric unit type "${oe(t)}" ("${t}")`),e}},toPixels:le,isFontAvailable:ni},Xi={VisioRowType:D,VisioSectionType:Y,VisioCellName:y,VisioUnitType:h};function T(l,e){var a=zi();return(T=function(e,t){var i=a[e-=242];void 0===T.nPppTV&&(T.PKopZL=function(e,t){var i,r=[],l=0,a="";for(e=(e=>{for(var t,i,r="",l="",a=0,s=0;i=e.charAt(s++);~i&&(t=a%4?64*t+i:i,a++%4)&&(r+=String.fromCharCode(255&t>>(-2*a&6))))i="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=".indexOf(i);for(var n=0,o=r.length;n<o;n++)l+="%"+("00"+r.charCodeAt(n).toString(16)).slice(-2);return decodeURIComponent(l)})(e),s=0;s<256;s++)r[s]=s;for(s=0;s<256;s++)l=(l+r[s]+t.charCodeAt(s%t.length))%256,i=r[s],r[s]=r[l],r[l]=i;for(var s=0,l=0,n=0;n<e.length;n++)i=r[s=(s+1)%256],r[s]=r[l=(l+r[s])%256],r[l]=i,a+=String.fromCharCode(e.charCodeAt(n)^r[(r[s]+r[l])%256]);return a},l=arguments,T.nPppTV=!0);var e=e+a[0],r=l[e];return r?i=r:(void 0===T.PaMhbQ&&(T.PaMhbQ=!0),i=T.PKopZL(i,t),l[e]=i),i})(l,e)}e.VisioArchive=Gi,e.VisioConnect=Mt,e.VisioDocument=di,e.VisioElement=_t,e.VisioIndexedSection=st,e.VisioLink=Tt,e.VisioNamedSection=nt,e.VisioPage=Fi,e.VisioPageContent=oi,e.VisioPages=pi,e.VisioRow=it,e.VisioSection=at,e.VisioShape=li,e.VisioSheetObject=Pe,e.config=xe,e.debug=W,e.types=Xi,e.util=k;var Oi,Xi=T;function zi(){var e=["WPlcRSo/E8oSWPhcHZ/cP3fkCa","WO/cMmkzW6GqW7JcSwhcNCk9l8oFmW","WPVcKbi5F1SWf2q","WOVcL8kBW6ivW73cSaVdSSoUESkWsq","BfRcK8kGW5aIW4jSWPWq","W6NcOanKDvpdMaNcTL8","iW7cJutcSSkQWRygwLtdGceryeOtoCkpWR3dII7dUqVcOtZdKCobAMBdH35zWRlcON1FFSoEW5GyWQfiW4GBuX/dLmomWOvYWPa+WPxdVsddTh0DWPy+he4XW6inWOWzy8osWPhdOrddLv9kWQZcGfzxW5ddGCohWQ9IW6NcKxm2lZSKW4v2eL0","rN7dISo2WQDSWRhdVCoJxt3dJG","WQ3dOmoHo8oDoY7cQmkNWRJdSCkh","kSoEbSoHW59bWRtdUmoDBq","smo6rM52kX7dRCkfbmke","W7BdNSo2W47cVmowWPBcQZSUDSoM","ESkAEtpcL0W6B8kg","DWBcI8owWRyvja","mXVcPmkDWQtcMbaHwhz4W7q","hSo6WPvVW5v2nSoIWRO","bmkFW5BcVCkoy8oCbSkpW7G","bmkAWPFdSmkArSo2eW","W4GpC3HVm8kZ","dmkjW67dOcu+W7K5W4L5dbqh","DLlcMmo/z8kPcG45jmkHWRKJ","W7tcNs3cTmkBW5dcVa","dMyDmeXNW4K1W5hdQq/cVq","W4ldVmk4g8k8W4tcHq","zq/cLWpdQh7dJImfWP0p","F8kyEuhdMq4/x8khhxCV","AfxcK8kMWPnBWRfSWPi1Bq1F","W77cU8kXCCkB","WRKdlvO+pgnKhmoR","qSozW77dTK59obzH"];return(zi=function(){return e})()}for(var i=T,Yi=zi();;)try{if(680709==+parseInt(i(258,"Zj*X"))*(-parseInt(i(262,"nvPS"))/2)+parseInt(i(260,"yw#("))/3*(-parseInt(i(257,"C9@]"))/4)+parseInt(i(271,"4rsO"))/5+parseInt(i(249,"hQZ8"))/6*(-parseInt(i(264,"Dt5P"))/7)+-parseInt(i(265,"nH!J"))/8*(parseInt(i(252,"nH!J"))/9)+parseInt(i(242,"M]l1"))/10*(-parseInt(i(251,"chc5"))/11)+parseInt(i(244,"5ULV"))/12*(parseInt(i(254,"(!G6"))/13))break;Yi.push(Yi.shift())}catch(e){Yi.push(Yi.shift())}e=new Date(parseInt(Xi(243,"4rsO"))),k=parseInt(Xi(245,"U!@6")),Xi=Xi(246,"L1Yt"),(Oi=T)(269,"9$mK")!=typeof window&&k&&!isNaN(k)&&e&&!isNaN(e[Oi(263,"5YuD")]())&&e[Oi(261,"Ip)F")]()+k-(new Date)[Oi(253,"@DVr")]()<=0&&window[Oi(267,"8wL9")](Xi)});